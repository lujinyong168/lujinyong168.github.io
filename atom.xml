<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>上海IT技术圈</title>
  
  <subtitle>IT技术</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://sparkx.com.cn/"/>
  <updated>2020-04-13T15:34:55.202Z</updated>
  <id>http://sparkx.com.cn/</id>
  
  <author>
    <name>加我微信，邀你入群</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>swagger的高级用法</title>
    <link href="http://sparkx.com.cn/springboot/swagger-advanced-usage/"/>
    <id>http://sparkx.com.cn/springboot/swagger-advanced-usage/</id>
    <published>2020-04-01T00:06:52.000Z</published>
    <updated>2020-04-13T15:34:55.202Z</updated>
    
    <content type="html"><![CDATA[<h1 id="接口分组"><a href="#接口分组" class="headerlink" title="接口分组"></a>接口分组</h1><p>在<code>SpringBoot</code>中定义各个接口是以<code>Controller</code>作为第一级维度来进行组织的，<code>Controller</code>与具体接口之间的关系是一对多的关系。可以将同属一个模块的接口定义在一个<code>Controller</code>里。默认情况下，Swagger是以<code>Controller</code>为单位，对接口进行分组管理的。这个分组的元素在<code>Swagger</code>中称为<code>Tag</code>，但是这里的<code>Tag</code>与接口的关系并不是一对多的，它支持更丰富的多对多关系。</p><h3 id="默认分组"><a href="#默认分组" class="headerlink" title="默认分组"></a>默认分组</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"teacher"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/test1"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"test1"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/student"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"获取学生清单"</span>)</span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/list"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStudentList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"students"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"获取教某个学生的老师清单"</span>)</span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/his-teachers"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStudentOfTeacherList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"teachers"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation</span>(<span class="string">"创建一个学生"</span>)</span><br><span class="line">    <span class="meta">@PostMapping</span>(<span class="string">"/create"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"student"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>启动应用之后，可以看到Swagger中这两个Controller是这样组织的:<br><img src="/images/springboot/springboot-controller-student-teacher.png" alt="默认生成的Tag与Spring Boot中Controller展示的内容与位置"></p><h3 id="自定义默认分组的名称"><a href="#自定义默认分组的名称" class="headerlink" title="自定义默认分组的名称"></a>自定义默认分组的名称</h3><p>通过@Api注解来自定义Tag，Tag内容替代了默认产生的teacher-controller和student-controller</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Api</span>(tags = <span class="string">"教师管理"</span>)</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"teacher"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherController</span> </span>&#123;</span><br><span class="line">    ……</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Api</span>(tags = <span class="string">"学生管理"</span>)</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/student"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">……</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>启动后查看：<br><img src="/images/springboot/springboot-controller-student-teacher-api.png" alt="自定义默认分组"></p><h3 id="合并Controller分组"><a href="#合并Controller分组" class="headerlink" title="合并Controller分组"></a>合并Controller分组</h3><p>上面还都只是使用了Tag与Controller一一对应的情况，Swagger中还支持更灵活的分组！从@Api注解的属性中，可以发现tags属性其实是个数组类型：<code>String[] tags() default {&quot;&quot;};</code><br>我们可以通过定义同名的Tag来汇总Controller中的接口，比如我们可以定义一个Tag为“教学管理”，让这个分组同时包含教师管理和学生管理的所有接口，可以这样来实现：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Api</span>(tags = &#123;<span class="string">"教师管理"</span>, <span class="string">"教学管理"</span>&#125;)</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"teacher"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherController</span> </span>&#123;</span><br><span class="line">    ……</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Api</span>(tags = &#123;<span class="string">"学生管理"</span>, <span class="string">"教学管理"</span>&#125;)</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/student"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">……</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>效果如下：<br><img src="/images/springboot/springboot-controller-student-teacher-mergegroup.png" alt="合并Controller分组"></p><h3 id="更细粒度的接口分组"><a href="#更细粒度的接口分组" class="headerlink" title="更细粒度的接口分组"></a>更细粒度的接口分组</h3><p>通过@Api可以实现将Controller中的接口合并到一个Tag中，但是如果我们希望精确到某个接口的合并呢？比如这样的需求：“教学管理”包含“教师管理”中所有接口以及“学生管理”管理中的“获取学生清单”接口（不是全部接口）。</p><p>那么上面的实现方式就无法满足了。这时候发，我们可以通过使用@ApiOperation注解中的tags属性做更细粒度的接口分类定义，比如上面的需求就可以这样子写：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Api</span>(tags = &#123;<span class="string">"教师管理"</span>, <span class="string">"教学管理"</span>&#125;)</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"teacher"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherController</span> </span>&#123;</span><br><span class="line">    ……</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Api</span>(tags = &#123;<span class="string">"学生管理"</span>&#125;)</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(value=<span class="string">"/student"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line"><span class="meta">@ApiOperation</span>(value = <span class="string">"获取学生清单"</span>, tags = <span class="string">"教学管理"</span>)</span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/list"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getStudentList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"students"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">……</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>效果如下：<br><img src="/images/springboot/springboot-controller-student-teacher-ApiOperation.png" alt="更细粒度的接口分组"></p><h1 id="内容顺序"><a href="#内容顺序" class="headerlink" title="内容顺序"></a>内容顺序</h1><p>对于接口内容的展现顺序其中主要涉及三个方面：分组的排序、接口的排序以及参数的排序。</p><h3 id="分组的排序"><a href="#分组的排序" class="headerlink" title="分组的排序"></a>分组的排序</h3><p>Swagger Starter用户，可以通过修改配置的方式：<code>swagger.ui-config.tags-sorter=alpha</code>,TagsSorter源码如下：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> TagsSorter &#123;</span><br><span class="line">    ALPHA(<span class="string">"alpha"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String value;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">TagsSorter</span><span class="params">(String value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.value = value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JsonValue</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> TagsSorter <span class="title">of</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        TagsSorter[] var1 = values();</span><br><span class="line">        <span class="keyword">int</span> var2 = var1.length;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> var3 = <span class="number">0</span>; var3 &lt; var2; ++var3) &#123;</span><br><span class="line">            TagsSorter tagsSorter = var1[var3];</span><br><span class="line">            <span class="keyword">if</span> (tagsSorter.value.equals(name)) &#123;</span><br><span class="line">                <span class="keyword">return</span> tagsSorter;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Swagger只提供了一个选项，就是按字母顺序排列。也可以依靠使用方式的定义来实现排序的建议：为Tag的命名做编号。比如：</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@Api</span>(tags = &#123;<span class="string">"1-教师管理"</span>,<span class="string">"3-教学管理"</span>&#125;)</span><br><span class="line">public class TeacherController &#123;</span><br><span class="line">……</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">@Api</span>(tags = &#123;<span class="string">"2-学生管理"</span>&#125;)</span><br><span class="line">public class StudentController &#123;</span><br><span class="line">……</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>由于原本存在按字母排序的机制在，通过命名中增加数字来帮助排序，如下图：<br><img src="/images/springboot/springboot-controller-student-teacher-tagsorter.png" alt="tagsorter"></p><h3 id="接口的排序"><a href="#接口的排序" class="headerlink" title="接口的排序"></a>接口的排序</h3><p>Swagger Starter用户，可以通过修改配置的方式：<code>swagger.ui-config.operations-sorter=alpha</code>或者<code>swagger.ui-config.operations-sorter=method</code>。<br>它提供了两个配置项：alpha和method，分别代表了按字母表排序以及按方法定义顺序排序。当我们不配置的时候，改配置默认为alpha。</p><h3 id="参数的排序"><a href="#参数的排序" class="headerlink" title="参数的排序"></a>参数的排序</h3><p>默认情况下，Swagger对Model参数内容的展现也是按字母顺序排列的。<br>如果我们希望可以按照Model中定义的成员变量顺序来展现，那么需要我们通过@ApiModelProperty注解的position参数来实现位置的设置，比如：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel</span>(description = <span class="string">"用户实体"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"用户编号"</span>, position = <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Size</span>(min = <span class="number">2</span>, max = <span class="number">5</span>)</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"用户姓名"</span>, position = <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Max</span>(<span class="number">100</span>)</span><br><span class="line">    <span class="meta">@Min</span>(<span class="number">10</span>)</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(value = <span class="string">"用户年龄"</span>, position = <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      讲解Swagger接口分类和元素排序即静态文档生成
    
    </summary>
    
    
      <category term="java" scheme="http://sparkx.com.cn/categories/java/"/>
    
    
      <category term="java" scheme="http://sparkx.com.cn/tags/java/"/>
    
      <category term="springboot" scheme="http://sparkx.com.cn/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>swagger ui的使用</title>
    <link href="http://sparkx.com.cn/springboot/swaggerui/"/>
    <id>http://sparkx.com.cn/springboot/swaggerui/</id>
    <published>2020-03-31T15:11:18.000Z</published>
    <updated>2020-03-31T15:19:06.846Z</updated>
    
    <content type="html"><![CDATA[<p>这篇blog记录一下swagger ui的使用及JSR-303的校验用法，为后续使用swagger生成静态文档做个铺垫。</p><h2 id="配置swagger"><a href="#配置swagger" class="headerlink" title="配置swagger"></a>配置swagger</h2><ul><li>常用注解介绍<br>@Controller：修饰class，用来创建处理http请求的对象<br>@RestController：Spring4之后加入的注解，原来在@Controller中返回json需要@ResponseBody来配合，如果直接用@RestController替代@Controller就不需要再配置@ResponseBody，默认返回json格式<br>@RequestMapping：配置url映射。现在更多的也会直接用以Http Method直接关联的映射注解来定义，比如：GetMapping、PostMapping、DeleteMapping、PutMapping等</li><li>RESTful API设计如下:</li></ul><table><thead><tr><th align="left">请求类型</th><th align="left">URL</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">GET</td><td align="left">/users/</td><td align="left">查询用户列表</td></tr><tr><td align="left">GET</td><td align="left">/users/id</td><td align="left">根据id查询用户信息</td></tr><tr><td align="left">POST</td><td align="left">/users/</td><td align="left">创建一个用户</td></tr><tr><td align="left">PUT</td><td align="left">/users/id</td><td align="left">根据id更新用户信息</td></tr><tr><td align="left">DELETE</td><td align="left">/users/id</td><td align="left">根据id删除用户</td></tr></tbody></table><ul><li>添加maven依赖<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.spring4all<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li>应用主类中添加@EnableSwagger2Doc注解<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableSwagger</span>2Doc</span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringbootdemoApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">SpringApplication.run(SpringbootdemoApplication<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>在application.properties中添加swagger配置</li></ul><figure class="highlight plain"><figcaption><span>config</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#swagger 配置</span><br><span class="line">#标题</span><br><span class="line">swagger.title&#x3D;spring-boot-starter-swagger</span><br><span class="line">#描述</span><br><span class="line">swagger.description&#x3D;Starter for swagger 2.x</span><br><span class="line">#版本</span><br><span class="line">swagger.version&#x3D;1.4.0.RELEASE</span><br><span class="line">#许可证</span><br><span class="line">swagger.license&#x3D;Apache License, Version 2.0</span><br><span class="line">#许可证URL</span><br><span class="line">swagger.licenseUrl&#x3D;https:&#x2F;&#x2F;www.apache.org&#x2F;licenses&#x2F;LICENSE-2.0.html</span><br><span class="line">#服务条款URL</span><br><span class="line">swagger.termsOfServiceUrl&#x3D;https:&#x2F;&#x2F;github.com&#x2F;dyc87112&#x2F;spring-boot-starter-swagger</span><br><span class="line">#维护人</span><br><span class="line">swagger.contact.name&#x3D;kn</span><br><span class="line">#维护人URL</span><br><span class="line">swagger.contact.url&#x3D;http:&#x2F;&#x2F;sparkx.com.cn</span><br><span class="line">#维护人email</span><br><span class="line">swagger.contact.email&#x3D;lujinyong168@foxmail.com</span><br><span class="line">#swagger扫描的基础包，默认：全扫描</span><br><span class="line">swagger.base-package&#x3D;com.example</span><br><span class="line">#需要处理的基础URL规则，默认：&#x2F;**</span><br><span class="line">swagger.base-path&#x3D;&#x2F;**</span><br></pre></td></tr></table></figure><ul><li><p>添加User实体</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.springbootdemo.entity;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>为了简化代码我使用lombok自动生成getter和setter方法，需要加入maven依赖：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>并且在idea插件中心安装lombok插件。</p></li><li><p>启动应用，访问：<a href="http://localhost:8080/swagger-ui.html" target="_blank" rel="noopener">http://localhost:8080/swagger-ui.html</a></p></li></ul><h2 id="JSR-303实现请求参数校验"><a href="#JSR-303实现请求参数校验" class="headerlink" title="JSR-303实现请求参数校验"></a>JSR-303实现请求参数校验</h2><ul><li>什么是JSR？<blockquote><p>JSR是Java Specification Requests的缩写，意思是Java 规范提案。是指向JCP(Java Community Process)提出新增一个标准化技术规范的正式请求。任何人都可以提交JSR，以向Java平台增添新的API和服务。JSR已成为Java界的一个重要标准。</p></blockquote></li><li>JSR-303定义的是什么标准？<blockquote><p>JSR-303 是JAVA EE 6 中的一项子规范，叫做Bean Validation，Hibernate Validator 是 Bean Validation 的参考实现 . Hibernate Validator 提供了 JSR 303 规范中所有内置 constraint 的实现，除此之外还有一些附加的 constraint。</p></blockquote></li><li>Bean Validation中内置的constraint</li></ul><table><thead><tr><th align="left">注解</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">@Null</td><td align="left">被注释的元素必须为null</td></tr><tr><td align="left">@NotNull</td><td align="left">被注释的元素必须不能为null</td></tr><tr><td align="left">@AssertTrue</td><td align="left">被注释的元素必须为true</td></tr><tr><td align="left">@AssertFalse</td><td align="left">被注释的元素必须为false</td></tr><tr><td align="left">@Min(value)</td><td align="left">被注释的元素必须是一个数字，其值必须大于等于指定的最小值</td></tr><tr><td align="left">@Max(value)</td><td align="left">被注释的元素必须是一个数字，其值必须小于等于指定的最大值</td></tr><tr><td align="left">@DecimalMin(value)</td><td align="left">被注释的元素必须是一个数字，其值必须大于等于指定的最小值</td></tr><tr><td align="left">@DecimalMax(value)</td><td align="left">被注释的元素必须是一个数字，其值必须小于等于指定的最大值</td></tr><tr><td align="left">@Size(max,min)</td><td align="left">被注释的元素的大小必须在指定范围内</td></tr><tr><td align="left">@Digits(integer,fraction)</td><td align="left">被注释的元素必须是一个数字，其值必须在可接受的范围内</td></tr><tr><td align="left">@Past</td><td align="left">被注释的元素必须是一个过去的日期</td></tr><tr><td align="left">@Future</td><td align="left">被注释的元素必须是一个将来的日期</td></tr><tr><td align="left">@Pattern(value)</td><td align="left">被注释的元素必须符合指定的正则表达式</td></tr></tbody></table><ul><li>Hibernate Validator附加的constraint</li></ul><table><thead><tr><th align="left">注解</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">@Email</td><td align="left">被注释的元素必须是电子邮箱</td></tr><tr><td align="left">@Length</td><td align="left">被注释的字符串的大小必须在指定的范围内</td></tr><tr><td align="left">@NotEmpty</td><td align="left">被注释的字符串必须非空</td></tr><tr><td align="left">@Range</td><td align="left">被注释的元素必须在合适的范围内</td></tr></tbody></table><p>在JSR-303的标准之下，我们可以通过上面这些注解，优雅的定义各个请求参数的校验。</p><h2 id="JSR快速入门"><a href="#JSR快速入门" class="headerlink" title="JSR快速入门"></a>JSR快速入门</h2><h3 id="第一步-在要校验的字段上添加-NotNUll注解，如下："><a href="#第一步-在要校验的字段上添加-NotNUll注解，如下：" class="headerlink" title="第一步:在要校验的字段上添加@NotNUll注解，如下："></a>第一步:在要校验的字段上添加<code>@NotNUll</code>注解，如下：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.springbootdemo.entity;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModel;</span><br><span class="line"><span class="keyword">import</span> io.swagger.annotations.ApiModelProperty;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> javax.validation.constraints.NotNull;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel</span>(description = <span class="string">"用户实体"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"用户编号"</span>)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"用户姓名"</span>)</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"用户年龄"</span>)</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="第二步：在需要校验的参数实体钱添加-Valid注解"><a href="#第二步：在需要校验的参数实体钱添加-Valid注解" class="headerlink" title="第二步：在需要校验的参数实体钱添加@Valid注解"></a>第二步：在需要校验的参数实体钱添加<code>@Valid</code>注解</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *处理"/users/"的POST请求创建user</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> user</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"/"</span>)</span><br><span class="line"><span class="meta">@ApiOperation</span>(value=<span class="string">"创建用户"</span>,notes=<span class="string">"根据User对象创建用户"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">postUser</span><span class="params">(@Valid @RequestBody User user)</span></span>&#123;</span><br><span class="line">users.put(user.getId(),user);</span><br><span class="line"><span class="keyword">return</span> <span class="string">"success"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>完成上面配置后，启动应用，并用配置的swagger提供的页面测试POST接口，把默认的json报文去掉，提交请求。<br>或者使用<code>curl -X POST &quot;http://localhost:8080/users/&quot; -H &quot;accept: */*&quot; -H &quot;Content-Type: application/json&quot; -d &quot;{}&quot;</code>请求。<br>报文如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"timestamp"</span>: <span class="string">"2020-03-31T14:35:40.460+0000"</span>,</span><br><span class="line">  <span class="attr">"status"</span>: <span class="number">400</span>,</span><br><span class="line">  <span class="attr">"error"</span>: <span class="string">"Bad Request"</span>,</span><br><span class="line">  <span class="attr">"errors"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"codes"</span>: [</span><br><span class="line">        <span class="string">"NotNull.user.name"</span>,</span><br><span class="line">        <span class="string">"NotNull.name"</span>,</span><br><span class="line">        <span class="string">"NotNull.java.lang.String"</span>,</span><br><span class="line">        <span class="string">"NotNull"</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"arguments"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"codes"</span>: [</span><br><span class="line">            <span class="string">"user.name"</span>,</span><br><span class="line">            <span class="string">"name"</span></span><br><span class="line">          ],</span><br><span class="line">          <span class="attr">"arguments"</span>: <span class="literal">null</span>,</span><br><span class="line">          <span class="attr">"defaultMessage"</span>: <span class="string">"name"</span>,</span><br><span class="line">          <span class="attr">"code"</span>: <span class="string">"name"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"defaultMessage"</span>: <span class="string">"不能为null"</span>,</span><br><span class="line">      <span class="attr">"objectName"</span>: <span class="string">"user"</span>,</span><br><span class="line">      <span class="attr">"field"</span>: <span class="string">"name"</span>,</span><br><span class="line">      <span class="attr">"rejectedValue"</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">"bindingFailure"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"code"</span>: <span class="string">"NotNull"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"codes"</span>: [</span><br><span class="line">        <span class="string">"NotNull.user.age"</span>,</span><br><span class="line">        <span class="string">"NotNull.age"</span>,</span><br><span class="line">        <span class="string">"NotNull.java.lang.Integer"</span>,</span><br><span class="line">        <span class="string">"NotNull"</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"arguments"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"codes"</span>: [</span><br><span class="line">            <span class="string">"user.age"</span>,</span><br><span class="line">            <span class="string">"age"</span></span><br><span class="line">          ],</span><br><span class="line">          <span class="attr">"arguments"</span>: <span class="literal">null</span>,</span><br><span class="line">          <span class="attr">"defaultMessage"</span>: <span class="string">"age"</span>,</span><br><span class="line">          <span class="attr">"code"</span>: <span class="string">"age"</span></span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"defaultMessage"</span>: <span class="string">"不能为null"</span>,</span><br><span class="line">      <span class="attr">"objectName"</span>: <span class="string">"user"</span>,</span><br><span class="line">      <span class="attr">"field"</span>: <span class="string">"age"</span>,</span><br><span class="line">      <span class="attr">"rejectedValue"</span>: <span class="literal">null</span>,</span><br><span class="line">      <span class="attr">"bindingFailure"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"code"</span>: <span class="string">"NotNull"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"message"</span>: <span class="string">"Validation failed for object='user'. Error count: 2"</span>,</span><br><span class="line">  <span class="attr">"path"</span>: <span class="string">"/users/"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>其中参数说明如下：</p><blockquote><p>errors：具体错误原因，是一个数组类型；因为错误校验可能存在多个字段的错误，比如这里因为定义了两个参数不能为Null，所以存在两条错误记录信息<br>message：概要错误消息，返回内容中很容易可以知道，这里的错误原因是对user对象的校验失败，其中错误数量为2，而具体的错误信息就定义在上面的errors数组中</p></blockquote><h2 id="其他校验规则"><a href="#其他校验规则" class="headerlink" title="其他校验规则"></a>其他校验规则</h2><p><code>@Size</code>,<code>@Max</code>,<code>@Min</code>,<code>@Email</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel</span>(description = <span class="string">"用户实体"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"用户编号"</span>)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Size</span>(min=<span class="number">2</span>,max=<span class="number">5</span>)</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"用户姓名"</span>)</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Max</span>(<span class="number">100</span>)</span><br><span class="line">    <span class="meta">@Min</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"用户年龄"</span>)</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NotNull</span></span><br><span class="line">    <span class="meta">@Email</span></span><br><span class="line">    <span class="meta">@ApiModelProperty</span>(<span class="string">"用户邮箱"</span>)</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在swagger ui中post接口输入如下测试数据，并提交请求,或者用<code>curl -X POST &quot;http://localhost:8080/users/&quot; -H &quot;accept: */*&quot; -H &quot;Content-Type: application/json&quot; -d &quot;{ \&quot;age\&quot;: 10, \&quot;email\&quot;: \&quot;test\&quot;, \&quot;id\&quot;: 0, \&quot;name\&quot;: \&quot;test12345678\&quot;}&quot;</code>提交请求。</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"age"</span>: <span class="number">10</span>,</span><br><span class="line">  <span class="attr">"email"</span>: <span class="string">"test"</span>,</span><br><span class="line">  <span class="attr">"id"</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"test12345678"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>返回报文如下：</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"timestamp"</span>: <span class="string">"2020-03-31T14:54:09.958+0000"</span>,</span><br><span class="line">  <span class="attr">"status"</span>: <span class="number">400</span>,</span><br><span class="line">  <span class="attr">"error"</span>: <span class="string">"Bad Request"</span>,</span><br><span class="line">  <span class="attr">"errors"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"codes"</span>: [</span><br><span class="line">        <span class="string">"Email.user.email"</span>,</span><br><span class="line">        <span class="string">"Email.email"</span>,</span><br><span class="line">        <span class="string">"Email.java.lang.String"</span>,</span><br><span class="line">        <span class="string">"Email"</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"arguments"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"codes"</span>: [</span><br><span class="line">            <span class="string">"user.email"</span>,</span><br><span class="line">            <span class="string">"email"</span></span><br><span class="line">          ],</span><br><span class="line">          <span class="attr">"arguments"</span>: <span class="literal">null</span>,</span><br><span class="line">          <span class="attr">"defaultMessage"</span>: <span class="string">"email"</span>,</span><br><span class="line">          <span class="attr">"code"</span>: <span class="string">"email"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        [],</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"defaultMessage"</span>: <span class="string">".*"</span>,</span><br><span class="line">          <span class="attr">"arguments"</span>: <span class="literal">null</span>,</span><br><span class="line">          <span class="attr">"codes"</span>: [</span><br><span class="line">            <span class="string">".*"</span></span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"defaultMessage"</span>: <span class="string">"不是一个合法的电子邮件地址"</span>,</span><br><span class="line">      <span class="attr">"objectName"</span>: <span class="string">"user"</span>,</span><br><span class="line">      <span class="attr">"field"</span>: <span class="string">"email"</span>,</span><br><span class="line">      <span class="attr">"rejectedValue"</span>: <span class="string">"test"</span>,</span><br><span class="line">      <span class="attr">"bindingFailure"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"code"</span>: <span class="string">"Email"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"codes"</span>: [</span><br><span class="line">        <span class="string">"Size.user.name"</span>,</span><br><span class="line">        <span class="string">"Size.name"</span>,</span><br><span class="line">        <span class="string">"Size.java.lang.String"</span>,</span><br><span class="line">        <span class="string">"Size"</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"arguments"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">"codes"</span>: [</span><br><span class="line">            <span class="string">"user.name"</span>,</span><br><span class="line">            <span class="string">"name"</span></span><br><span class="line">          ],</span><br><span class="line">          <span class="attr">"arguments"</span>: <span class="literal">null</span>,</span><br><span class="line">          <span class="attr">"defaultMessage"</span>: <span class="string">"name"</span>,</span><br><span class="line">          <span class="attr">"code"</span>: <span class="string">"name"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="number">5</span>,</span><br><span class="line">        <span class="number">2</span></span><br><span class="line">      ],</span><br><span class="line">      <span class="attr">"defaultMessage"</span>: <span class="string">"个数必须在2和5之间"</span>,</span><br><span class="line">      <span class="attr">"objectName"</span>: <span class="string">"user"</span>,</span><br><span class="line">      <span class="attr">"field"</span>: <span class="string">"name"</span>,</span><br><span class="line">      <span class="attr">"rejectedValue"</span>: <span class="string">"test12345678"</span>,</span><br><span class="line">      <span class="attr">"bindingFailure"</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="attr">"code"</span>: <span class="string">"Size"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"message"</span>: <span class="string">"Validation failed for object='user'. Error count: 2"</span>,</span><br><span class="line">  <span class="attr">"path"</span>: <span class="string">"/users/"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>从errors数组中的各个错误明细中，知道各个字段的defaultMessage，可以看到很清晰的错误描述。</p><blockquote><p>Swagger自身对JSR-303有一定的支持，但是支持的并那么完善，并没有覆盖所有的注解的。Swagger共支持以下几个注解：@NotNull、@Max、@Min、@Size、@Pattern。在实际开发过程中，我们需要分情况来处理，对于Swagger支自动生成的可以利用原生支持来产生，如果有部分字段无法产生，则可以在@ApiModelProperty注解的描述中他，添加相应的校验说明，以便于使用方查看。</p></blockquote>]]></content>
    
    <summary type="html">
    
      Swagger UI的使用和JSR-303的校验用法
    
    </summary>
    
    
      <category term="java" scheme="http://sparkx.com.cn/categories/java/"/>
    
    
      <category term="java" scheme="http://sparkx.com.cn/tags/java/"/>
    
      <category term="springboot" scheme="http://sparkx.com.cn/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>springboot入门</title>
    <link href="http://sparkx.com.cn/springboot/springboot-start/"/>
    <id>http://sparkx.com.cn/springboot/springboot-start/</id>
    <published>2020-03-30T15:03:54.000Z</published>
    <updated>2020-04-01T00:16:52.016Z</updated>
    
    <content type="html"><![CDATA[<h1 id="什么是springboot"><a href="#什么是springboot" class="headerlink" title="什么是springboot?"></a>什么是springboot?</h1><p>Spring Boot是一个更容易上手，更简单快捷地构建Spring应用的框架，可以让我们的Spring应用更加轻量化。主要优点如下：</p><ul><li>开箱即用，提供各种默认配置来简化项目配置</li><li>内嵌式容器简化Web项目</li><li>没有冗余代码生成和XML配置的要求<h1 id="创建基础项目"><a href="#创建基础项目" class="headerlink" title="创建基础项目"></a>创建基础项目</h1>Spring官方提供了非常方便的工具<a href="https://start.spring.io/" target="_blank" rel="noopener">Spring Initializr</a>来帮助我们创建Spring Boot应用。也可以使用IDEA来创建，创建方法网上自行搜索。<br>【强制】GroupID、ArtifactID、Version遵从阿里巴巴java开发手册：</li><li>GroupID 格式： com.{公司/BU }.业务线 [.子业务线]，最多 4 级。<blockquote><blockquote><p>说明： {公司/BU} 例如： alibaba/taobao/tmall/aliexpress 等 BU 一级；子业务线可选。<br>正例： com.taobao.jstorm 或 com.alibaba.dubbo.register</p></blockquote></blockquote></li><li>ArtifactID 格式：产品线名-模块名。语义不重复不遗漏，先到中央仓库去查证一下。<blockquote><blockquote><p>正例： dubbo-client / fastjson-api / jstorm-tool</p></blockquote></blockquote></li><li>Version：详细规定参考下方。<blockquote><blockquote><p>二方库版本号命名方式：主版本号.次版本号.修订号<br>主版本号： 产品方向改变， 或者大规模 API 不兼容， 或者架构不兼容升级。<br>次版本号： 保持相对兼容性，增加主要功能特性，影响范围极小的 API 不兼容修改。<br>修订号： 保持完全兼容性， 修复 BUG、 新增次要功能特性等。</p></blockquote></blockquote><h1 id="项目结构介绍"><a href="#项目结构介绍" class="headerlink" title="项目结构介绍"></a>项目结构介绍</h1></li><li>src/main/java下的程序入口：SpringbootdemoApplication，要注意的是程序入库尽量放到最外层包内，否则controller下面的url会扫描不到；</li><li>src/main/resources下的配置文件：application.properties</li><li>src/test/下的测试入口：SpringbootdemoApplicationTests<h1 id="pom-xml文件"><a href="#pom-xml文件" class="headerlink" title="pom.xml文件"></a>pom.xml文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;project xmlns&#x3D;&quot;http:&#x2F;&#x2F;maven.apache.org&#x2F;POM&#x2F;4.0.0&quot; xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;</span><br><span class="line">xsi:schemaLocation&#x3D;&quot;http:&#x2F;&#x2F;maven.apache.org&#x2F;POM&#x2F;4.0.0 https:&#x2F;&#x2F;maven.apache.org&#x2F;xsd&#x2F;maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">&lt;modelVersion&gt;4.0.0&lt;&#x2F;modelVersion&gt;</span><br><span class="line">&lt;!--继承spring-boot-starter-parent的依赖管理，控制版本与打包等内容--&gt;</span><br><span class="line">&lt;parent&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-parent&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;version&gt;2.1.3.RELEASE&lt;&#x2F;version&gt;</span><br><span class="line">&lt;relativePath&#x2F;&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">&lt;&#x2F;parent&gt;</span><br><span class="line">&lt;groupId&gt;com.example&lt;&#x2F;groupId&gt;</span><br><span class="line">&lt;artifactId&gt;springbootdemo&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;version&gt;0.0.1-SNAPSHOT&lt;&#x2F;version&gt;</span><br><span class="line">&lt;name&gt;springbootdemo&lt;&#x2F;name&gt;</span><br><span class="line">&lt;description&gt;Demo project for Spring Boot&lt;&#x2F;description&gt;</span><br><span class="line"></span><br><span class="line">&lt;properties&gt;</span><br><span class="line">&lt;java.version&gt;1.8&lt;&#x2F;java.version&gt;</span><br><span class="line">&lt;&#x2F;properties&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependencies&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;com.google.code.gson&lt;&#x2F;groupId&gt;</span><br><span class="line">&lt;artifactId&gt;gson&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;commons-lang&lt;&#x2F;groupId&gt;</span><br><span class="line">&lt;artifactId&gt;commons-lang&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;version&gt;2.6&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line">&lt;!--用于实现HTTP接口（该依赖中包含了Spring MVC）--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-web&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line">&lt;!--用于编写单元测试的依赖包--&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-test&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;scope&gt;test&lt;&#x2F;scope&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.projectlombok&lt;&#x2F;groupId&gt;</span><br><span class="line">&lt;artifactId&gt;lombok&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;com.spring4all&lt;&#x2F;groupId&gt;</span><br><span class="line">&lt;artifactId&gt;swagger-spring-boot-starter&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;version&gt;1.9.0.RELEASE&lt;&#x2F;version&gt;</span><br><span class="line">&lt;&#x2F;dependency&gt;</span><br><span class="line">&lt;&#x2F;dependencies&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--构建配置部分:默认使用了spring-boot-maven-plugin，配合spring-boot-starter-parent就可以把Spring Boot应用打包成JAR来直接运行。--&gt;</span><br><span class="line">&lt;build&gt;</span><br><span class="line">&lt;plugins&gt;</span><br><span class="line">&lt;plugin&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-maven-plugin&lt;&#x2F;artifactId&gt;</span><br><span class="line">&lt;&#x2F;plugin&gt;</span><br><span class="line">&lt;&#x2F;plugins&gt;</span><br><span class="line">&lt;&#x2F;build&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;project&gt;</span><br></pre></td></tr></table></figure><h1 id="编写HTTP接口"><a href="#编写HTTP接口" class="headerlink" title="编写HTTP接口"></a>编写HTTP接口</h1>在com.example.springbootdemo创建HelloController类，如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.springbootdemo.controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Hello World"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>启动主程序SpringbootdemoApplication，使用PostMan等工具发起请求:<a href="http://localhost:8080/hello,可以看到页面返回：Hello" target="_blank" rel="noopener">http://localhost:8080/hello,可以看到页面返回：Hello</a> World<h1 id="编写测试单元用例"><a href="#编写测试单元用例" class="headerlink" title="编写测试单元用例"></a>编写测试单元用例</h1>打开src/test/下的SpringbootdemoApplicationTests类，编写简单单元测试，如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.springbootdemo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.springbootdemo.controller.HelloController;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.http.MediaType;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.MockMvc;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.request.MockMvcRequestBuilders;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.web.servlet.setup.MockMvcBuilders;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.hamcrest.Matchers.equalTo;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RunWith</span>(SpringRunner<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">SpringBootTest</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SpringbootdemoApplicationTests</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span> MockMvc mvc;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Before</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">mvc = MockMvcBuilders.standaloneSetup(<span class="keyword">new</span> HelloController()).build();</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getHello</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">mvc.perform(MockMvcRequestBuilders.get(<span class="string">"/hello"</span>).accept(MediaType.APPLICATION_JSON))</span><br><span class="line">.andExpect(status().isOk())</span><br><span class="line">.andExpect(content().string(equalTo(<span class="string">"Hello World"</span>)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>使用MockServletContext来构建一个空的WebApplicationContext，这样我们创建的HelloController就可以在@Before函数中创建并传递到MockMvcBuilders.standaloneSetup()函数中。<h1 id="典型工程结构"><a href="#典型工程结构" class="headerlink" title="典型工程结构"></a>典型工程结构</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">com</span><br><span class="line">  +- example</span><br><span class="line">    +- myproject</span><br><span class="line">      +- Application.java</span><br><span class="line">      |</span><br><span class="line">      +- domain</span><br><span class="line">      |  +- Customer.java</span><br><span class="line">      |  +- CustomerRepository.java</span><br><span class="line">      |</span><br><span class="line">      +- service</span><br><span class="line">      |  +- CustomerService.java</span><br><span class="line">      |</span><br><span class="line">      +- web</span><br><span class="line">      |  +- CustomerController.java</span><br><span class="line">      |</span><br></pre></td></tr></table></figure>root package：com.example.myproject，所有的类和其他package都在root package之下。<br>应用主类：Application.java，该类直接位于root package下。通常我们会在应用主类中做一些框架配置扫描等配置，我们放在root package下可以帮助程序减少手工配置来加载到我们希望被Spring加载的内容。<br>com.example.myproject.domain包：用于定义实体映射关系与数据访问相关的接口和实现。<br>com.example.myproject.service包：用于编写业务逻辑相关的接口与实现。<br>com.example.myproject.web：用于编写Web层相关的实现，比如：Spring MVC的Controller等<br>上面的结构中，root package与应用主类的位置是整个结构的关键。由于应用主类在root package中，所以按照上面的规则定义的所有其他类都处于root package下的其他子包之后。默认情况下，Spring Boot的应用主类会自动扫描root package以及所有子包下的所有类来进行初始化。<h1 id="非典型结构化下的初始化"><a href="#非典型结构化下的初始化" class="headerlink" title="非典型结构化下的初始化"></a>非典型结构化下的初始化</h1>如果，我们一定要加载非root package下的内容有如下两种方法：<br>方法一：可以使用@ComponentScan注解指定具体的加载包，如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@ComponentScan</span>(basePackages=<span class="string">"com.example"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bootstrap</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(Bootstrap<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>这种方法通过注解直接指定要扫描的包，比较直观。如果有这样的需求也是可以用的，但是原则上还是推荐以上面的典型结构来定义，这样也可以少写一些注解，代码更加简洁。<br>方法二：使用@Bean注解来初始化，如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bootstrap</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(Bootstrap<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CustomerController <span class="title">customerController</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CustomerController();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>这种方法在业务开发的时候并不是特别推荐，更适合用于框架封装等场景。</li></ul><h1 id="打印启动日志中的请求路径列表"><a href="#打印启动日志中的请求路径列表" class="headerlink" title="打印启动日志中的请求路径列表"></a>打印启动日志中的请求路径列表</h1><p>Spring Boot 2.1.X版本中已经不再打印请求路径列表，主要是日志打印级别从原来的<code>INFO</code>调整为了<code>TRACE</code>，所以，当我们希望在应用启动的时候打印这些信息的话，只需要在配置文件增增加对RequestMappingHandlerMapping类的打印级别设置即可，比如在application.properties中增加下面这行配置：<br> <figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">logging.level.org.springframework.web.servlet.mvc<span class="function">.<span class="keyword">method</span>.<span class="title">annotation</span>.<span class="title">RequestMappingHandlerMapping</span>=<span class="title">trace</span></span></span><br></pre></td></tr></table></figure><br> 配置好后启动项目，打印请求路径列表如下：<br> <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2020</span>-<span class="number">04</span>-<span class="number">01</span> <span class="number">08</span>:<span class="number">15</span>:<span class="number">34.182</span> TRACE <span class="number">7084</span> --- [           main] s<span class="selector-class">.w</span><span class="selector-class">.s</span><span class="selector-class">.m</span><span class="selector-class">.m</span><span class="selector-class">.a</span><span class="selector-class">.RequestMappingHandlerMapping</span> : </span><br><span class="line">c<span class="selector-class">.e</span><span class="selector-class">.s</span><span class="selector-class">.c</span><span class="selector-class">.HelloController</span>:</span><br><span class="line">&#123; /hello&#125;: index()</span><br><span class="line"><span class="number">2020</span>-<span class="number">04</span>-<span class="number">01</span> <span class="number">08</span>:<span class="number">15</span>:<span class="number">34.188</span> TRACE <span class="number">7084</span> --- [           main] s<span class="selector-class">.w</span><span class="selector-class">.s</span><span class="selector-class">.m</span><span class="selector-class">.m</span><span class="selector-class">.a</span><span class="selector-class">.RequestMappingHandlerMapping</span> : </span><br><span class="line">c<span class="selector-class">.e</span><span class="selector-class">.s</span><span class="selector-class">.c</span><span class="selector-class">.UserController</span>:</span><br><span class="line">&#123;GET /users/&#125;: getUserList()</span><br><span class="line">&#123;POST /users/&#125;: postUser(User)</span><br><span class="line">&#123;PUT /users/id&#125;: getUser(Long)</span><br><span class="line">&#123;PUT /users/&#123;id&#125;&#125;: putUser(Long,User)</span><br><span class="line">&#123;DELETE /users/&#123;id&#125;&#125;: deleteUser(Long)</span><br><span class="line"><span class="number">2020</span>-<span class="number">04</span>-<span class="number">01</span> <span class="number">08</span>:<span class="number">15</span>:<span class="number">34.194</span> TRACE <span class="number">7084</span> --- [           main] s<span class="selector-class">.w</span><span class="selector-class">.s</span><span class="selector-class">.m</span><span class="selector-class">.m</span><span class="selector-class">.a</span><span class="selector-class">.RequestMappingHandlerMapping</span> : </span><br><span class="line">s<span class="selector-class">.d</span><span class="selector-class">.s</span><span class="selector-class">.w</span><span class="selector-class">.ApiResourceController</span>:</span><br><span class="line">&#123; /swagger-resources/configuration/ui&#125;: uiConfiguration()</span><br><span class="line">&#123; /swagger-resources/configuration/security&#125;: securityConfiguration()</span><br><span class="line">&#123; /swagger-resources&#125;: swaggerResources()</span><br><span class="line"><span class="number">2020</span>-<span class="number">04</span>-<span class="number">01</span> <span class="number">08</span>:<span class="number">15</span>:<span class="number">34.200</span> TRACE <span class="number">7084</span> --- [           main] s<span class="selector-class">.w</span><span class="selector-class">.s</span><span class="selector-class">.m</span><span class="selector-class">.m</span><span class="selector-class">.a</span><span class="selector-class">.RequestMappingHandlerMapping</span> : </span><br><span class="line">o<span class="selector-class">.s</span><span class="selector-class">.b</span><span class="selector-class">.a</span><span class="selector-class">.w</span><span class="selector-class">.s</span><span class="selector-class">.e</span><span class="selector-class">.BasicErrorController</span>:</span><br><span class="line">&#123; /error&#125;: error(HttpServletRequest)</span><br><span class="line">&#123; /error, produces [text/html]&#125;: errorHtml(HttpServletRequest,HttpServletResponse)</span><br></pre></td></tr></table></figure><br> 可以看到在2.1.x版本之后，除了调整了日志级别之外，对于打印内容也做了调整。现在的打印内容根据接口创建的Controller类做了分类打印，这样更有助于开发者根据自己编写的Controller来查找初始化了那些HTTP接口。</p>]]></content>
    
    <summary type="html">
    
      介绍springboot入门相关知识
    
    </summary>
    
    
      <category term="java" scheme="http://sparkx.com.cn/categories/java/"/>
    
    
      <category term="java" scheme="http://sparkx.com.cn/tags/java/"/>
    
      <category term="springboot" scheme="http://sparkx.com.cn/tags/springboot/"/>
    
  </entry>
  
  <entry>
    <title>java gc参数</title>
    <link href="http://sparkx.com.cn/java/gc-params/"/>
    <id>http://sparkx.com.cn/java/gc-params/</id>
    <published>2020-02-04T12:23:04.000Z</published>
    <updated>2020-03-30T15:01:35.017Z</updated>
    
    <content type="html"><![CDATA[<p>Java GC相关参数介绍</p><h1 id="PrintGCDetails"><a href="#PrintGCDetails" class="headerlink" title="PrintGCDetails"></a>PrintGCDetails</h1><p>-XX:+PrintGCDetails   //打印gc日志</p><h1 id="Xloggc"><a href="#Xloggc" class="headerlink" title="Xloggc"></a>Xloggc</h1><p>-XX:+PrintGCDetails -verbose:gc -Xloggc:gc.log </p><ul><li>在VM选项加入-Xloggc 运行后在项目文件夹下会生成一个gc.log文件</li></ul><h1 id="UseSerialGC"><a href="#UseSerialGC" class="headerlink" title="UseSerialGC"></a>UseSerialGC</h1><p>-XX:+UseSerialGC</p><ul><li>Serial GC是HotSpot客户端模式VM的默认GC，它是独占式GC，运行过程中会导致应用暂停，并且由于它是单线程执行的，所以暂停时间会比较长；</li><li>Serail GC 在老年代使用了一种叫作“Mark-Sweep-Compact”的算法，它是用于CPU核数比较少且使用内存空间较小的应用程序场景；</li></ul><h1 id="UseParNewGC"><a href="#UseParNewGC" class="headerlink" title="UseParNewGC"></a>UseParNewGC</h1><p>-XX:+UseParNewGC</p><ul><li>ParNew GC是一种独占式的GC，和Serial GC的区别是多线程GC执行；</li></ul><h1 id="UseParallelGC"><a href="#UseParallelGC" class="headerlink" title="UseParallelGC"></a>UseParallelGC</h1><p>-XX:+UseParallelGC</p><ul><li>Parallell GC是JDK7之后默认GC，它通过多线程方式减缓了独占式GC的副作用（停顿时间长）。年轻代和老年代在Parallel GC里都是并行执行且独占的，老年代也执行了压缩操作，这个压缩操作是移动存活对象到相邻位置，这样可以较少内存浪费，更好实现内存布局。</li><li>Serial GC使用单一线程执行GC，而Parallel GC则使用多线程并发执行，因此Parallel GC较Serial GC具有更快的回收速度。Parallel GC适用于多核CPU且使用了较大内存空间的场景；</li><li>Parallel GC被称为“高吞吐GC（Throughput GC）”；</li></ul><h1 id="UseParallelOldGC"><a href="#UseParallelOldGC" class="headerlink" title="UseParallelOldGC"></a>UseParallelOldGC</h1><p>-XX:+UseParallelOldGC</p><ul><li>Parallel Old GC在JDK5中被引入，于Parallel GC相比唯一的区别在于Parallel 0ld GC算法是为老年代设计的，它的执行过程分为三个步骤：标记（Mark）、总结（Summary）、压缩（Compaction）。其中Summary步骤为存活的对象在已执行过GC的空间上标出位置，因此与Mark-Sweep-Compact算法中的Sweep步骤有所区别，并需要一些复杂的步骤才能完成；</li></ul><h1 id="UseConcMarkSweepGC"><a href="#UseConcMarkSweepGC" class="headerlink" title="UseConcMarkSweepGC"></a>UseConcMarkSweepGC</h1><p>-XX:+UseConcMarkSweepGC </p><ul><li>并发标记-清理比其他GC复杂。初始标记（Inital Mark）比较简单，只有靠近类加载器的存活对象会标记，因此停顿时间比较短暂。</li><li>在并发标记(Conncurrent Mark)阶段，刚被确认和标记过的存活对象所关联的对象将会被跟踪和检查存活状态。此步骤的不同之处在于有多个线程并行处理此过程；</li><li>在重标记（ReMark）阶段，有并发标记所关联的新增或者中止的对象会被检测；</li><li>在最后的并发清理（Concurrent Sweep）阶段，垃圾回收过程被真正的执行；</li><li>在垃圾回收执行过程中，其他线程依然保持并行执行，受益于CMS GC的执行方式，在GC期间系统中断的时间非常短暂（G1 GC也采纳了这种设计方案）；</li><li>CMS GC被称为低延迟GC，适用于所有应用对响应时间要求比较严格的场景；<blockquote><p>使用CMS GC之前需要对系统做全面的分析，为了避免过多的内存碎片而需要执行压缩任务是，CMS GC会比其他任何GC带来更多的Stop-the-Wold时间，所以需要分析和判断压缩任务执行的频率以及耗时情况；</p></blockquote></li></ul><h1 id="UseG1GC"><a href="#UseG1GC" class="headerlink" title="UseG1GC"></a>UseG1GC</h1><p>-XX:+UseG1GC</p><ul><li>就是Garbage-first</li></ul><h1 id="PrintGCApplicationStoppedTime"><a href="#PrintGCApplicationStoppedTime" class="headerlink" title="PrintGCApplicationStoppedTime"></a>PrintGCApplicationStoppedTime</h1><p>+XX:+PrintGCApplicationStoppedTime选项会输出GC造成应用程序暂停的时间，一般和-XX:+PrintGCApplicationConcurrentTime组合起来一起使用，这样比较有利于查看输出;</p><h1 id="ConcGCThreads"><a href="#ConcGCThreads" class="headerlink" title="ConcGCThreads"></a>ConcGCThreads</h1><p>-XX:+ConcGCThreads </p><ul><li>选项用来设置与java应用程序并行执行的GC线程数量，默认GC独占时运行线程的1/4。设置过大导致应用程序可使用的CPU资源减少，如果小一点则会对应用程序有利，过小就会回增加GC并行循环的执行时间，反过来减少java应用程序运行时间（因为独占时间拉长）；</li><li>如果不设置并行标记线程数量，默认情况下采用公式：ConcGCThreads=Max((ParallelGCThreads#+2)/4,1),如果设置的值不在有效范围内，就会抛出错误：Invalid number of concurrent marking threads:-XX:ConcGCThreads=[specified_value];</li></ul><h1 id="G1HeapRegionSize"><a href="#G1HeapRegionSize" class="headerlink" title="G1HeapRegionSize"></a>G1HeapRegionSize</h1><p>-XX:+G1HeapRegionSize</p><ul><li>该选项是G1 GC独有选项，专门针对Region这个概念的对应设置选项，Region的大小默认为堆大小的1/2000，也可以设置1MB,2MB,4MB,8MB,16MB,32MB六个划分档次；</li></ul><h1 id="G1HeapWastePercent"><a href="#G1HeapWastePercent" class="headerlink" title="G1HeapWastePercent"></a>G1HeapWastePercent</h1><p>-XX:G1HeapWastePercent</p><ul><li>该选项控制G1 GC不会回收的空闲内存比例，默认是堆内存的5%。G1 GC在回收过程中会回收所有Region的内存，并持续地做这个工作直到空闲内存比例达到设置的这个值为止，所以对于设置了较大值的堆内存来说，需要采用比较低的比例，这样可以确保较小部分的内存不被回收。该值为1或99都是比较极端的值，会导致因GC线程造成应用程序暂停时间增加;</li></ul><h1 id="G1MixedGCCountTarget"><a href="#G1MixedGCCountTarget" class="headerlink" title="G1MixedGCCountTarget"></a>G1MixedGCCountTarget</h1><p>-XX:+G1MixedGCCountTarget</p><ul><li>老年代Region的回收时间通常比年轻代Region稍长一些，这个选项可以设置一个并行循环之后启动多少个混合GC，默认值是8个。设置一个比较大的值可以让G1 GC在老年代Region回收时多花一些时间，如果一个混合GC的停顿时间很长，说明它要做的事情很多，所以可以增大这个值的设置，但是如果这个值设置过大，也会造成并行循环等待混合GC完成的时间;</li><li>这个选项和G1MixedGCLIveThresholdPercent选项（默认值65%，指的是混合回收阶段回收老年代区间的上限阈值）有直接关联，G1MixedGCLIveThresholdPercent设置完毕后，对存活数据回收的上限为G1MixedGCLIveThresholdPercent的旧区域执行混合垃圾回收的目标次数，这个选项会自动调整为满足配置的阈值，以便能够快速回收对象;</li></ul><h1 id="G1PrintRegionLivenessInfo"><a href="#G1PrintRegionLivenessInfo" class="headerlink" title="G1PrintRegionLivenessInfo"></a>G1PrintRegionLivenessInfo</h1><p>-XX:+G1PrintRegionLivenessInfo </p><ul><li>由于开启这个选项会在标记循环阶段完成之后输出详细信息，专业一点叫法是诊断选项，所以在使用前需要开启选项UnlockDiagnosticVMOptions。这个选项启用后会打印堆内部每个Region里面的存活对象信息，这些信息包括使用率、RSet大小、回收一个Region的价值（Region内部回收价值评估，即性价比）;</li><li>这个选项输出的信息对于堆内Region是很有效的，不过对于一个很大的堆内存来说，由于每个Region信息都输出了，所以信息量也是挺大的;</li><li>-XX:+UnlockDiagnosticVMOptions必须放在-XX:+G1PrintRegionLivenessInfo的前面，证明VM的选项执行顺序也是串行的;</li></ul><h1 id="G1ResevePercent"><a href="#G1ResevePercent" class="headerlink" title="G1ResevePercent"></a>G1ResevePercent</h1><p>-XX:+G1ResevePercent</p><ul><li>每个年龄代都会有一些对象可以进入下一个阶段，为了确保这个提升过程正常完成，我们允许G1 GC保留一些内存，这样就可以避免出现“to space exhausted”错误，这个选项就是为了这个用途;</li><li>默认保留堆内存10% ,但也不能超过对内存的50%，并且这个预留空间不能用于年轻代。</li><li>对于一个拥有大内存的堆内存来说，这个值不能过大，因为它不能用于年轻代，这就意味着年轻代可用内存降低了。减小这个值有助于给年轻代留出更大的空间、更长的GC时间，这对提升性能吞吐量有好处;</li></ul><h1 id="G1SummarizeRSetStats"><a href="#G1SummarizeRSetStats" class="headerlink" title="G1SummarizeRSetStats"></a>G1SummarizeRSetStats</h1><p>-XX:+G1SUmmarizeRSetStats</p><ul><li>该选项和G1PrintRegionLivenessInfo选项一样，这个选项也是诊断选项，需开启UnlockDiagnosticVMOptions选项后才能使用，这说明-XX:+UnlockDiagnosticVMOptions必须放在-XX:+G1SUmmarizeRSetStats前面;</li><li>该选项和-XX:+G1SummarizeRSetStatsPeriod一起使用的时候会阶段性地大于RSet的详细信息，这有助于找到RSet里面存在的问题;</li></ul><h1 id="G1TraceConcRefinement"><a href="#G1TraceConcRefinement" class="headerlink" title="G1TraceConcRefinement"></a>G1TraceConcRefinement</h1><p>+XX:+G1TraceConcRefinement</p><ul><li>诊断选项，启动该选项，并行Refinement线程相关的信息会被打印，并且线程启动和结束的信息都会被打印；</li><li>垃圾收集器对应的GC线程</li></ul><table><thead><tr><th>Garbeg Collector</th><th>Worker Thread Used</th></tr></thead><tbody><tr><td>Parallel GC</td><td>ParallelGCThreads</td></tr><tr><td>CMS GC</td><td>ParallelGCThreads,ConcGCThreads</td></tr><tr><td>G1 GC</td><td>ParallelGCThreads,ConcGCThreads,G1GonCRefinementThreads</td></tr></tbody></table><ul><li>GC线程定义</li></ul><table><thead><tr><th>名称</th><th>选项控制</th><th>作用</th></tr></thead><tbody><tr><td>ParallelGC Thread</td><td>-XX:+ParallelGCThreads</td><td>GC的并行工作线程，专门用于独占阶段的工作，比如拷贝存活对象</td></tr><tr><td>ParallelMarkingThreads</td><td>-XX:+ConcGCThreads</td><td>并行标记阶段并行线程，它由一个主控（Master）线程和一些工作（Worker)线程组成，可以和应用程序并行执行</td></tr><tr><td>G1ConcurrentRefinementThreads</td><td>-XX:+G1ConcRefinementThreads</td><td>和应用程序一起运行，用于更新RSet。如果ConcurrentRefinementThreads没有设置，那么默认ParallelGCThreads +1</td></tr></tbody></table><h1 id="G1UseAdaptiveConcRefinement"><a href="#G1UseAdaptiveConcRefinement" class="headerlink" title="G1UseAdaptiveConcRefinement"></a>G1UseAdaptiveConcRefinement</h1><p>-XX:+G1UseAdaptiveConcRefinement</p><ul><li>该选项默认开启，它会动态对每一次GC中-XX:+G1ConcRefinementGreenZone、-XX:+G1ConcRefinementYellowZone、-XX:+G1ConcRefinementRedZone的值进行重新计算；</li><li>并行Refinement线程是持续运行的，并且会随着update log buffer积累的数量而动态调节。前面说的三个选项-XX:+G1ConcRefinementGreenZone、-XX:+G1ConcRefinementYellowZone、-XX:+G1ConcRefinementRedZone是被用来根据不同buffer使用不同的Refinement线程，目的就是为了保证Refinement线程一定要尽可能地跟上update log buffer产生的速度，update log buffer开始出现积压的情况，Mutator线程就会协助Refinement线程执行RSet的更新工作。这个Mutator线程实际上就是应用业务线程，当业务线程参与RSet修改时，系统性能一定会受到影响，所以需要尽力去避免这种状况;</li></ul><h1 id="GCTimeRatio"><a href="#GCTimeRatio" class="headerlink" title="GCTimeRatio"></a>GCTimeRatio</h1><p>-XX:+GCTimeRatio</p><ul><li>这个选项代表java应用线程话费时间与GC线程话费时间的比率，通过这个比率值可以调节java应用程序或者GC线程工作时间，保障两者执行时间。</li><li>HotSpot VM转换这个值为一个百分比，公式是100/(1+GCTimeRatio)，默认值是9，表示话费在GC工作量上的时间占总时间的10%。Parallel GC里这个值为99，即代表GC只有1%的时间;</li></ul><h1 id="HeapDumpBeforeFullGC-HeapDumpAfterFullGC"><a href="#HeapDumpBeforeFullGC-HeapDumpAfterFullGC" class="headerlink" title="HeapDumpBeforeFullGC/HeapDumpAfterFullGC"></a>HeapDumpBeforeFullGC/HeapDumpAfterFullGC</h1><p>-XX:+HeapDumpBeforeFullGC/-XX:+HeapDumpAfterFullGC</p><ul><li>开启这个选项后，在Full GC开始之前有一个hprof文件会被创建。建议这个选项和-XX:+HeapDumpAfterFullGC一起使用，可以通过对Full GC发生前后的Java堆内存进行对比，找出内存泄漏和其他问题;</li></ul><h1 id="InitiatingHeapOccypancyPercent"><a href="#InitiatingHeapOccypancyPercent" class="headerlink" title="InitiatingHeapOccypancyPercent"></a>InitiatingHeapOccypancyPercent</h1><p>-XX:+InitiatingHeapOccypancyPercent</p><ul><li>该选项的默认值是45，表示G1 GC并行循环初始的堆大小值，这个值决定了一个并行循环是不是要开始执行;</li><li>它的逻辑是在一次GC完成后，比较老年代占用空间和整个Java堆之间的比例。如果大于这个值，则预约下一次GC开始一个并行循环回收垃圾，从初始标记阶段开始。这个值越小，GC越频繁，反之，值越大，可以让应用程序执行时间更长。不过在内存消耗很快的情况下，早运行并行循环比晚运行要好，即看病要趁早;</li></ul><h1 id="UseStringDeduplication"><a href="#UseStringDeduplication" class="headerlink" title="UseStringDeduplication"></a>UseStringDeduplication</h1><p>-XX:+UseStringDeduplication</p><ul><li>该选项启动Java String对象的去重工作。JDK8u20开始引入该选项，默认为不启用;</li><li>我们知道一个判断Java String对象值是否一样的语句String1.equals(String2)=true,如果开启了该选线，并且如果两个对象包含相同的内容，即返回true,则两个String对象只会共享一个字符数组;</li><li>这个选项是G1 GC独有的，也可以和其他GC一起使用;</li><li>一个去重对象必备条件<ul><li>Java.lang.String对象的一个实例</li><li>这个对象在年轻代堆区间</li><li>这个对象的年龄达到去重年龄代，或者这个对象已经在老年代堆区间并且对象年龄比去重年龄小。选项-XX:_StringDeduplicationAgeThreshold设置了这个年龄界限。</li></ul></li><li>可修改和不可修改字符串的处理方式不同，不可修改字符串默认就是去重的，在插入到HotSpot VM的StringTable时已经注明了时去重的，这样就避免了HotSpot服务器JIT编译优化措施;</li></ul><h1 id="StringDeduplicationAgeThreshold"><a href="#StringDeduplicationAgeThreshold" class="headerlink" title="StringDeduplicationAgeThreshold"></a>StringDeduplicationAgeThreshold</h1><p>-XX:+StringDeduplictionAgeThreshold</p><ul><li>该选项是针对-XX:+UseStringDedupliction选项的，默认值是3，即一个字符串对象的年龄超过设定的阈值，或者提升到G1 GC老年代Region之后，就会成为字符串去重的候选对象，去重操作只会有一次;</li></ul><h1 id="PrintStringDeduplicationStatistics"><a href="#PrintStringDeduplicationStatistics" class="headerlink" title="PrintStringDeduplicationStatistics"></a>PrintStringDeduplicationStatistics</h1><p>-XX:+PrintStringDeduplicationStaticstics</p><ul><li>该选项很有用，能够帮助我们通过读取输出的统计资料来了解是否字符串去重后节约了大量的堆空间，默认是关闭的，就是说不会输出字符串去重统计资料;</li></ul><h1 id="G1UseAdaptiveIHOP"><a href="#G1UseAdaptiveIHOP" class="headerlink" title="G1UseAdaptiveIHOP"></a>G1UseAdaptiveIHOP</h1><p>-XX:+G1UseAdaptiveIHOP</p><ul><li>JDK9提供的新的选项，这个选项作用是通过动态调节标记阶段开始的时间，以达到提升应用程序吞吐量的目标，主要通过尽可能迟地触发标记循环方式来避免消耗老年代空间。</li><li>该选项的值在VM刚开始启动时和-XX:InitiatingHeapOccupancyPercent的值一样，如果出现标记循环阶段内存不够用，则它会自动调节大小，确保标记循环启用更多的堆内存。</li><li>该选项在JDK9默认启用，即-XX:+InitiatingHeapOccupancyPercent和-XX:+G1UseAdaptiveIHOP在JDK9之后只需要启动一个即可;</li></ul><h1 id="MaxGCPauseMills"><a href="#MaxGCPauseMills" class="headerlink" title="MaxGCPauseMills"></a>MaxGCPauseMills</h1><p>-XX:MaxGCPauseMills</p><ul><li>该选项比较重要，它设置了G1的目标停顿时间，单位是毫秒，默认200ms。</li><li>这个值是一个目标时间，而不是最大停顿时间，G1 GC尽最大努力确保年轻代的回收时间可以控制在这个目标停顿时间范围里面，在G1 GC使用过程中，这个选项和-Xms、-Xmx两个选项一起使用，他们三个也是最好在JVM启动时就配置好;</li></ul><h1 id="MinHeapFreeRatio"><a href="#MinHeapFreeRatio" class="headerlink" title="MinHeapFreeRatio"></a>MinHeapFreeRatio</h1><p>-XX:MinHeapFreeRatio</p><ul><li>该选项设置堆内存里可以空闲的最小的内存空间大小，默认值为堆内存的40%。</li><li>当空闲堆内存小于这个值时，我们需要判断-Xms,-Xmx这两个值的初始化设置值，如果-Xms和-Xmx不一样，那么就有机会扩展堆内存，否则无法扩展;</li><li>最小空闲内存必须小于堆内存;</li></ul><h1 id="MaxHeapFreeRatio"><a href="#MaxHeapFreeRatio" class="headerlink" title="MaxHeapFreeRatio"></a>MaxHeapFreeRatio</h1><p>-XX:MaxHeapFreeRatio</p><ul><li>该选项最大空闲空间大小，默认值为堆内存的70%；</li><li>这个选项和MinHeapFreeRatio相反，当大于这个空闲比率是，G1 GC会自动减少堆内存大小；</li><li>需要判断-Xms,-Xmx这两个值的初始化设置值，如果-Xms和-Xmx不一样，那么就有机会扩展堆内存，否则无法扩展；</li></ul><h1 id="PrintAdaptiveSizePolicy"><a href="#PrintAdaptiveSizePolicy" class="headerlink" title="PrintAdaptiveSizePolicy"></a>PrintAdaptiveSizePolicy</h1><p>-XX:+PrintAdaptiveSizePolicy</p><ul><li>该选项决定是否开启堆内存大小变化的相应记录信息打印，即是否打印这些信息到GC日子里面；</li><li>这个信息对于Parallel GC和G1 GC都很有用；</li></ul><h1 id="ResizePLAB"><a href="#ResizePLAB" class="headerlink" title="ResizePLAB"></a>ResizePLAB</h1><p>-XX:+ResizePLAB</p><ul><li>GC使用的本地线程分配缓存块采用动态值还是静态值进行设置是由这个选项决定的，它默认是开启的，这个设置对应的GC在提升对象时是否会调整PLAB的大小。</li><li>使用该选项需谨慎，据说会出现性能问题，启用后可能会增加GC的停顿时间。当应用开启的多线程较多时，最好使用-XX:+ResizePLAB来关闭PLAB()的大小调整，以避免大量线程通信导致的性能下降;</li></ul><h1 id="ResizeTLAB"><a href="#ResizeTLAB" class="headerlink" title="ResizeTLAB"></a>ResizeTLAB</h1><p>-XX:+ResizeTLAB</p><ul><li>Java应用线程使用的本地线程分配缓存块采用动态值还是静态值进行设置是由这个选项决定的，默认是开启的，即TLAB值会被动态调整；</li><li>TLAB是否启用对于对象分配的影响是很大的。由于TLAB空间一般不会太大，因此大对象无法在TLAB上进行分配，总是直接分配在堆上。因此TLAB空间比较小，因此很容易被装满。如果开启ResizeTLAB,TLAB会在运行时不断调整，使系统的运行状态达到最优；</li><li>和PLAB值动态调整不同的是，这个选项开启后会较大地提升应用程序性能，因为TLAB的竞争、切换减少了，所以默认还是开启它;</li></ul><h1 id="ClassUnloadingWithConcurrentMark"><a href="#ClassUnloadingWithConcurrentMark" class="headerlink" title="ClassUnloadingWithConcurrentMark"></a>ClassUnloadingWithConcurrentMark</h1><p>-XX:+ClassUnloadingWithConcurrentMark</p><ul><li>该选项开启在G1 GC并行循环阶段卸载类，尤其是在老年代的并行回收阶段，默认是开启的；</li><li>该选项开启后会在并行循环的重标记阶段卸载JVM没有用到的类，这些工作也可以放在Full GC里面去做，但是提前做有很大的好处。但因为开启它意味着重标记阶段的GC停顿时间会拉长，这时我们就要判断性价比了，如果GC停顿时间比设置的最大GC停顿目标时间还长，并且需要卸载的类不多，就可以关闭该选项；</li></ul><h1 id="ClassUnloading"><a href="#ClassUnloading" class="headerlink" title="ClassUnloading"></a>ClassUnloading</h1><p>-XX:+ClassUnloading</p><ul><li>默认值是true,决定了JVM是否会卸载所有无用的类，如果关闭了这个选项，无论是否并行回收循环，还是Full GC,都不会再卸载这些类了，所以谨慎关闭；<br>UnlockDiagnosticVMOptions</li></ul><p>-XX:+UnlockDiagnosticVMOptions</p><ul><li>该选项决定是否开启诊断选项，默认值是False，不开启；</li><li>GC里有一些选项称为诊断选项（Diagnostic Options），通过-XX:+PrintFlagsFinal和-XX:+UnlockDiagnosticVMOptions这两个选项组合起来运行，就可以输出并查看这些选项；</li></ul><h1 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h1><p>《深入理解JVM &amp; G1 GC》</p>]]></content>
    
    <summary type="html">
    
      Java GC相关参数介绍
    
    </summary>
    
    
      <category term="java" scheme="http://sparkx.com.cn/categories/java/"/>
    
    
      <category term="java" scheme="http://sparkx.com.cn/tags/java/"/>
    
      <category term="tools" scheme="http://sparkx.com.cn/tags/tools/"/>
    
  </entry>
  
  <entry>
    <title>flink on yarn集群搭建</title>
    <link href="http://sparkx.com.cn/flink/flink-on-yarn/"/>
    <id>http://sparkx.com.cn/flink/flink-on-yarn/</id>
    <published>2020-01-22T11:06:35.000Z</published>
    <updated>2020-03-30T15:01:35.008Z</updated>
    
    <content type="html"><![CDATA[<h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>zookeeper集群搭建：<a href="http://sparkx.com.cn/zookeeper/zookeeper-ha/">点击查看</a><br>hadoop集群搭建：<a href="http://sparkx.com.cn/hadoop/hadoop2-ha-deployment/#more">点击查看</a></p><h2 id="Flink-on-yarn的整个交互"><a href="#Flink-on-yarn的整个交互" class="headerlink" title="Flink on yarn的整个交互"></a>Flink on yarn的整个交互</h2><p><img src="/images/flink/flink-on-yarn-arch.png" alt=""><br>要使得flink运行于yarn上，flink要能找到hadoop配置，因为要连接到yarn的resourcemanager和hdfs。可以使用下面的策略来指定hadoop配置：<br>1.会查看YARN_CONF_DIR，HADOOP_CONF_DIR或者HADOOP_CONF_PATH是否设置，按照顺序检查的。然后，假如配置了就会从该文件夹下读取配置。<br>2.如果上面环境变量都没有配置的话，会使用HADOOP_HOME环境变量。对于hadoop2的话会查找的配置路径是 $HADOOP_HOME/etc/hadoop;</p><h2 id="Flink两种作业提交"><a href="#Flink两种作业提交" class="headerlink" title="Flink两种作业提交"></a>Flink两种作业提交</h2><p><strong>yarn seesion</strong><br><strong>Flink run</strong><br>这2者对于现有大数据平台资源使用率有着很大的区别：<br>1.第一种yarn seesion(Start a long-running Flink cluster on YARN)这种方式需要先启动集群，然后在提交作业，接着会向yarn申请一块空间后，资源永远保持不变。如果资源满了，下一个作业就无法提交，只能等到yarn中的其中一个作业执行完成后，释放了资源，那下一个作业才会正常提交.<br>2.第二种Flink run直接在YARN上提交运行Flink作业(Run a Flink job on YARN)，这种方式的好处是一个任务会对应一个job,即没提交一个作业会根据自身的情况，向yarn申请资源，直到作业执行完成，并不会影响下一个作业的正常运行，除非是yarn上面没有任何资源的情况下。<br>两种运行方式示意图:<br><img src="/images/flink/flink-on-yarn-two-run.png" alt=""><br>如果开发和测试推荐第一种方案，生产环境推荐使用第二种方案；<br>Flink on yarn模式部署时，不需要对Flink做任何修改配置，只需要将其解压传输到各个节点之上。但如果要实现高可用的方案，这个时候就需要到Flink相应的配置修改参数，具体的配置文件是FLINK_HOME/conf/flink-conf.yaml。<br>对于Flink on yarn模式，不需要在conf配置下配置 masters和slaves。因为在指定TM的时候可以通过参数“-n”来标识需要启动几个TM;Flink on yarn启动后，如果是在分离式模式你会发现，在所有的节点只会出现一个 YarnSessionClusterEntrypoint进程；如果是客户端模式会出现2个进程一个YarnSessionClusterEntrypoint和一个FlinkYarnSessionCli进程，并且两个进程可能不在一台服务器上。</p><h2 id="安装Flink"><a href="#安装Flink" class="headerlink" title="安装Flink"></a>安装Flink</h2><p>官网下载页面：<a href="https://flink.apache.org/downloads.html" target="_blank" rel="noopener">点击进入</a>，下载Apache Flink 1.9.1 for Scala 2.11二进制包。<br>因为要使用HDFS和YARN所以需要下载相关的jar，在flink二进制包下面的Optional components选项里下载对应hadoop版本的依赖Jar，因为我使用的是hadoop-2.6.5，要下载<a href="https://repo.maven.apache.org/maven2/org/apache/flink/flink-shaded-hadoop-2-uber/2.6.5-7.0/flink-shaded-hadoop-2-uber-2.6.5-7.0.jar" target="_blank" rel="noopener">Pre-bundled Hadoop 2.6.5</a><br>1.上传flink-1.9.1-bin-scala_2.11.tgz到服务器，并执行命令<code>tar -zxvf flink-1.9.1-bin-scala_2.11.tgz</code>解压到/usr/local/flink目录。<br>2.配置环境变量<code>export FLINK_HOME=/usr/local/flink/flink-1.9.1</code>，并将FLINK_HOME添加到<code>PATH</code>中。<br>3.修改配置<code>FLINK_HOME/conf/flink-conf.yaml</code>如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="comment"># Common</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="attr">env.java.home:</span> <span class="string">/usr/local/jdk/jdk1.8.0_151</span></span><br><span class="line"><span class="attr">jobmanager.rpc.address:</span> <span class="string">localhost</span></span><br><span class="line"><span class="comment"># The RPC port where the JobManager is reachable.</span></span><br><span class="line"><span class="attr">jobmanager.rpc.port:</span> <span class="number">6123</span></span><br><span class="line"><span class="comment"># The heap size for the JobManager JVM</span></span><br><span class="line"><span class="attr">jobmanager.heap.size:</span> <span class="string">1024m</span></span><br><span class="line"><span class="comment"># The heap size for the TaskManager JVM</span></span><br><span class="line"><span class="attr">taskmanager.heap.size:</span> <span class="string">1024m</span></span><br><span class="line"><span class="comment"># The number of task slots that each TaskManager offers. Each slot runs one parallel pipeline.</span></span><br><span class="line"><span class="attr">taskmanager.numberOfTaskSlots:</span> <span class="number">1</span></span><br><span class="line"><span class="comment"># The parallelism used for programs that did not specify and other parallelism.</span></span><br><span class="line"><span class="attr">parallelism.default:</span> <span class="number">1</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="comment"># High Availability</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="comment"># 配置high-availability mode</span></span><br><span class="line"><span class="attr">high-availability:</span> <span class="string">zookeeper</span></span><br><span class="line"><span class="comment"># 配置zookeeper quorum（hostname和端口需要依据对应zk的实际配置）</span></span><br><span class="line"><span class="attr">high-availability.zookeeper.quorum:</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.120</span><span class="string">:2181,192.168.112.121:2181,192.168.112.122:2181</span></span><br><span class="line"><span class="comment"># （可选）设置zookeeper的root目录</span></span><br><span class="line"><span class="attr">high-availability.zookeeper.path.root:</span> <span class="string">/flink</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># （可选）相当于是这个standalone集群中创建的zk node的namespace</span></span><br><span class="line"><span class="attr">high-availability.cluster-id:</span> <span class="string">/cluster_flink_uat</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># JobManager的meta信息放在dfs，在zk上主要会保存一个指向dfs路径的指针</span></span><br><span class="line"><span class="attr">high-availability.storageDir:</span> <span class="string">hdfs:///flink/ha</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="comment"># Fault tolerance and checkpointing</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="attr">jobmanager.execution.failover-strategy:</span> <span class="string">region</span></span><br><span class="line"><span class="comment">#添加hadoop配置目录：</span></span><br><span class="line"><span class="attr">fs.hdfs.hadoopconf:</span> <span class="string">/usr/local/hadoop/hadoop-2.6.5/etc/hadoop</span></span><br></pre></td></tr></table></figure><p>4.拷贝到其他服务器上</p><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scp -r flink<span class="number">-1.9</span><span class="number">.1</span> <span class="string">worker1:</span><span class="regexp">/usr/</span>local<span class="regexp">/flink/</span></span><br><span class="line">scp -r flink<span class="number">-1.9</span><span class="number">.1</span> <span class="string">worker2:</span><span class="regexp">/usr/</span>local<span class="regexp">/flink/</span></span><br></pre></td></tr></table></figure><p>5.运行<br>运行./yarn-session.sh使用默认配置：{masterMemoryMB=1024, taskManagerMemoryMB=1024, numberTaskManagers=1, slotsPerTaskManager=1}</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">root@master1:/usr/local/flink/flink-1.9.1/bin#</span> <span class="string">./yarn-session.sh</span> </span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,922</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">env.java.home,</span> <span class="string">/usr/local/jdk/jdk1.8.0_151</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,926</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">jobmanager.rpc.address,</span> <span class="string">localhost</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,927</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">jobmanager.rpc.port,</span> <span class="number">6123</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,927</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">jobmanager.heap.size,</span> <span class="string">1024m</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,928</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">taskmanager.heap.size,</span> <span class="string">1024m</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,928</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">taskmanager.numberOfTaskSlots,</span> <span class="number">1</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,929</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">parallelism.default,</span> <span class="number">1</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,930</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">high-availability,</span> <span class="string">zookeeper</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,930</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">high-availability.zookeeper.quorum,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.120</span><span class="string">:2181,192.168.112.121:2181,192.168.112.122:2181</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,931</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">high-availability.zookeeper.path.root,</span> <span class="string">/flink</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,932</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">high-availability.cluster-id,</span> <span class="string">/cluster_flink_uat</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,933</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">high-availability.storageDir,</span> <span class="string">hdfs:///flink/ha</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:43,934</span> <span class="attr">INFO  org.apache.flink.configuration.GlobalConfiguration            - Loading configuration property:</span> <span class="string">jobmanager.execution.failover-strategy,</span> <span class="string">region</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:44,982</span> <span class="string">WARN</span>  <span class="string">org.apache.hadoop.util.NativeCodeLoader</span>                       <span class="bullet">-</span> <span class="string">Unable</span> <span class="string">to</span> <span class="string">load</span> <span class="string">native-hadoop</span> <span class="string">library</span> <span class="string">for</span> <span class="string">your</span> <span class="string">platform...</span> <span class="string">using</span> <span class="string">builtin-java</span> <span class="string">classes</span> <span class="string">where</span> <span class="string">applicable</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:45,178</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.runtime.security.modules.HadoopModule</span>        <span class="bullet">-</span> <span class="string">Hadoop</span> <span class="string">user</span> <span class="string">set</span> <span class="string">to</span> <span class="string">root</span> <span class="string">(auth:SIMPLE)</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:45,963</span> <span class="string">INFO</span>  <span class="string">org.apache.hadoop.yarn.client.ConfiguredRMFailoverProxyProvider</span>  <span class="bullet">-</span> <span class="string">Failing</span> <span class="string">over</span> <span class="string">to</span> <span class="string">rm2</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:46,135</span> <span class="attr">INFO  org.apache.flink.yarn.AbstractYarnClusterDescriptor           - Cluster specification:</span> <span class="string">ClusterSpecification&#123;masterMemoryMB=1024,</span> <span class="string">taskManagerMemoryMB=1024,</span> <span class="string">numberTaskManagers=1,</span> <span class="string">slotsPerTaskManager=1&#125;</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:47,028</span> <span class="string">WARN</span>  <span class="string">org.apache.flink.yarn.AbstractYarnClusterDescriptor</span>           <span class="bullet">-</span> <span class="string">The</span> <span class="string">configuration</span> <span class="string">directory</span> <span class="string">('/usr/local/flink/flink-1.9.1/conf')</span> <span class="string">contains</span> <span class="string">both</span> <span class="string">LOG4J</span> <span class="string">and</span> <span class="string">Logback</span> <span class="string">configuration</span> <span class="string">files.</span> <span class="string">Please</span> <span class="string">delete</span> <span class="string">or</span> <span class="string">rename</span> <span class="string">one</span> <span class="string">of</span> <span class="string">them.</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:54,829</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.yarn.AbstractYarnClusterDescriptor</span>           <span class="bullet">-</span> <span class="string">Submitting</span> <span class="string">application</span> <span class="string">master</span> <span class="string">application_1579682649257_0001</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:55,033</span> <span class="string">INFO</span>  <span class="string">org.apache.hadoop.yarn.client.api.impl.YarnClientImpl</span>         <span class="bullet">-</span> <span class="string">Submitted</span> <span class="string">application</span> <span class="string">application_1579682649257_0001</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:55,033</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.yarn.AbstractYarnClusterDescriptor</span>           <span class="bullet">-</span> <span class="string">Waiting</span> <span class="string">for</span> <span class="string">the</span> <span class="string">cluster</span> <span class="string">to</span> <span class="string">be</span> <span class="string">allocated</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:26:55,046</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.yarn.AbstractYarnClusterDescriptor</span>           <span class="bullet">-</span> <span class="string">Deploying</span> <span class="string">cluster,</span> <span class="string">current</span> <span class="string">state</span> <span class="string">ACCEPTED</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,510</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.yarn.AbstractYarnClusterDescriptor</span>           <span class="bullet">-</span> <span class="string">YARN</span> <span class="string">application</span> <span class="string">has</span> <span class="string">been</span> <span class="string">deployed</span> <span class="string">successfully.</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,696</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.runtime.blob.FileSystemBlobStore</span>             <span class="bullet">-</span> <span class="string">Creating</span> <span class="string">highly</span> <span class="string">available</span> <span class="string">BLOB</span> <span class="string">storage</span> <span class="string">directory</span> <span class="string">at</span> <span class="string">hdfs:///flink/ha//cluster_flink_uat/blob</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,792</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.curator.org.apache.curator.framework.imps.CuratorFrameworkImpl</span>  <span class="bullet">-</span> <span class="string">Starting</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,802</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:zookeeper.version=3.4.10-39d3a4f269333c922ed3db283be479f9deacaa0f,</span> <span class="string">built</span> <span class="string">on</span> <span class="number">03</span><span class="string">/23/2017</span> <span class="number">10</span><span class="string">:13</span> <span class="string">GMT</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,803</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:host.name=master1</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,803</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:java.version=1.8.0_151</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,803</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:java.vendor=Oracle</span> <span class="string">Corporation</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,804</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:java.home=/usr/local/jdk/jdk1.8.0_151/jre</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,804</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:java.class.path=/usr/local/flink/flink-1.9.1/lib/flink-shaded-hadoop-2-uber-2.6.5-7.0.jar:/usr/local/flink/flink-1.9.1/lib/flink-table_2.11-1.9.1.jar:/usr/local/flink/flink-1.9.1/lib/flink-table-blink_2.11-1.9.1.jar:/usr/local/flink/flink-1.9.1/lib/log4j-1.2.17.jar:/usr/local/flink/flink-1.9.1/lib/slf4j-log4j12-1.7.15.jar:/usr/local/flink/flink-1.9.1/lib/flink-dist_2.11-1.9.1.jar::/usr/local/hadoop/hadoop-2.6.5/etc/hadoop:</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,805</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,806</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:java.io.tmpdir=/tmp</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,808</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:java.compiler=&lt;NA&gt;</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,808</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:os.name=Linux</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,809</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:os.arch=amd64</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,810</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:os.version=4.2.0-16-generic</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,817</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:user.name=root</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,818</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:user.home=/root</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,818</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Client</span> <span class="string">environment:user.dir=/usr/local/flink/flink-1.9.1/bin</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,819</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ZooKeeper</span>  <span class="bullet">-</span> <span class="string">Initiating</span> <span class="string">client</span> <span class="string">connection,</span> <span class="string">connectString=192.168.112.120:2181,192.168.112.121:2181,192.168.112.122:2181</span> <span class="string">sessionTimeout=60000</span> <span class="string">watcher=org.apache.flink.shaded.curator.org.apache.curator.ConnectionState@4879f0f2</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,854</span> <span class="attr">WARN  org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ClientCnxn  - SASL configuration failed: javax.security.auth.login.LoginException:</span> <span class="literal">No</span> <span class="string">JAAS</span> <span class="string">configuration</span> <span class="string">section</span> <span class="string">named</span> <span class="string">'Client'</span> <span class="attr">was found in specified JAAS configuration file:</span> <span class="string">'/tmp/jaas-7446269064531744688.conf'</span><span class="string">.</span> <span class="string">Will</span> <span class="string">continue</span> <span class="string">connection</span> <span class="string">to</span> <span class="string">Zookeeper</span> <span class="string">server</span> <span class="string">without</span> <span class="string">SASL</span> <span class="string">authentication,</span> <span class="string">if</span> <span class="string">Zookeeper</span> <span class="string">server</span> <span class="string">allows</span> <span class="string">it.</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,857</span> <span class="string">ERROR</span> <span class="string">org.apache.flink.shaded.curator.org.apache.curator.ConnectionState</span>  <span class="bullet">-</span> <span class="string">Authentication</span> <span class="string">failed</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,861</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ClientCnxn</span>  <span class="bullet">-</span> <span class="string">Opening</span> <span class="string">socket</span> <span class="string">connection</span> <span class="string">to</span> <span class="string">server</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">/192.168.112.121:2181</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,867</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ClientCnxn</span>  <span class="bullet">-</span> <span class="string">Socket</span> <span class="string">connection</span> <span class="string">established</span> <span class="string">to</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">/192.168.112.121:2181,</span> <span class="string">initiating</span> <span class="string">session</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,917</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.shaded.zookeeper.org.apache.zookeeper.ClientCnxn</span>  <span class="bullet">-</span> <span class="string">Session</span> <span class="string">establishment</span> <span class="string">complete</span> <span class="string">on</span> <span class="string">server</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">/192.168.112.121:2181,</span> <span class="string">sessionid</span> <span class="string">=</span> <span class="number">0x200056d07380002</span><span class="string">,</span> <span class="string">negotiated</span> <span class="string">timeout</span> <span class="string">=</span> <span class="number">40000</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:12,926</span> <span class="attr">INFO  org.apache.flink.shaded.curator.org.apache.curator.framework.state.ConnectionStateManager  - State change:</span> <span class="string">CONNECTED</span></span><br><span class="line"><span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span><span class="string">:27:13,918</span> <span class="string">INFO</span>  <span class="string">org.apache.flink.runtime.rest.RestClient</span>                      <span class="bullet">-</span> <span class="string">Rest</span> <span class="string">client</span> <span class="string">endpoint</span> <span class="string">started.</span></span><br><span class="line"><span class="string">Flink</span> <span class="string">JobManager</span> <span class="string">is</span> <span class="string">now</span> <span class="string">running</span> <span class="string">on</span> <span class="string">worker2:43204</span> <span class="string">with</span> <span class="string">leader</span> <span class="string">id</span> <span class="string">1013ba3b-6ad6-45d9-97da-43cb4979e854.</span></span><br><span class="line"><span class="attr">JobManager Web Interface:</span> <span class="string">http://worker2:44941</span></span><br></pre></td></tr></table></figure><p>可以通过<a href="http://worker2:44941" target="_blank" rel="noopener">http://worker2:44941</a>访问flink UI;<br>查看YARN web<a href="http://worker1:8088/cluster" target="_blank" rel="noopener">http://worker1:8088/cluster</a><br><img src="/images/flink/flink-on-yarn.png" alt=""><br>启动一个yarn-session有2个Taskmanager，jobmanager内存2GB，taskManager2GB内存，那么脚本编写应该是这样的：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/yarn-session.sh -n <span class="number">2</span> -jm <span class="number">1024</span> -tm <span class="number">1024</span></span><br></pre></td></tr></table></figure><p>yarn-session的参数介绍</p><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">yarn-session的参数介绍</span><br><span class="line">  -<span class="ruby">n ： 指定TaskManager的数量；</span></span><br><span class="line"><span class="ruby">  -<span class="symbol">d:</span> 以分离模式运行；</span></span><br><span class="line"><span class="ruby">  -id：指定yarn的任务ID；</span></span><br><span class="line"><span class="ruby">  -<span class="symbol">j:</span>Flink jar文件的路径;</span></span><br><span class="line"><span class="ruby">  -jm：JobManager容器的内存（默认值：MB）;</span></span><br><span class="line"><span class="ruby">  -nl：为YARN应用程序指定YARN节点标签;</span></span><br><span class="line"><span class="ruby">  -<span class="symbol">nm:</span>在YARN上为应用程序设置自定义名称;</span></span><br><span class="line"><span class="ruby">  -<span class="symbol">q:</span>显示可用的YARN资源（内存，内核）;</span></span><br><span class="line"><span class="ruby">  -<span class="symbol">qu:</span>指定YARN队列;</span></span><br><span class="line"><span class="ruby">  -<span class="symbol">s:</span>指定TaskManager中slot的数量;</span></span><br><span class="line"><span class="ruby">  -<span class="symbol">st:</span>以流模式启动Flink;</span></span><br><span class="line"><span class="ruby">  -<span class="symbol">tm:</span>每个TaskManager容器的内存（默认值：MB）;</span></span><br><span class="line"><span class="ruby">  -<span class="symbol">z:</span>命名空间，用于为高可用性模式创建Zookeeper子路径;</span></span><br></pre></td></tr></table></figure><p>系统默认使用con/flink-conf.yaml里的配置。Flink on yarn将会覆盖掉几个参数：<br>jobmanager.rpc.address因为jobmanager的在集群的运行位置并不是实现确定的，前面也说到了就是am的地址；<br>taskmanager.tmp.dirs使用yarn给定的临时目录;parallelism.default也会被覆盖掉，如果在命令行里指定了slot数。<br>如果你想保证conf/flink-conf.yaml仅是全局配置，然后针对要启动的每一个yarn-session.sh都设置自己的配置，那么可以考虑使用-D修饰。</p><p>上传flink-1.9.1下的README.txt到hdfs的/flink/test目录，使用自带WordCount例子测试一下。</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">root@</span>master1:/usr/local/flink/flink<span class="number">-1.9</span><span class="number">.1</span># hdfs dfs -ls /flink/test</span><br><span class="line">Found <span class="number">1</span> items</span><br><span class="line">-rw-r--r--   <span class="number">3</span> root supergroup       <span class="number">1308</span> <span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">18</span>:<span class="number">39</span> /flink/test/README.txt</span><br></pre></td></tr></table></figure><h2 id="Flink-高可用HA参数配置"><a href="#Flink-高可用HA参数配置" class="headerlink" title="Flink 高可用HA参数配置"></a>Flink 高可用HA参数配置</h2><p>修改/usr/local/hadoop/hadoop-2.6.5/etc/hadoop/yarn-site.xml文件，此配置代表application master在重启时，尝试的最大次数。<br>注意，Flink On Yarn环境中，当Jobmanager（Application Master）失败时，yarn会尝试重启JobManager（AM），重启后，会重新启动Flink的Job（application）。因此，yarn.application-attempts的设置不应该超过yarn.resourcemanager.am.max-attemps。以上的2个配置文件都需要分发到各个节点。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.am.max-attempts<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">value</span>&gt;</span>4<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure><p>参考：<br><a href="https://www.jianshu.com/p/1b05202c4fb6" target="_blank" rel="noopener">https://www.jianshu.com/p/1b05202c4fb6</a><br><a href="https://mp.weixin.qq.com/s?__biz=Mzg3NjAwNzM4MA==&mid=2247483718&idx=1&sn=600358cceeddf23f2e73e5b37afeb6b7&chksm=cf399bfdf84e12eb40a26fb45528bcf29a8298fbc490954c34efd88eda0dc4dcff862be85339&scene=4&subscene=126&ascene=0&devicetype=android-25&version=27000338&nettype=3gnet&abtest_cookie=BQABAAoACwASABMAFAAFACOXHgBamR4Am5keAMaZHgDTmR4AAAA%3D&lang=zh_CN&pass_ticket=UIm3jEsgAQGHITNhnnGM4cAXL4CdbSRi7%2B7S6lqO%2FMe0vpDmKkaGkEyp%2BB%2B3HvhB&wx_header=1" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?__biz=Mzg3NjAwNzM4MA==&amp;mid=2247483718&amp;idx=1&amp;sn=600358cceeddf23f2e73e5b37afeb6b7&amp;chksm=cf399bfdf84e12eb40a26fb45528bcf29a8298fbc490954c34efd88eda0dc4dcff862be85339&amp;scene=4&amp;subscene=126&amp;ascene=0&amp;devicetype=android-25&amp;version=27000338&amp;nettype=3gnet&amp;abtest_cookie=BQABAAoACwASABMAFAAFACOXHgBamR4Am5keAMaZHgDTmR4AAAA%3D&amp;lang=zh_CN&amp;pass_ticket=UIm3jEsgAQGHITNhnnGM4cAXL4CdbSRi7%2B7S6lqO%2FMe0vpDmKkaGkEyp%2BB%2B3HvhB&amp;wx_header=1</a></p>]]></content>
    
    <summary type="html">
    
      本博客记录flink-1.9.1 on yarn的集群搭建
    
    </summary>
    
    
      <category term="flink" scheme="http://sparkx.com.cn/categories/flink/"/>
    
    
      <category term="flink" scheme="http://sparkx.com.cn/tags/flink/"/>
    
  </entry>
  
  <entry>
    <title>model-engine</title>
    <link href="http://sparkx.com.cn/framework/model-engine/"/>
    <id>http://sparkx.com.cn/framework/model-engine/</id>
    <published>2020-01-09T11:16:05.000Z</published>
    <updated>2020-03-30T15:01:35.014Z</updated>
    
    <content type="html"><![CDATA[<p>模型引擎平台经过两年的开发、测试、线上验证，用事实证明了对于有模型（包含XGBoost,Tensorflow等）的项目，接入模型引擎后开发、测试和后期项目迭代的效率提高了75%以上，近期（flag:2020-01-08）实现模型引擎支持不同版本传不同模型参数，让模型引擎又上了一个台阶，能够解决hardcode开发和项目上线的复杂问题。<br>在认识模型引擎之前先想一下下面的问题你有没有遇到过:</p><ul><li>1.正常情况：如果你的项目使用<code>公式</code>预测商品分数对商品排序，开发和测试特征是不是很复杂？开发、测试及上线周期是不是很长？</li><li>2.高级一点：如果你的项目使用<code>模型</code>预测商品分数对商品排序，在项目中是不是将模型打包到一起发布？</li><li>3.问题来了：如果每三两天模型迭代一次，是不是每次都要重新打包模型并重新发布项目？麻烦不麻烦？<br>如果对于上面的问题你的回答都是<code>Yes</code>，那你就要继续阅读下面的文章了，以下文章会给你一个全新的思路解决以上问题。</li></ul><h1 id="模型引擎是什么"><a href="#模型引擎是什么" class="headerlink" title="模型引擎是什么"></a>模型引擎是什么</h1><p>模型引擎:是一个综合性的模型治理平台，它可以减少模型上线过程中的重复工作，实现模型的快速上线迭代，健全线上模型的监控评估机制。</p><h1 id="模型引擎务哪些人"><a href="#模型引擎务哪些人" class="headerlink" title="模型引擎务哪些人"></a>模型引擎务哪些人</h1><p><img src="/images/me/me_server_object.png" alt="模型引擎务对象"></p><h1 id="模型引擎架构"><a href="#模型引擎架构" class="headerlink" title="模型引擎架构"></a>模型引擎架构</h1><p><img src="/images/me/me-arch.png" alt="模型引擎实现架构"></p><h1 id="模型引擎实现"><a href="#模型引擎实现" class="headerlink" title="模型引擎实现"></a>模型引擎实现</h1><p>模型引擎有一个WebUI给产品、开发、算法、测试人员提供服务和一个模型引擎客户端给各种使用模型的SOA、Job、Web等提供配置服务。<br>模型引擎大体流程如下：</p><ul><li>1.产品经理创建项目，并指定场景名称和场景对应的code以及相关人员的权限信息，场景可以认为一个功能模块，比如:排序、推荐、广告等；</li><li>2.开发人员在相关场景下面创建子场景，默认可以父子场景code一致也可不同，也可以创建多个子场景，子场景创建完毕会生成A~E六个版本，默认和A/B系统保持一致；</li><li>3.子场景创建完毕，算法人员可以在对应的子场景的不同版本上传不同模型，模型和特征必须绑定到一起（也就是说模型和特征列表压缩到一个zip包内）；</li><li>4.开发人员接入模型引擎客户端，根据模型客户端提供的特征列表准备特征数据（默认准备A~E所有版本所有特征，这个和算法事先沟通好）并调用模型；</li><li>5.开发完成后测试人员可以将白名单配置到模型引擎中，运行项目，例如：SOA项目，请求后可以如果uid和cid在白名单中，则将改用户的详细信息记录到日志系统，然后可以通过模型引擎“日志诊断”模块查看输入模型特征及各个参数和统计信息；记录的日志和统计信息需要开发人员实现。</li><li>6.测试完项目后即可上线。</li></ul>]]></content>
    
    <summary type="html">
    
      模型引擎:是一个综合性的模型治理平台，它可以减少模型上线过程中的重复工作，实现模型的快速上线迭代，健全线上模型的监控评估机制。
    
    </summary>
    
    
      <category term="tools" scheme="http://sparkx.com.cn/categories/tools/"/>
    
    
      <category term="framework" scheme="http://sparkx.com.cn/tags/framework/"/>
    
  </entry>
  
  <entry>
    <title>hadoop2.6.5 ha集群搭建</title>
    <link href="http://sparkx.com.cn/hadoop/hadoop2-ha-deployment/"/>
    <id>http://sparkx.com.cn/hadoop/hadoop2-ha-deployment/</id>
    <published>2019-12-27T13:46:56.000Z</published>
    <updated>2020-03-30T15:01:35.015Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前提准备"><a href="#前提准备" class="headerlink" title="前提准备"></a>前提准备</h1><p>Hadoop要做到HA(高可靠)也需要依赖<code>zookeeper</code>组件，<code>zookeeper</code>集群搭建可以参考<a href="http://sparkx.com.cn/zookeeper/zookeeper-ha/">zookeeper介绍和集群高可用的思考</a>。<br><a href="https://archive.apache.org/dist/hadoop/common/hadoop-2.6.5/" target="_blank" rel="noopener">hadoop2.6.5下载</a><br>服务器说明如下,为了节约资源，在三台服务器上搭建:</p><table><thead><tr><th>ip</th><th align="left">服务器角色</th></tr></thead><tbody><tr><td>192.168.112.120</td><td align="left">zookeeper,JobManager,Master</td></tr><tr><td>192.168.112.121</td><td align="left">zookeeper,JobManager,Master,Slave</td></tr><tr><td>192.168.112.122</td><td align="left">zookeeper,JobManager,Slave</td></tr></tbody></table><h1 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h1><p>下载<code>hadoop-2.6.5.tar.gz</code>并上传到服务器，用命令<code>tar -zxvf hadoop-2.6.5.tar.gz</code>解压到hadoop-2.6.5下面，配置环境变量，我贴出来了服务器上所有环境变量如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/local/jdk/jdk1.8.0_151</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JRE_HOME</span>=<span class="variable">$&#123;JAVA_HOME&#125;</span>/jre</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">MAVEN_HOME</span>=/usr/local/maven/apache-maven-3.3.9</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">SCALA_HOME</span>=/usr/local/scala/scala-2.11.0</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HADOOP_HOME</span>=/usr/local/hadoop/hadoop-2.6.5</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HADOOP_CONF_DIR</span>=<span class="variable">$&#123;HADOOP_HOME&#125;</span>/etc/hadoop</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HADOOP_COMMON_LIB_NATIVE_DIR</span>=<span class="variable">$&#123;HADOOP_HOME&#125;</span>/lib/native</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HADOOP_OPTS</span>=<span class="string">"-Djava.library.path=<span class="variable">$&#123;HADOOP_HOME&#125;</span>/lib"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">SPARK_HOME</span>=/usr/local/spark/spark-2.4.4-bin-hadoop2.6</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HIVE_HOME</span>=/usr/local/hive/apache-hive-1.2.1-bin</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HIVE_CONF_DIR</span>=<span class="variable">$&#123;HIVE_HOME&#125;</span>/conf</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ZK_HOME</span>=/usr/local/zookeeper/zookeeper-3.5.6</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">FLINK_HOME</span>=/usr/local/flink/flink-1.9.1</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CLASS_PATH</span>=.:$&#123;JAVA_HOME&#125;/lib:<span class="variable">$&#123;JRE_HOME&#125;</span>/lib:<span class="variable">$&#123;HIVE_HOME&#125;</span>/lib</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=.:$&#123;JAVA_HOME&#125;/bin:<span class="variable">$&#123;MAVEN_HOME&#125;</span>/bin:<span class="variable">$&#123;SCALA_HOME&#125;</span>/bin:<span class="variable">$&#123;HADOOP_HOME&#125;</span>/bin:<span class="variable">$&#123;HADOOP_HOME&#125;</span>/sbin:<span class="variable">$&#123;SPARK_HOME&#125;</span>/bin:<span class="variable">$&#123;SPARK_HOME&#125;</span>/sbin:<span class="variable">$&#123;HIVE_HOME&#125;</span>/bin:<span class="variable">$&#123;ZK_HOME&#125;</span>/bin:<span class="variable">$&#123;KAFKA_HOME&#125;</span>/bin:<span class="variable">$&#123;FLINK_HOME&#125;</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure><h1 id="配置hadoop"><a href="#配置hadoop" class="headerlink" title="配置hadoop"></a>配置hadoop</h1><p>core-site.xml配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定hdfs的nameservice为bi --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://bi<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定hadoop临时目录 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/usr/local/hadoop/hadoop-2.6.5/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定zookeeper地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>ha.zookeeper.quorum<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>192.168.112.120:2181,192.168.112.121:2181,192.168.112.122:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>hdfs-site.xml配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--指定hdfs的nameservice为bi，需要和core-site.xml中的保持一致 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.nameservices<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>bi<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- bi（逻辑名）下面有两个NameNode，分别是ns1，ns2 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.namenodes.bi<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>ns1,ns2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ns1的RPC通信地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.bi.ns1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>192.168.112.120:50090<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ns1的http通信地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.bi.ns1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>192.168.112.120:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ns2的RPC通信地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.rpc-address.bi.ns2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>192.168.112.121:50090<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ns2的http通信地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.http-address.bi.ns2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>192.168.112.121:50070<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定NameNode的edits元数据在JournalNode上的存放位置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.shared.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>qjournal://192.168.112.121:8485;192.168.112.122:8485/bi<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定JournalNode在本地磁盘存放数据的位置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.journalnode.edits.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/usr/local/hadoop/hadoop-2.6.5/journal<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 开启NameNode失败自动切换 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.automatic-failover.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 配置失败自动切换实现方式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.client.failover.proxy.provider.bi<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.hdfs.server.namenode.ha.ConfiguredFailoverProxyProvider<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 配置隔离机制方法，多个机制用换行分割，即每个机制暂用一行--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.methods<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span></span><br><span class="line">        sshfence</span><br><span class="line">        shell(/bin/true)</span><br><span class="line">        <span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 使用sshfence隔离机制时需要ssh免登陆 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.ssh.private-key-files<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>/root/.ssh/id_rsa<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 配置sshfence隔离机制超时时间 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.ha.fencing.ssh.connect-timeout<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>30000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>mapred-site.xml配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定mr框架为yarn方式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>yarn-site.xml配置：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Site specific YARN configuration properties --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 开启RM高可用 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.enabled<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定RM的cluster id --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.cluster-id<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>yrc<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定RM的名字 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.ha.rm-ids<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>rm1,rm2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 分别指定RM的地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm1<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>192.168.112.120<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname.rm2<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>192.168.112.121<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定zk集群地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.zk-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>192.168.112.120:2181,192.168.112.121:2181,192.168.112.122:2181<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><p>slaves配置：</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168.112.121</span></span><br><span class="line"><span class="number">192.168.112.122</span></span><br></pre></td></tr></table></figure><p>yarn-env.sh和hadoop-env.sh配置，需要配置JAVA_HOME，否则启动hdfs时会提示JAVA_HOME没有配置：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/java/jdk1.8.0_151</span><br></pre></td></tr></table></figure><p>配置完成后，使用spc命令将hadoop-2.6.5拷贝到其他服务器上:</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spc -r /usr/local/hadoop/hadoop<span class="number">-2.6</span>.<span class="number">5 192</span>.<span class="number">168.112</span>.<span class="number">122</span><span class="symbol">:/usr/local/hadoop/</span></span><br><span class="line">spc -r /usr/local/hadoop/hadoop<span class="number">-2.6</span>.<span class="number">5 192</span>.<span class="number">168.112</span>.<span class="number">121</span><span class="symbol">:/usr/local/hadoop/</span></span><br></pre></td></tr></table></figure><h1 id="启动集群"><a href="#启动集群" class="headerlink" title="启动集群"></a>启动集群</h1><p>需要严格按照下面步骤启动。</p><h3 id="1-启动zookeeper"><a href="#1-启动zookeeper" class="headerlink" title="1.启动zookeeper"></a>1.启动zookeeper</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./zookeeper/bin/zkServer.sh <span class="keyword">start</span> <span class="comment">#启动命令</span></span><br><span class="line">./zookeeper/<span class="keyword">bin</span>/zkServer.sh <span class="keyword">status</span> <span class="comment">#查看状态,一个leader，两个follower</span></span><br></pre></td></tr></table></figure><h3 id="2-启动journalnode"><a href="#2-启动journalnode" class="headerlink" title="2.启动journalnode"></a>2.启动journalnode</h3><p>分别在在slaves指定的服务器上执行</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#worker1</span></span><br><span class="line">root<span class="variable">@worker1</span><span class="symbol">:/usr/local/hadoop</span><span class="comment"># ./hadoop-2.6.5/sbin/hadoop-daemon.sh start journalnode</span></span><br><span class="line">starting journalnode, logging to /usr/local/hadoop/hadoop<span class="number">-2.6</span>.<span class="number">5</span>/logs/hadoop-root-journalnode-worker1.out</span><br><span class="line">root<span class="variable">@worker1</span><span class="symbol">:/usr/local/hadoop</span><span class="comment"># jps</span></span><br><span class="line"><span class="number">18690</span> QuorumPeerMain  <span class="comment">#是zookeeper进程</span></span><br><span class="line"><span class="number">18839</span> Jps</span><br><span class="line"><span class="number">18792</span> JournalNode </span><br><span class="line">root<span class="variable">@worker1</span><span class="symbol">:/usr/local/hadoop</span><span class="comment"># </span></span><br><span class="line"><span class="comment">#worker2</span></span><br><span class="line">root<span class="variable">@worker2</span><span class="symbol">:/usr/local/hadoop</span><span class="comment"># ./hadoop-2.6.5/sbin/hadoop-daemon.sh start journalnode</span></span><br><span class="line">starting journalnode, logging to /usr/local/hadoop/hadoop<span class="number">-2.6</span>.<span class="number">5</span>/logs/hadoop-root-journalnode-worker2.out</span><br><span class="line">root<span class="variable">@worker2</span><span class="symbol">:/usr/local/hadoop</span><span class="comment"># jps</span></span><br><span class="line"><span class="number">38348</span> JournalNode</span><br><span class="line"><span class="number">38397</span> Jps</span><br><span class="line"><span class="number">38254</span> QuorumPeerMain</span><br></pre></td></tr></table></figure><h3 id="3-格式化HDFS和格式化ZKFC"><a href="#3-格式化HDFS和格式化ZKFC" class="headerlink" title="3.格式化HDFS和格式化ZKFC"></a>3.格式化HDFS和格式化ZKFC</h3><p>在192.168.112.120上执行命令<code>hdfs namenode -format</code>格式化hdfs。<br>在192.168.112.120上执行命令<code>hdfs zkfc -formatZK</code>格式化ZKFC</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">root@master1:/usr/local/hadoop/hadoop-2.6.5#</span> <span class="string">hdfs</span> <span class="string">namenode</span> <span class="string">-format</span></span><br><span class="line"><span class="attr">20/01/22 19:36:33 INFO namenode.NameNode: STARTUP_MSG:</span> </span><br><span class="line"><span class="string">/************************************************************</span></span><br><span class="line"><span class="attr">STARTUP_MSG:</span> <span class="string">Starting</span> <span class="string">NameNode</span></span><br><span class="line"><span class="attr">STARTUP_MSG:</span>   <span class="string">host</span> <span class="string">=</span> <span class="string">master1/192.168.112.120</span></span><br><span class="line"><span class="attr">STARTUP_MSG:</span>   <span class="string">args</span> <span class="string">=</span> <span class="string">[-format]</span></span><br><span class="line"><span class="attr">STARTUP_MSG:</span>   <span class="string">version</span> <span class="string">=</span> <span class="number">2.6</span><span class="number">.5</span></span><br><span class="line"><span class="attr">STARTUP_MSG:</span>   <span class="string">classpath</span> <span class="string">=</span> <span class="comment">#太长忽略</span></span><br><span class="line"><span class="attr">STARTUP_MSG:</span>   <span class="string">build</span> <span class="string">=</span> <span class="string">https://github.com/apache/hadoop.git</span> <span class="string">-r</span> <span class="string">e8c9fe0b4c252caf2ebf1464220599650f119997;</span> <span class="string">compiled</span> <span class="string">by</span> <span class="string">'sjlee'</span> <span class="string">on</span> <span class="number">2016</span><span class="number">-10</span><span class="string">-02T23:43Z</span></span><br><span class="line"><span class="attr">STARTUP_MSG:</span>   <span class="string">java</span> <span class="string">=</span> <span class="number">1.8</span><span class="string">.0_151</span></span><br><span class="line"><span class="string">************************************************************/</span></span><br><span class="line"><span class="attr">20/01/22 19:36:33 INFO namenode.NameNode:</span> <span class="string">registered</span> <span class="string">UNIX</span> <span class="string">signal</span> <span class="string">handlers</span> <span class="string">for</span> <span class="string">[TERM,</span> <span class="string">HUP,</span> <span class="string">INT]</span></span><br><span class="line"><span class="attr">20/01/22 19:36:33 INFO namenode.NameNode:</span> <span class="string">createNameNode</span> <span class="string">[-format]</span></span><br><span class="line"><span class="attr">20/01/22 19:36:34 WARN util.NativeCodeLoader:</span> <span class="string">Unable</span> <span class="string">to</span> <span class="string">load</span> <span class="string">native-hadoop</span> <span class="string">library</span> <span class="string">for</span> <span class="string">your</span> <span class="string">platform...</span> <span class="string">using</span> <span class="string">builtin-java</span> <span class="string">classes</span> <span class="string">where</span> <span class="string">applicable</span></span><br><span class="line"><span class="attr">Formatting using clusterid:</span> <span class="string">CID-6bde9d58-65a1-40d2-86cd-2921cf835a8b</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem:</span> <span class="literal">No</span> <span class="string">KeyProvider</span> <span class="string">found.</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem:</span> <span class="string">fsLock</span> <span class="string">is</span> <span class="string">fair:true</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.DatanodeManager:</span> <span class="string">dfs.block.invalidate.limit=1000</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.DatanodeManager:</span> <span class="string">dfs.namenode.datanode.registration.ip-hostname-check=true</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.BlockManager:</span> <span class="string">dfs.namenode.startup.delay.block.deletion.sec</span> <span class="string">is</span> <span class="string">set</span> <span class="string">to</span> <span class="number">000</span><span class="string">:00:00:00.000</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.BlockManager:</span> <span class="string">The</span> <span class="string">block</span> <span class="string">deletion</span> <span class="string">will</span> <span class="string">start</span> <span class="string">around</span> <span class="number">2020</span> <span class="string">一月</span> <span class="number">22</span> <span class="number">19</span><span class="string">:36:35</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">Computing</span> <span class="string">capacity</span> <span class="string">for</span> <span class="string">map</span> <span class="string">BlocksMap</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">VM</span> <span class="string">type</span>       <span class="string">=</span> <span class="number">64</span><span class="string">-bit</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="number">2.0</span><span class="string">%</span> <span class="string">max</span> <span class="string">memory</span> <span class="number">966.7</span> <span class="string">MB</span> <span class="string">=</span> <span class="number">19.3</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">capacity</span>      <span class="string">=</span> <span class="number">2</span><span class="string">^21</span> <span class="string">=</span> <span class="number">2097152</span> <span class="string">entries</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.BlockManager:</span> <span class="string">dfs.block.access.token.enable=false</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.BlockManager:</span> <span class="string">defaultReplication</span>         <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.BlockManager:</span> <span class="string">maxReplication</span>             <span class="string">=</span> <span class="number">512</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.BlockManager:</span> <span class="string">minReplication</span>             <span class="string">=</span> <span class="number">1</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.BlockManager:</span> <span class="string">maxReplicationStreams</span>      <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.BlockManager:</span> <span class="string">replicationRecheckInterval</span> <span class="string">=</span> <span class="number">3000</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.BlockManager:</span> <span class="string">encryptDataTransfer</span>        <span class="string">=</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO blockmanagement.BlockManager:</span> <span class="string">maxNumBlocksToLog</span>          <span class="string">=</span> <span class="number">1000</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem:</span> <span class="string">fsOwner</span>             <span class="string">=</span> <span class="string">root</span> <span class="string">(auth:SIMPLE)</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem:</span> <span class="string">supergroup</span>          <span class="string">=</span> <span class="string">supergroup</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem:</span> <span class="string">isPermissionEnabled</span> <span class="string">=</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem: Determined nameservice ID:</span> <span class="string">bi</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem: HA Enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem: Append Enabled:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">Computing</span> <span class="string">capacity</span> <span class="string">for</span> <span class="string">map</span> <span class="string">INodeMap</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">VM</span> <span class="string">type</span>       <span class="string">=</span> <span class="number">64</span><span class="string">-bit</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="number">1.0</span><span class="string">%</span> <span class="string">max</span> <span class="string">memory</span> <span class="number">966.7</span> <span class="string">MB</span> <span class="string">=</span> <span class="number">9.7</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">capacity</span>      <span class="string">=</span> <span class="number">2</span><span class="string">^20</span> <span class="string">=</span> <span class="number">1048576</span> <span class="string">entries</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.NameNode:</span> <span class="string">Caching</span> <span class="string">file</span> <span class="string">names</span> <span class="string">occuring</span> <span class="string">more</span> <span class="string">than</span> <span class="number">10</span> <span class="string">times</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">Computing</span> <span class="string">capacity</span> <span class="string">for</span> <span class="string">map</span> <span class="string">cachedBlocks</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">VM</span> <span class="string">type</span>       <span class="string">=</span> <span class="number">64</span><span class="string">-bit</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="number">0.25</span><span class="string">%</span> <span class="string">max</span> <span class="string">memory</span> <span class="number">966.7</span> <span class="string">MB</span> <span class="string">=</span> <span class="number">2.4</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">capacity</span>      <span class="string">=</span> <span class="number">2</span><span class="string">^18</span> <span class="string">=</span> <span class="number">262144</span> <span class="string">entries</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem:</span> <span class="string">dfs.namenode.safemode.threshold-pct</span> <span class="string">=</span> <span class="number">0.9990000128746033</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem:</span> <span class="string">dfs.namenode.safemode.min.datanodes</span> <span class="string">=</span> <span class="number">0</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem:</span> <span class="string">dfs.namenode.safemode.extension</span>     <span class="string">=</span> <span class="number">30000</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem:</span> <span class="string">Retry</span> <span class="string">cache</span> <span class="string">on</span> <span class="string">namenode</span> <span class="string">is</span> <span class="string">enabled</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.FSNamesystem:</span> <span class="string">Retry</span> <span class="string">cache</span> <span class="string">will</span> <span class="string">use</span> <span class="number">0.03</span> <span class="string">of</span> <span class="string">total</span> <span class="string">heap</span> <span class="string">and</span> <span class="string">retry</span> <span class="string">cache</span> <span class="string">entry</span> <span class="string">expiry</span> <span class="string">time</span> <span class="string">is</span> <span class="number">600000</span> <span class="string">millis</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">Computing</span> <span class="string">capacity</span> <span class="string">for</span> <span class="string">map</span> <span class="string">NameNodeRetryCache</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">VM</span> <span class="string">type</span>       <span class="string">=</span> <span class="number">64</span><span class="string">-bit</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="number">0.029999999329447746</span><span class="string">%</span> <span class="string">max</span> <span class="string">memory</span> <span class="number">966.7</span> <span class="string">MB</span> <span class="string">=</span> <span class="number">297.0</span> <span class="string">KB</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO util.GSet:</span> <span class="string">capacity</span>      <span class="string">=</span> <span class="number">2</span><span class="string">^15</span> <span class="string">=</span> <span class="number">32768</span> <span class="string">entries</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.NNConf:</span> <span class="string">ACLs</span> <span class="string">enabled?</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.NNConf:</span> <span class="string">XAttrs</span> <span class="string">enabled?</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">20/01/22 19:36:35 INFO namenode.NNConf: Maximum size of an xattr:</span> <span class="number">16384</span></span><br><span class="line"><span class="attr">20/01/22 19:36:36 WARN client.QuorumJournalManager:</span> <span class="string">Quorum</span> <span class="string">journal</span> <span class="string">URI</span> <span class="string">'qjournal://192.168.112.121:8485;192.168.112.122:8485/bi'</span> <span class="string">has</span> <span class="string">an</span> <span class="string">even</span> <span class="string">number</span> <span class="string">of</span> <span class="string">Journal</span> <span class="string">Nodes</span> <span class="string">specified.</span> <span class="string">This</span> <span class="string">is</span> <span class="string">not</span> <span class="string">recommended!</span></span><br><span class="line"><span class="attr">20/01/22 19:36:36 INFO namenode.FSImage: Allocated new BlockPoolId:</span> <span class="string">BP-1980541481-192.168.112.120-1579682196876</span></span><br><span class="line"><span class="attr">20/01/22 19:36:36 INFO common.Storage:</span> <span class="string">Storage</span> <span class="string">directory</span> <span class="string">/usr/local/hadoop/hadoop-2.6.5/tmp/dfs/name</span> <span class="string">has</span> <span class="string">been</span> <span class="string">successfully</span> <span class="string">formatted.</span></span><br><span class="line"><span class="attr">20/01/22 19:36:37 INFO namenode.FSImageFormatProtobuf:</span> <span class="string">Saving</span> <span class="string">image</span> <span class="string">file</span> <span class="string">/usr/local/hadoop/hadoop-2.6.5/tmp/dfs/name/current/fsimage.ckpt_0000000000000000000</span> <span class="string">using</span> <span class="literal">no</span> <span class="string">compression</span></span><br><span class="line"><span class="attr">20/01/22 19:36:37 INFO namenode.FSImageFormatProtobuf:</span> <span class="string">Image</span> <span class="string">file</span> <span class="string">/usr/local/hadoop/hadoop-2.6.5/tmp/dfs/name/current/fsimage.ckpt_0000000000000000000</span> <span class="string">of</span> <span class="string">size</span> <span class="number">321</span> <span class="string">bytes</span> <span class="string">saved</span> <span class="string">in</span> <span class="number">0</span> <span class="string">seconds.</span></span><br><span class="line"><span class="attr">20/01/22 19:36:37 INFO namenode.NNStorageRetentionManager:</span> <span class="string">Going</span> <span class="string">to</span> <span class="string">retain</span> <span class="number">1</span> <span class="string">images</span> <span class="string">with</span> <span class="string">txid</span> <span class="string">&gt;=</span> <span class="number">0</span></span><br><span class="line"><span class="attr">20/01/22 19:36:37 INFO util.ExitUtil:</span> <span class="string">Exiting</span> <span class="string">with</span> <span class="string">status</span> <span class="number">0</span></span><br><span class="line"><span class="attr">20/01/22 19:36:37 INFO namenode.NameNode: SHUTDOWN_MSG:</span> </span><br><span class="line"><span class="string">/************************************************************</span></span><br><span class="line"><span class="attr">SHUTDOWN_MSG:</span> <span class="string">Shutting</span> <span class="string">down</span> <span class="string">NameNode</span> <span class="string">at</span> <span class="string">master1/192.168.112.120</span></span><br><span class="line"><span class="string">************************************************************/</span></span><br><span class="line"><span class="string">root@master1:/usr/local/hadoop/hadoop-2.6.5#</span> <span class="string">hdfs</span> <span class="string">zkfc</span> <span class="string">-formatZK</span></span><br><span class="line"><span class="attr">20/01/22 19:37:51 WARN util.NativeCodeLoader:</span> <span class="string">Unable</span> <span class="string">to</span> <span class="string">load</span> <span class="string">native-hadoop</span> <span class="string">library</span> <span class="string">for</span> <span class="string">your</span> <span class="string">platform...</span> <span class="string">using</span> <span class="string">builtin-java</span> <span class="string">classes</span> <span class="string">where</span> <span class="string">applicable</span></span><br><span class="line"><span class="attr">20/01/22 19:37:51 INFO tools.DFSZKFailoverController:</span> <span class="string">Failover</span> <span class="string">controller</span> <span class="string">configured</span> <span class="string">for</span> <span class="string">NameNode</span> <span class="string">NameNode</span> <span class="string">at</span> <span class="string">/192.168.112.120:50090</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:zookeeper.version=3.4.6-1569965,</span> <span class="string">built</span> <span class="string">on</span> <span class="number">02</span><span class="string">/20/2014</span> <span class="number">09</span><span class="string">:09</span> <span class="string">GMT</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:host.name=master1</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:java.version=1.8.0_151</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:java.vendor=Oracle</span> <span class="string">Corporation</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:java.home=/usr/local/jdk/jdk1.8.0_151/jre</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:java.class.path=#太长忽略</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:java.library.path=/usr/local/hadoop/hadoop-2.6.5/lib</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:java.io.tmpdir=/tmp</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:java.compiler=&lt;NA&gt;</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:os.name=Linux</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:os.arch=amd64</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:os.version=4.2.0-16-generic</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:user.name=root</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:user.home=/root</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Client</span> <span class="string">environment:user.dir=/usr/local/hadoop/hadoop-2.6.5</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper:</span> <span class="string">Initiating</span> <span class="string">client</span> <span class="string">connection,</span> <span class="string">connectString=192.168.112.120:2181,192.168.112.121:2181,192.168.112.122:2181</span> <span class="string">sessionTimeout=5000</span> <span class="string">watcher=org.apache.hadoop.ha.ActiveStandbyElector$WatcherWithClientRef@9597028</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ClientCnxn:</span> <span class="string">Opening</span> <span class="string">socket</span> <span class="string">connection</span> <span class="string">to</span> <span class="string">server</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.120</span><span class="string">/192.168.112.120:2181.</span> <span class="string">Will</span> <span class="string">not</span> <span class="string">attempt</span> <span class="string">to</span> <span class="string">authenticate</span> <span class="string">using</span> <span class="string">SASL</span> <span class="string">(unknown</span> <span class="string">error)</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ClientCnxn:</span> <span class="string">Socket</span> <span class="string">connection</span> <span class="string">established</span> <span class="string">to</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.120</span><span class="string">/192.168.112.120:2181,</span> <span class="string">initiating</span> <span class="string">session</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ClientCnxn:</span> <span class="string">Session</span> <span class="string">establishment</span> <span class="string">complete</span> <span class="string">on</span> <span class="string">server</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.120</span><span class="string">/192.168.112.120:2181,</span> <span class="string">sessionid</span> <span class="string">=</span> <span class="number">0x10006aaaffd0001</span><span class="string">,</span> <span class="string">negotiated</span> <span class="string">timeout</span> <span class="string">=</span> <span class="number">5000</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO ha.ActiveStandbyElector:</span> <span class="string">Session</span> <span class="string">connected.</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO ha.ActiveStandbyElector:</span> <span class="string">Successfully</span> <span class="string">created</span> <span class="string">/hadoop-ha/bi</span> <span class="string">in</span> <span class="string">ZK.</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ClientCnxn:</span> <span class="string">EventThread</span> <span class="string">shut</span> <span class="string">down</span></span><br><span class="line"><span class="attr">20/01/22 19:37:52 INFO zookeeper.ZooKeeper: Session:</span> <span class="number">0x10006aaaffd0001</span> <span class="string">closed</span></span><br></pre></td></tr></table></figure><p>登录zookeeper cli查看，发现多了个hadoop-ha目录，这个就是hadoop的ha创建的。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">root@master1:/usr/local/zookeeper# ./zookeeper-3.5.6/bin/zkCli.sh -server master1:2181</span><br><span class="line">Connecting <span class="keyword">to</span> master1:2181</span><br><span class="line">2020-01-22 19:38:40,992 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:zookeeper.<span class="attribute">version</span>=3.5.6-c11b7e26bc554b8523dc929761dd28808913f091, built on 10/08/2019 20:18 GMT</span><br><span class="line">2020-01-22 19:38:41,001 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:host.<span class="attribute">name</span>=master1</span><br><span class="line">2020-01-22 19:38:41,002 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:java.<span class="attribute">version</span>=1.8.0_151</span><br><span class="line">2020-01-22 19:38:41,005 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:java.<span class="attribute">vendor</span>=Oracle Corporation</span><br><span class="line">2020-01-22 19:38:41,006 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:java.<span class="attribute">home</span>=/usr/local/jdk/jdk1.8.0_151/jre</span><br><span class="line">2020-01-22 19:38:41,006 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:java.class.<span class="attribute">path</span>=#太长忽略</span><br><span class="line">2020-01-22 19:38:41,007 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:java.library.<span class="attribute">path</span>=/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib</span><br><span class="line">2020-01-22 19:38:41,007 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:java.io.<span class="attribute">tmpdir</span>=/tmp</span><br><span class="line">2020-01-22 19:38:41,007 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:java.<span class="attribute">compiler</span>=&lt;NA&gt;</span><br><span class="line">2020-01-22 19:38:41,008 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:os.<span class="attribute">name</span>=Linux</span><br><span class="line">2020-01-22 19:38:41,008 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:os.<span class="attribute">arch</span>=amd64</span><br><span class="line">2020-01-22 19:38:41,009 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:os.<span class="attribute">version</span>=4.2.0-16-generic</span><br><span class="line">2020-01-22 19:38:41,009 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:user.<span class="attribute">name</span>=root</span><br><span class="line">2020-01-22 19:38:41,009 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:user.<span class="attribute">home</span>=/root</span><br><span class="line">2020-01-22 19:38:41,010 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:user.<span class="attribute">dir</span>=/usr/local/zookeeper</span><br><span class="line">2020-01-22 19:38:41,010 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:os.memory.<span class="attribute">free</span>=54MB</span><br><span class="line">2020-01-22 19:38:41,014 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:os.memory.<span class="attribute">max</span>=247MB</span><br><span class="line">2020-01-22 19:38:41,014 [myid:] - <span class="builtin-name">INFO</span>  [main<span class="keyword">:Environment</span>@109] -<span class="built_in"> Client </span>environment:os.memory.<span class="attribute">total</span>=59MB</span><br><span class="line">2020-01-22 19:38:41,020 [myid:] - <span class="builtin-name">INFO</span>  [main:ZooKeeper@868] - Initiating<span class="built_in"> client </span>connection, <span class="attribute">connectString</span>=master1:2181 <span class="attribute">sessionTimeout</span>=30000 <span class="attribute">watcher</span>=org.apache.zookeeper.ZooKeeperMain$MyWatcher@15615099</span><br><span class="line">2020-01-22 19:38:41,035 [myid:] - <span class="builtin-name">INFO</span>  [main:X509Util@79] - Setting -D jdk.tls.<span class="attribute">rejectClientInitiatedRenegotiation</span>=<span class="literal">true</span> <span class="keyword">to</span> <span class="builtin-name">disable</span> client-initiated TLS renegotiation</span><br><span class="line">2020-01-22 19:38:41,043 [myid:] - <span class="builtin-name">INFO</span>  [main:ClientCnxnSocket@237] - jute.maxbuffer value is 4194304 Bytes</span><br><span class="line">2020-01-22 19:38:41,057 [myid:] - <span class="builtin-name">INFO</span>  [main:ClientCnxn@1653] - zookeeper.request.timeout value is 0. feature enabled=</span><br><span class="line">Welcome <span class="keyword">to</span> ZooKeeper!</span><br><span class="line">2020-01-22 19:38:41,062 [myid:master1:2181] - <span class="builtin-name">INFO</span>  [main-SendThread(master1:2181):ClientCnxn<span class="variable">$SendThread</span>@1112] - Opening socket<span class="built_in"> connection </span><span class="keyword">to</span><span class="built_in"> server </span>master1/192.168.112.120:2181. Will <span class="keyword">not</span> attempt <span class="keyword">to</span> authenticate using SASL (unknown error)</span><br><span class="line">JLine support is enabled</span><br><span class="line">2020-01-22 19:38:41,309 [myid:master1:2181] - <span class="builtin-name">INFO</span>  [main-SendThread(master1:2181):ClientCnxn<span class="variable">$SendThread</span>@959] - Socket<span class="built_in"> connection </span>established, initiating session, client: /192.168.112.120:39372, server: master1/192.168.112.120:2181</span><br><span class="line">2020-01-22 19:38:41,331 [myid:master1:2181] - <span class="builtin-name">INFO</span>  [main-SendThread(master1:2181):ClientCnxn<span class="variable">$SendThread</span>@1394] - Session establishment complete on<span class="built_in"> server </span>master1/192.168.112.120:2181, sessionid = 0x10006aaaffd0002, negotiated timeout = 30000</span><br><span class="line"></span><br><span class="line">WATCHER::</span><br><span class="line"></span><br><span class="line">WatchedEvent state:SyncConnected type:None path:null</span><br><span class="line">[zk: master1:2181(CONNECTED) 0] ls /</span><br><span class="line">[hadoop-ha, zookeeper]</span><br></pre></td></tr></table></figure><h3 id="5-启动HDFS"><a href="#5-启动HDFS" class="headerlink" title="5.启动HDFS"></a>5.启动HDFS</h3><p>执行命令<code>./hadoop-2.6.5/sbin/start-dfs.sh</code>启动master。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">root@master1:/usr/local/hadoop# ./hadoop-2.6.5/sbin/start-dfs.sh</span><br><span class="line">20/01/22 19:41:21 WARN util.NativeCodeLoader: Unable <span class="keyword">to</span> load native-hadoop library <span class="keyword">for</span> your platform<span class="built_in">..</span>. using builtin-java classes where applicable</span><br><span class="line">Starting namenodes on [worker1 master1]</span><br><span class="line">worker1: starting namenode,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.5/logs/hadoop-root-namenode-worker1.out</span><br><span class="line">master1: starting namenode,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.5/logs/hadoop-root-namenode-master1.out</span><br><span class="line">192.168.112.122: starting datanode,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.5/logs/hadoop-root-datanode-worker2.out</span><br><span class="line">192.168.112.121: starting datanode,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.5/logs/hadoop-root-datanode-worker1.out</span><br><span class="line">Starting journal nodes [192.168.112.121 192.168.112.122]</span><br><span class="line">192.168.112.121: journalnode running as process 19060. Stop it first.</span><br><span class="line">192.168.112.122: journalnode running as process 38501. Stop it first.</span><br><span class="line">20/01/22 19:41:37 WARN util.NativeCodeLoader: Unable <span class="keyword">to</span> load native-hadoop library <span class="keyword">for</span> your platform<span class="built_in">..</span>. using builtin-java classes where applicable</span><br><span class="line">Starting ZK Failover Controllers on NN hosts [worker1 master1]</span><br><span class="line">worker1: starting zkfc,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.5/logs/hadoop-root-zkfc-worker1.out</span><br><span class="line">master1: starting zkfc,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.5/logs/hadoop-root-zkfc-master1.out</span><br><span class="line">root@master1:/usr/local/hadoop# jps</span><br><span class="line">37712 DFSZKFailoverController  #zk故障转移控制进程</span><br><span class="line">29456 ZooKeeperMain  #zookeeper Cli进程</span><br><span class="line">40806 Jps</span><br><span class="line">2791 QuorumPeerMain  zookeeper进程</span><br><span class="line">36735 NameNode  #NameNode进程</span><br><span class="line">root@master1:/usr/local/hadoop#</span><br></pre></td></tr></table></figure><h3 id="6-启动YARN"><a href="#6-启动YARN" class="headerlink" title="6.启动YARN"></a>6.启动YARN</h3><p>在192.168.112.121上执行./hadoop-2.6.5/sbin/start-yarn.sh，把namenode和resourcemanager分开是因为性能问题，因为他们都要占用大量资源。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@worker1:/usr/local/hadoop# ./hadoop-2.6.5/sbin/start-yarn.sh</span><br><span class="line">starting yarn daemons</span><br><span class="line">starting resourcemanager,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.5/logs/yarn-root-resourcemanager-worker1.out</span><br><span class="line">192.168.112.122: starting nodemanager,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.5/logs/yarn-root-nodemanager-worker2.out</span><br><span class="line">192.168.112.121: starting nodemanager,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.5/logs/yarn-root-nodemanager-worker1.out</span><br><span class="line">root@worker1:/usr/local/hadoop# jps</span><br><span class="line">19697 Jps</span><br><span class="line">18690 QuorumPeerMain</span><br><span class="line">19444 DFSZKFailoverController</span><br><span class="line">19060 JournalNode</span><br><span class="line">19541 ResourceManager #RM进程</span><br><span class="line">19657 NodeManager  #worker节点的NodeManager进程</span><br><span class="line">19277 DataNode #NataNode进程</span><br></pre></td></tr></table></figure><h1 id="查看web页面"><a href="#查看web页面" class="headerlink" title="查看web页面"></a>查看web页面</h1><p>因为这3台都是虚拟机，开发是window7，所以在C:\Windows\System32\drivers\etc目录的hosts文件中配置下面的ip映射。</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168.112.120</span> master1</span><br><span class="line"><span class="number">192.168.112.121</span> worker1</span><br><span class="line"><span class="number">192.168.112.122</span> worker2</span><br></pre></td></tr></table></figure><p>在浏览器中输入<a href="http://192.168.112.120:50070" target="_blank" rel="noopener">http://192.168.112.120:50070</a>即可查看web页面。<br><img src="/images/hadoop/hadoop2-hdfs-web.png" alt="hdfs web"><br>因为在192.168.112.121上面启动的YARN，所以在浏览器中输入<a href="http://192.168.112.121:8088" target="_blank" rel="noopener">http://192.168.112.121:8088</a>即可查看YARN页面。<br><img src="/images/hadoop/hadoop2-yarn-web.png" alt="yarn web"></p><h1 id="验证HDFS"><a href="#验证HDFS" class="headerlink" title="验证HDFS"></a>验证HDFS</h1><p>上传一个文件验证一下：</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">root@</span>master1:/usr/local/hadoop/hadoop<span class="number">-2.6</span><span class="number">.5</span># hdfs dfs -mkdir /hadoop</span><br><span class="line"><span class="number">20</span>/<span class="number">01</span>/<span class="number">22</span> <span class="number">19</span>:<span class="number">54</span>:<span class="number">47</span> WARN util.NativeCodeLoader: Unable to load native-hadoop library <span class="keyword">for</span> your platform... using builtin-java classes where applicable</span><br><span class="line">hdfs dfs <span class="symbol">root@</span>master1:/usr/local/hadoop/hadoop<span class="number">-2.6</span><span class="number">.5</span># hdfs dfs -put README.txt /hadoop</span><br><span class="line"><span class="number">20</span>/<span class="number">01</span>/<span class="number">22</span> <span class="number">19</span>:<span class="number">55</span>:<span class="number">14</span> WARN util.NativeCodeLoader: Unable to load native-hadoop library <span class="keyword">for</span> your platform... using builtin-java classes where applicable</span><br><span class="line">hdfs <span class="symbol">root@</span>master1:/usr/local/hadoop/hadoop<span class="number">-2.6</span><span class="number">.5</span># hdfs dfs -ls /hadoop</span><br><span class="line"><span class="number">20</span>/<span class="number">01</span>/<span class="number">22</span> <span class="number">19</span>:<span class="number">55</span>:<span class="number">35</span> WARN util.NativeCodeLoader: Unable to load native-hadoop library <span class="keyword">for</span> your platform... using builtin-java classes where applicable</span><br><span class="line">Found <span class="number">1</span> items</span><br><span class="line">-rw-r--r--   <span class="number">3</span> root supergroup       <span class="number">1366</span> <span class="number">2020</span><span class="number">-01</span><span class="number">-22</span> <span class="number">19</span>:<span class="number">55</span> /hadoop/README.txt</span><br></pre></td></tr></table></figure><p>web页面查看上传文件:<br><img src="/images/hadoop/hadoop2-hdfs-put-file.png" alt="上传的READM.md文件"></p><h1 id="查看zookeeper中的存储"><a href="#查看zookeeper中的存储" class="headerlink" title="查看zookeeper中的存储"></a>查看zookeeper中的存储</h1><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[<span class="symbol">qateadmin@</span>UAT14475 ~]$ ./zookeeper/bin/zkCli.sh -server <span class="number">192.168</span><span class="number">.112</span><span class="number">.120</span>:<span class="number">2181</span></span><br><span class="line">[zk: <span class="number">192.168</span><span class="number">.112</span><span class="number">.120</span>:<span class="number">2181</span>(CONNECTED) <span class="number">0</span>] ls /</span><br><span class="line">[hadoop-ha, yarn-leader-election, zookeeper] #hadoop-ha,yarn-leader-election是hadoop ha的相关目录。</span><br></pre></td></tr></table></figure><h1 id="测试机器工作状态命令"><a href="#测试机器工作状态命令" class="headerlink" title="测试机器工作状态命令"></a>测试机器工作状态命令</h1><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/bin/</span>hdfs dfsadmin -report<span class="comment">#查看hdfs的各节点状态信息</span></span><br><span class="line">.<span class="regexp">/bin/</span>hdfs haadmin -getServiceState ns1<span class="comment">#获取一个namenode节点的HA状态</span></span><br><span class="line">.<span class="regexp">/sbin/</span>hadoop-daemon.sh start namenode <span class="comment">#单独启动一个namenode进程</span></span><br><span class="line">.<span class="regexp">/sbin/</span>hadoop-daemon.sh start zkfc <span class="comment">#单独启动一个zkfc进程</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      Flink可用在Apache Hadoop YARN模式部署，这篇博客记录Hadoop HA的集群搭建，为后面Flink在YARN模式运行准备环境。
    
    </summary>
    
    
      <category term="hadoop" scheme="http://sparkx.com.cn/categories/hadoop/"/>
    
    
      <category term="hadoop" scheme="http://sparkx.com.cn/tags/hadoop/"/>
    
  </entry>
  
  <entry>
    <title>flink独立集群部署</title>
    <link href="http://sparkx.com.cn/flink/flink-standalone-deployment/"/>
    <id>http://sparkx.com.cn/flink/flink-standalone-deployment/</id>
    <published>2019-12-27T11:29:49.000Z</published>
    <updated>2020-03-30T15:01:35.009Z</updated>
    
    <content type="html"><![CDATA[<h1 id="独立集群是什么"><a href="#独立集群是什么" class="headerlink" title="独立集群是什么"></a>独立集群是什么</h1><p>一个Flink独立集群至少包含一个主进程和一个<code>TaskManager</code>进程，他们可以运行在一台和多台服务器上，所有进程都是作为普通的JVM进程来运行。</p><h1 id="前提准备"><a href="#前提准备" class="headerlink" title="前提准备"></a>前提准备</h1><p>Flink要做到HA(高可靠)也需要依赖<code>zookeeper</code>组件，<code>zookeeper</code>集群搭建可以参考<a href="http://sparkx.com.cn/zookeeper/zookeeper-ha/">zookeeper介绍和集群高可用的思考</a>。<br>服务器说明如下:<br>|ip|服务器角色|<br>|–|:–|<br>|192.168.112.120|zookeeper,JobManager|<br>|192.168.112.121|zookeeper,JobManager|<br>|192.168.112.122|zookeeper,JobManager|</p><h1 id="Flink版本"><a href="#Flink版本" class="headerlink" title="Flink版本"></a>Flink版本</h1><p>version:flink-1.5.1 </p><h1 id="配置修改"><a href="#配置修改" class="headerlink" title="配置修改"></a>配置修改</h1><p><a href="https://flink.apache.org/" target="_blank" rel="noopener">点击进入官网</a><br>在192.168.112.120服务器上编辑配置，在官网下载编译好的包或者自己编译,这里重命名了flink-1.5.1为blink。<br>使用编译好的包，修改<code>blink/conf/flink-conf.yaml</code>配置文件，配置如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="comment"># Common</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="attr">jobmanager.rpc.address:</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.120</span>    <span class="comment">#注意：不同的服务器上配置对应的ip</span></span><br><span class="line"><span class="attr">jobmanager.rpc.port:</span> <span class="number">6123</span></span><br><span class="line"><span class="attr">jobmanager.heap.mb:</span> <span class="number">2048</span></span><br><span class="line"><span class="attr">taskmanager.heap.mb:</span> <span class="number">3076</span></span><br><span class="line"><span class="attr">taskmanager.numberOfTaskSlots:</span> <span class="number">4</span></span><br><span class="line"><span class="attr">parallelism.default:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">taskmanager.managed.memory.size:</span> <span class="number">1024</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="comment"># High Availability</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="attr">high-availability:</span> <span class="string">zookeeper</span></span><br><span class="line"><span class="attr">high-availability.storageDir:</span> <span class="string">hdfs://ns/user/htlapidev/bflink/ha/</span></span><br><span class="line"><span class="attr">high-availability.zookeeper.quorum:</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.120</span><span class="string">:2181,192.168.112.121:2181,192.168.112.122:2181</span></span><br><span class="line"><span class="attr">high-availability.zookeeper.path.root:</span> <span class="string">/bflink</span></span><br><span class="line"><span class="attr">high-availability.cluster-id:</span> <span class="string">/cluster_flink_uat</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="comment"># Fault tolerance and checkpointing</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="attr">state.backend:</span> <span class="string">rocksdb</span></span><br><span class="line"><span class="attr">state.checkpoints.dir:</span> <span class="string">hdfs://ns/user/htlapidev/bflink-checkpoints</span></span><br><span class="line"><span class="attr">state.savepoints.dir:</span> <span class="string">hdfs://ns/user/htlapidev/bflink-checkpoints</span></span><br><span class="line"><span class="attr">state.backend.incremental:</span> <span class="literal">true</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="comment"># Web Frontend</span></span><br><span class="line"><span class="comment">#==============================================================================</span></span><br><span class="line"><span class="comment"># The address under which the web-based runtime monitor listens.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">#jobmanager.web.address: 0.0.0.0</span></span><br><span class="line"><span class="comment"># The port under which the web-based runtime monitor listens.</span></span><br><span class="line"><span class="comment"># A value of -1 deactivates the web server.</span></span><br><span class="line"><span class="attr">rest.port:</span> <span class="number">8081</span></span><br><span class="line"><span class="comment"># 固定配置web上传jar地址</span></span><br><span class="line"><span class="attr">web.upload.dir:</span> <span class="string">/opt/data/blink/uploads</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：<br>如果自己编译源码需要修改源码<code>flink/flink-dist/src/main/resoures/flink-conf.yaml</code>配置文件，配置和同上；<br>在启动集群前需要在每台服务器上创建<code>/opt/data/blink/uploads</code>目录,否则启动失败；<br>上面配置的高可用和故障恢复的路径使用了公司的hdfs环境，连接公司hdfs需要认证，公司使用<code>kerberos</code>认证，所以必须在<code>/opt/data/blink</code>目录中上传认证文件，如下：</p></blockquote><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-rw-r--r-- <span class="number">1</span> qateadmin admin  <span class="number">262</span> Sep <span class="number">12</span> <span class="number">10</span>:<span class="number">13</span> htlapidev.keytab</span><br><span class="line">-rw-r--r-- <span class="number">1</span> qateadmin admin <span class="number">1400</span> Sep <span class="number">12</span> <span class="number">10</span>:<span class="number">13</span> krb5.conf</span><br></pre></td></tr></table></figure><p>为什么是/opt/data/blink目录呢？<br>因为我用源码编译的，并且在<code>biz_blink/flink-filesystems/flink-hadoop-fs/org.apache.flink.runtime.util.HadoopUtils</code>文件中配置了<code>/opt/data/blink</code>目录：<br>而<code>TaskManager</code>我制作成了docker镜像，部署<code>TaskManager</code>时可以自动创建并将认证文件下载到/opt/data/blink下。<br>配置/flink/conf/masters文件,内容如下：</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168.112.120:8082</span></span><br><span class="line"><span class="number">192.168.112.121:8082</span></span><br><span class="line"><span class="number">192.168.112.122:8082</span></span><br></pre></td></tr></table></figure><p>为了不让<code>JobManager</code>服务器上启动<code>TaskManagerRunner</code>进程，还需要修改flink/bin/start-cluster.sh启动脚本，修改如下：</p><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># Start TaskManager instance(s)</span></span><br><span class="line"><span class="meta">#MSlaves start   --将这一行注释掉</span></span><br></pre></td></tr></table></figure><p>使用spc命令拷贝到其他服务器：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spc -r home/qateadmin/blink <span class="number">192.168</span>.<span class="number">112.122</span><span class="symbol">:/home/qateadmin/</span></span><br><span class="line">spc -r home/qateadmin/blink <span class="number">192.168</span>.<span class="number">112.121</span><span class="symbol">:/home/qateadmin/</span></span><br></pre></td></tr></table></figure><h1 id="启动集群"><a href="#启动集群" class="headerlink" title="启动集群"></a>启动集群</h1><p>进入blink/bin/ 启动集群./start-cluster.sh</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[qateadmin@UAT14475 ~]$ ./blink/bin/<span class="keyword">start</span>-cluster.sh</span><br><span class="line"><span class="keyword">Starting</span> HA cluster <span class="keyword">with</span> <span class="number">3</span> masters.</span><br><span class="line"><span class="keyword">Starting</span> standalonesession daemon <span class="keyword">on</span> host UAT14475.</span><br><span class="line"><span class="keyword">Starting</span> standalonesession daemon <span class="keyword">on</span> host UAT14476.</span><br><span class="line"><span class="keyword">Starting</span> standalonesession daemon <span class="keyword">on</span> host UAT14477.</span><br><span class="line">[qateadmin@UAT14475 ~]$ jps</span><br><span class="line"><span class="number">4225</span> Jps</span><br><span class="line"><span class="number">27525</span> QuorumPeerMain</span><br><span class="line"><span class="number">4111</span> StandaloneSessionClusterEntrypoint</span><br></pre></td></tr></table></figure><p>打开浏览器，使用下面任何一个href都可以查看flink web页面，并且最终另外个href会最终跳转到同一个href上面，说明<code>jobmanager</code>的HA配置成功。<br>如果验证HA的话，可以将跳转后的href的服务器<code>jobmanager</code>进程kill掉，通过短暂的等待，<code>zookeeper</code>会重新从剩余的两台<code>jobmanager</code>中选举一台作为<code>active</code>对外提供服务。<br>从页面上看并没有可用的<code>slot</code>，因为还没有搭建<code>TaskManager</code>集群，后续搭建<code>TaskManager</code>后，配置了<code>zookeeper</code>的话，启动<code>TaskManager</code>后会自动注册进来，后续博客会记录<code>TaskManager</code>集群搭建。</p><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">http:</span><span class="comment">//192.168.112.120:8082/</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//192.168.112.121:8082</span></span><br><span class="line"><span class="symbol">http:</span><span class="comment">//192.168.112.122:8082/</span></span><br></pre></td></tr></table></figure><p><img src="/images/flink/flink-web.png" alt="flink-web"><br>查看<code>checkpoint</code>和<code>savepoint</code><br><img src="/images/flink/flink-checkpoint-savepoint.png" alt="checkpoint&amp;savepoint"></p>]]></content>
    
    <summary type="html">
    
      本篇博客记录Flink Standalone模式下JobManger的HA独立集群部署。
    
    </summary>
    
    
      <category term="flink" scheme="http://sparkx.com.cn/categories/flink/"/>
    
    
      <category term="flink" scheme="http://sparkx.com.cn/tags/flink/"/>
    
  </entry>
  
  <entry>
    <title>单例模式</title>
    <link href="http://sparkx.com.cn/java/singleton/"/>
    <id>http://sparkx.com.cn/java/singleton/</id>
    <published>2019-12-23T06:00:43.000Z</published>
    <updated>2020-03-30T15:01:35.018Z</updated>
    
    <content type="html"><![CDATA[<p>今天老大在会议上提到单例模式中的“枚举”创建方式，脑子一白愣是没反应过来，枚举也能创建单例？不明觉厉，于是google记录下来，顺便对单例模式做个总结。</p><h1 id="单例模式创建方式"><a href="#单例模式创建方式" class="headerlink" title="单例模式创建方式"></a>单例模式创建方式</h1><table><thead><tr><th>实现方式</th><th align="left">说明</th></tr></thead><tbody><tr><td>懒汉模式</td><td align="left">最基础的实现方式，线程上下文单例，不需要共享给所有线程，也不需要加synchronize之类的锁，以提高性能。</td></tr><tr><td>饿汉方式</td><td align="left">指全局的单例实例在类装载时构建。</td></tr><tr><td>双检锁式</td><td align="left">在懒汉式基础上利用synchronize关键字和volatile关键字确保第一次创建时没有线程间竞争而产生多个实例，仅第一次创建时同步，性能相对较高。</td></tr><tr><td>枚举</td><td align="left">java中枚举类本身也是一种单例模式。</td></tr></tbody></table><p>参考：<a href="https://zhuanlan.zhihu.com/p/33102022" target="_blank" rel="noopener">漫画：什么是单例模式？</a></p>]]></content>
    
    <summary type="html">
    
      单例模式，属于创建类型的一种常用的软件设计模式。通过单例模式的方法创建的类在当前进程中只有一个实例。
    
    </summary>
    
    
      <category term="java" scheme="http://sparkx.com.cn/categories/java/"/>
    
      <category term="设计模式" scheme="http://sparkx.com.cn/categories/java/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="java" scheme="http://sparkx.com.cn/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>常用数据库列表</title>
    <link href="http://sparkx.com.cn/mysql/dblist/"/>
    <id>http://sparkx.com.cn/mysql/dblist/</id>
    <published>2019-12-18T14:44:01.000Z</published>
    <updated>2019-12-18T15:13:22.545Z</updated>
    
    <content type="html"><![CDATA[<h2 id="常用关系数据库"><a href="#常用关系数据库" class="headerlink" title="常用关系数据库"></a>常用关系数据库</h2><h3 id="1-MySQL"><a href="#1-MySQL" class="headerlink" title="1.MySQL"></a>1.<a href="https://www.mysql.com/" target="_blank" rel="noopener">MySQL</a></h3><p>免费开源，比较常用。</p><h3 id="2-SqlServer"><a href="#2-SqlServer" class="headerlink" title="2.SqlServer"></a>2.<a href="https://www.microsoft.com/zh-cn/sql-server/sql-server-downloads" target="_blank" rel="noopener">SqlServer</a></h3><p>微软公司开发的数据库，收费。</p><h3 id="3-Oracle"><a href="#3-Oracle" class="headerlink" title="3.Oracle"></a>3.<a href="https://www.oracle.com/database/" target="_blank" rel="noopener">Oracle</a></h3><p>非开源，有钱的传统企业使用。</p><h3 id="4-DB2"><a href="#4-DB2" class="headerlink" title="4.DB2"></a>4.<a href="https://www.ibm.com/cn-zh/analytics/db2" target="_blank" rel="noopener">DB2</a></h3><p>不常用。</p><h2 id="缓存数据库"><a href="#缓存数据库" class="headerlink" title="缓存数据库"></a>缓存数据库</h2><h3 id="1-Redis英文网-Redis中文网"><a href="#1-Redis英文网-Redis中文网" class="headerlink" title="1.Redis英文网 Redis中文网"></a>1.<a href="https://redis.io/" target="_blank" rel="noopener">Redis英文网</a> <a href="http://www.redis.cn/" target="_blank" rel="noopener">Redis中文网</a></h3><p>Redis 是一个开源（BSD许可）的，内存中的数据结构存储系统，它可以用作数据库、缓存和消息中间件。<br>最常用的缓存之一。</p><h3 id="2-Memcached"><a href="#2-Memcached" class="headerlink" title="2.Memcached"></a>2.<a href="https://www.memcached.org/" target="_blank" rel="noopener">Memcached</a></h3><h2 id="非关系数据库"><a href="#非关系数据库" class="headerlink" title="非关系数据库"></a>非关系数据库</h2><h3 id="1-HBase"><a href="#1-HBase" class="headerlink" title="1.HBase"></a>1.<a href="http://hbase.apache.org/" target="_blank" rel="noopener">HBase</a></h3><h3 id="2-MongoDB"><a href="#2-MongoDB" class="headerlink" title="2.MongoDB"></a>2.<a href="https://www.mongodb.com/" target="_blank" rel="noopener">MongoDB</a></h3><h3 id="3-RocksDB英文网-RocksDB中文网"><a href="#3-RocksDB英文网-RocksDB中文网" class="headerlink" title="3.RocksDB英文网 RocksDB中文网"></a>3.<a href="https://rocksdb.org/" target="_blank" rel="noopener">RocksDB英文网</a> <a href="https://rocksdb.org.cn/" target="_blank" rel="noopener">RocksDB中文网</a></h3><ul><li>高性能：RocksDB使用一套日志结构的数据库引擎，为了更好的性能，这套引擎是用C++编写的。 Key和value是任意大小的字节流。</li><li>为快速存储而优化：RocksDB为快速而又低延迟的存储设备（例如闪存或者高速硬盘）而特殊优化处理。 RocksDB将最大限度的发挥闪存和RAM的高度率读写性能。</li><li>可适配性：RocksDB适合于多种不同工作量类型。 从像MyRocks这样的数据存储引擎， 到应用数据缓存, 甚至是一些嵌入式工作量，RocksDB都可以从容面对这些不同的数据工作量需求。</li><li>基础和高级的数据库操作：RocksDB提供了一些基础的操作，例如打开和关闭数据库。 对于合并和压缩过滤等高级操作，也提供了读写支持。</li></ul><h2 id="其他数据库"><a href="#其他数据库" class="headerlink" title="其他数据库"></a>其他数据库</h2><h3 id="1-SQLite"><a href="#1-SQLite" class="headerlink" title="1.SQLite"></a>1.<a href="https://sqlite.org/index.html" target="_blank" rel="noopener">SQLite</a></h3><p>SQLite是一种嵌入式数据库，它的数据库就是一个文件。由于SQLite本身是C写的，而且体积很小，所以，经常被集成到各种应用程序中，甚至在iOS和Android的App中都可以集成。<br>持续更新中……</p>]]></content>
    
    <summary type="html">
    
      本博客收集工作中常用的数据库，并对数据库和数据库使用场景简单介绍!
    
    </summary>
    
    
      <category term="数据库" scheme="http://sparkx.com.cn/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
      <category term="mysql" scheme="http://sparkx.com.cn/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/mysql/"/>
    
    
      <category term="数据库" scheme="http://sparkx.com.cn/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"/>
    
  </entry>
  
  <entry>
    <title>zookeeper介绍和集群高可用的思考</title>
    <link href="http://sparkx.com.cn/zookeeper/zookeeper-ha/"/>
    <id>http://sparkx.com.cn/zookeeper/zookeeper-ha/</id>
    <published>2019-12-16T11:33:39.000Z</published>
    <updated>2020-03-30T15:01:35.020Z</updated>
    
    <content type="html"><![CDATA[<p><a href="http://zookeeper.apache.org/" target="_blank" rel="noopener">点击进入官网</a></p><h2 id="三种运行模式"><a href="#三种运行模式" class="headerlink" title="三种运行模式"></a>三种运行模式</h2><p>单机模式、伪集群模式和集群模式。</p><h3 id="1-单机模式"><a href="#1-单机模式" class="headerlink" title="1.单机模式"></a>1.单机模式</h3><p>单机模式一般适合开发测试环境，节约机器资源并且不需要考虑稳定性。<br>安装Java环境(自行搜索jdk安装方法)。<br>安装zookeeper：<a href="http://zookeeper.apache.org/releases.html" target="_blank" rel="noopener">点击下载安装包</a> 下载<code>apache-zookeeper-3.5.6-bin.tar.gz</code>文件。<br>配置zoo.cfg：将下载的tar包解压后配置<code>$ZK_HOME</code>,然后将<code>$ZK_HOME</code>下的<code>zoo_sample.cfg</code>文件重命名为<code>zoo.cfg</code>，并进行以下配置:</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tickTime</span>=<span class="number">2000</span>    <span class="comment">##Zookeeper最小时间单元，单位毫秒(ms)，默认值为3000</span></span><br><span class="line"><span class="attr">dataDir</span>=/home/qateadmin/zookeeper/data    <span class="comment">##Zookeeper服务器存储快照文件的目录，必须配置</span></span><br><span class="line"><span class="attr">dataLogDir</span>=/var/lib/log     <span class="comment">##Zookeeper服务器存储事务日志的目录，默认为dataDir</span></span><br><span class="line"><span class="attr">clientPort</span>=<span class="number">2181</span>    <span class="comment">##服务器对外服务端口，一般设置为2181</span></span><br><span class="line"><span class="attr">initLimit</span>=<span class="number">5</span>    <span class="comment">##Leader服务器等待Follower启动并完成数据同步的时间，默认值10，表示tickTime的10倍</span></span><br><span class="line"><span class="attr">syncLimit</span>=<span class="number">2</span>    <span class="comment">##Leader服务器和Follower之间进行心跳检测的最大延时时间，默认值5，表示tickTime的5倍</span></span><br></pre></td></tr></table></figure><p>启动服务：使用<code>$ZK_HOME/bin</code>目录下的zkServer.sh脚本启动，如:<code>zkServer.sh start</code>。</p><h3 id="2-集群模式"><a href="#2-集群模式" class="headerlink" title="2.集群模式"></a>2.集群模式</h3><p>服务器ip和主机名绑定如下：</p><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">192.168.120.120</span> uat14475</span><br><span class="line"><span class="number">192.168.120.121</span> uat14476</span><br><span class="line"><span class="number">192.168.120.122</span> uat14477</span><br></pre></td></tr></table></figure><p>同样要安装好Java运行环境。<br>将下载好的zookeeper包<code>apache-zookeeper-3.5.6-bin.tar.gz</code>上传到服务器/home/qateadmin目录，并执行命令<code>tar -zxvf apache-zookeeper-3.5.6-bin.tar.gz</code>解压到当前目录,然后重命名为zookeeper。<br>配置环境变量：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">ZK_HOME</span>=/home/qateadmin/zookeeper</span><br><span class="line"><span class="attribute">PAT</span>=H$PATH:$HOME/.local/bin:$HOME/bin:$ZK_HOME/bin</span><br><span class="line"><span class="builtin-name">export</span> PATH</span><br></pre></td></tr></table></figure><p>配置zookeeper集群：进入$ZK_HOME/conf，执行命令<code>mv zoo.sample.cfg zoo.cfg</code>重命名配置，并编辑<code>zoo.cfg</code>文件修改配置参数如下，并保存。</p><blockquote><blockquote><p>注意：zookeeper server.x后面尽量不要配置服务器名称，否则HA查看master的webui时还需要在本地电脑上配置zookeeper集群ip绑定列表。</p></blockquote></blockquote><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tickTime=<span class="number">2000</span></span><br><span class="line">initLimit=<span class="number">10</span></span><br><span class="line">syncLimit=<span class="number">5</span></span><br><span class="line">dataDir=/home/qateadmin/zookeeper/data</span><br><span class="line">clientPort=<span class="number">2181</span></span><br><span class="line">server<span class="number">.1</span>=<span class="number">192.168</span><span class="number">.120</span><span class="number">.120</span>:<span class="number">2888</span>:<span class="number">3888</span></span><br><span class="line">server<span class="number">.2</span>=<span class="number">192.168</span><span class="number">.120</span><span class="number">.121</span>:<span class="number">2888</span>:<span class="number">3888</span></span><br><span class="line">server<span class="number">.3</span>=<span class="number">192.168</span><span class="number">.120</span><span class="number">.122</span>:<span class="number">2888</span>:<span class="number">3888</span></span><br></pre></td></tr></table></figure><p>在dataDir指定的目录下创建myid文件,文件内容为server后面的ID,即1。<br>然后通过scp命令<code>scp -r zookeeper uat14476:/home/qateadmin/</code>将第一台服务器配置好的zookeeper拷贝到其他两台服务器上，并且将uat14476中dataDir指定目录下的myid改为2,将uat14477中dataDir指定目录下的myid改为3。<br>启动服务：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">zkServer.sh <span class="keyword">start</span>  //启动服务</span><br><span class="line">zkServer.sh <span class="keyword">status</span> //查看服务状态</span><br><span class="line">zkServer.sh <span class="keyword">stop</span> //停止服务</span><br><span class="line">//下面是启动的时的信息</span><br><span class="line">[qateadmin@UAT14475 <span class="keyword">bin</span>]$ ./zkServer.sh <span class="keyword">start</span></span><br><span class="line">/usr/<span class="keyword">bin</span>/<span class="keyword">java</span></span><br><span class="line">ZooKeeper JMX enabled <span class="keyword">by</span> <span class="keyword">default</span></span><br><span class="line"><span class="keyword">Using</span> config: /home/qateadmin/zookeeper/<span class="keyword">bin</span>/../conf/zoo.cfg</span><br><span class="line"><span class="keyword">Starting</span> zookeeper ... STARTED</span><br><span class="line">[qateadmin@UAT14475 <span class="keyword">bin</span>]$ ./zkServer.sh <span class="keyword">status</span></span><br><span class="line">/usr/<span class="keyword">bin</span>/<span class="keyword">java</span></span><br><span class="line">ZooKeeper JMX enabled <span class="keyword">by</span> <span class="keyword">default</span></span><br><span class="line"><span class="keyword">Using</span> config: /home/qateadmin/zookeeper/<span class="keyword">bin</span>/../conf/zoo.cfg</span><br><span class="line"><span class="keyword">Client</span> port <span class="keyword">found</span>: <span class="number">2181.</span> <span class="keyword">Client</span> address: localhost.</span><br><span class="line"><span class="keyword">Error</span> contacting service. It <span class="keyword">is</span> probably <span class="keyword">not</span> running.</span><br><span class="line">//启动集群中的第一台后查看状态好像没起来，其实通过下面的jps命令可以看到进程<span class="number">17707</span> QuorumPeerMain已经启动了.</span><br><span class="line">//只所以提示<span class="keyword">not</span> running是因为集群需要选举，所以再启动另外两台后查看就正常了。</span><br><span class="line">[qateadmin@UAT14475 <span class="keyword">bin</span>]$ jps</span><br><span class="line"><span class="number">17989</span> Jps</span><br><span class="line"><span class="number">17707</span> QuorumPeerMain</span><br><span class="line"><span class="number">22398</span> ServerBootstrap</span><br><span class="line">[qateadmin@UAT14475 <span class="keyword">bin</span>]$ ./zkServer.sh <span class="keyword">status</span>  //将另外两台zookeeper启动查看状态</span><br><span class="line">/usr/<span class="keyword">bin</span>/<span class="keyword">java</span></span><br><span class="line">ZooKeeper JMX enabled <span class="keyword">by</span> <span class="keyword">default</span></span><br><span class="line"><span class="keyword">Using</span> config: /home/qateadmin/zookeeper/<span class="keyword">bin</span>/../conf/zoo.cfg</span><br><span class="line"><span class="keyword">Client</span> port <span class="keyword">found</span>: <span class="number">2181.</span> <span class="keyword">Client</span> address: localhost.</span><br><span class="line"><span class="keyword">Mode</span>: follower</span><br></pre></td></tr></table></figure><h3 id="3-伪分布模式"><a href="#3-伪分布模式" class="headerlink" title="3.伪分布模式"></a>3.伪分布模式</h3><p>是一种特殊的集群模式，即集群的所有服务器都部署在一台机器上。当你有一台较好的服务器，zookeeper允许在一台服务器上通过启动不同的端口来启动多个zookeeper实例，以此来以集群对外提供服务。<br>这种模式，只需把zoo.cfg的server.x 对应的端口改成不同的，生产环境不建议伪分布部署。</p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server<span class="number">.1</span>=<span class="number">192.168</span><span class="number">.120</span><span class="number">.120</span>:<span class="number">2888</span>:<span class="number">3888</span></span><br><span class="line">server<span class="number">.2</span>=<span class="number">192.168</span><span class="number">.120</span><span class="number">.121</span>:<span class="number">2889</span>:<span class="number">3889</span></span><br><span class="line">server<span class="number">.3</span>=<span class="number">192.168</span><span class="number">.120</span><span class="number">.122</span>:<span class="number">2890</span>:<span class="number">3890</span></span><br></pre></td></tr></table></figure><h2 id="集群高可用"><a href="#集群高可用" class="headerlink" title="集群高可用"></a>集群高可用</h2><h3 id="1-为什么要设计奇数台服务器"><a href="#1-为什么要设计奇数台服务器" class="headerlink" title="1.为什么要设计奇数台服务器"></a>1.为什么要设计奇数台服务器</h3><p>很多人对zookeeper选举leader认识有偏差，认为“为了使得 ZooKeeper 集群能够顺利地选举出 Leader，必须将 ZooKeeper 集群的服务器数部署成奇数”。这么说虽然没错，但是实际的原因是:<strong>存活过半即可用</strong>的特性。<br>即：如果想搭建运行N台服务器挂掉，那么就要部署2*N+1台服务器构成zookeeper集群，也就是说：由6台服务器构成的zookeeper集群和5台服务器构成的zookeeper集群在容灾能力上并没有优势，反而浪费一台服务器，所以基于这个原因，zookeeper集群通常设计成奇数台服务器。</p><h3 id="2-什么是容灾"><a href="#2-什么是容灾" class="headerlink" title="2.什么是容灾"></a>2.什么是容灾</h3><p>所谓容灾，在 IT 行业通常是指我们的计算机信息系统具有的一种在遭受诸如火灾、地震、断电和其他基础网络设备故障等毁灭性灾难的时候，依然能够对外提供可用服务的能力。<br>ZooKeeper 既然已经解决了单点问题，那为什么还要进行容灾呢？</p><h3 id="3-单点问题"><a href="#3-单点问题" class="headerlink" title="3.单点问题"></a>3.单点问题</h3><p>单点问题是分布式环境中最常见也是最经典的问题之一，具体地说，在一个分布式系统中，如果某一个组件出现故障就会引起整个系统的可用性大大下降甚至是处于瘫痪状态，那么我们就认为该组件存在单点问题。<br>ZooKeeper基于“过半”设计原则确实已经解决了单点问题，在运行期间，集群中至少有过半的机器保存了最新的数据。因此，只要集群中超过半数的机器还能够正常工作，整个集群就能够对外提供服务。</p><h3 id="4-单机房问题"><a href="#4-单机房问题" class="headerlink" title="4.单机房问题"></a>4.单机房问题</h3><p>如果你的zookeeper集群都在一个机房中，如果一个机房整个出问题，你依赖zookeeper运行的服务器还是会因此故障。</p><h3 id="5-双机房问题"><a href="#5-双机房问题" class="headerlink" title="5.双机房问题"></a>5.双机房问题</h3><p>因资源问题，很多公司在做容灾是都是双机房，但是zookeeper在双机房条件下并没有实现好的容灾效果，原因是：无论哪个机房发生异常，都有可能使zookeeper集群中可以使用的机器无法超过半数。比如：7=4+3的部署方式，如果多于半数的那个机房挂了，zookeeper就无法选举leader。<br>实际很多公司的做法是：租用一个可靠机房和一个廉价机房，在可靠的机房尽量部署更多的zookeeper。</p><h3 id="6-三机房部署"><a href="#6-三机房部署" class="headerlink" title="6.三机房部署"></a>6.三机房部署</h3><p>三机房部署要遵循<strong>存活过半即可用</strong>的原则。假设服务器总数是N，那么三个机房部署zookeeper的服务器N1、N2和N3使集群具有容灾能力，三者的取值算法如下：</p><ul><li>计算N1：<code>N1=(N-1)/2</code></li><li>计算N2：<code>N2取值范围1~(N-N1)/2</code> 整数相除向下取整</li><li>计算N3：<code>N3=N-N1-N2</code> 同时确定N2，即必须满足N3&lt;N1+N2。</li></ul><p>例如：部署7台服务器，可以有两种部署方案：(3,1,3)和(3,2,2)。</p><h2 id="水平扩容"><a href="#水平扩容" class="headerlink" title="水平扩容"></a>水平扩容</h2><p>简单地讲，水平扩容就是向集群中添加更多的机器，以提高系统的服务质量。<br>ZooKeeper在水平扩容扩容方面做得并不十分完美，需要进行整个集群的重启。通常有两种重启方式，一种是集群整体重启，另外一种是逐台进行服务器的重启。</p><h3 id="1-整体重启"><a href="#1-整体重启" class="headerlink" title="1.整体重启"></a>1.整体重启</h3><p>就是先将整个集群停止，然后更新zookeeper配置，然后重启。重启过程中，所有该集群客户端都无法连接上集群，等到集群再次启动，这些客户端就能够自动连接上——注意，整体启动前建立起的客户端会话，并不会因为此次整体重启而失效。也就是说，在整体重启期间花费的时间将不计入会话超时时间的计算中。</p><h3 id="2-逐台重启"><a href="#2-逐台重启" class="headerlink" title="2.逐台重启"></a>2.逐台重启</h3><ul><li>在这种方式中，每次仅仅重启集群中的一台机器，然后逐台对整个集群中的机器进行重启操作。这种方式可以在重启期间依然保证集群对外的正常服务。<strong>（推荐）</strong></li></ul><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p>《从Paxos到Zookeeper  分布式一致性原理与实践》<br><a href="https://www.cnblogs.com/cyfonly/p/5626532.html" target="_blank" rel="noopener">构建高可用ZooKeeper集群</a></p>]]></content>
    
    <summary type="html">
    
      ZooKeeper是Apache的一个顶级项目，为分布式应用提供高效、高可用的分布式协调服务，提供了诸如数据发布/订阅、负载均衡、命名服务、分布式协调/通知和分布式锁等分布式基础服务。
    
    </summary>
    
    
      <category term="zookeeper" scheme="http://sparkx.com.cn/categories/zookeeper/"/>
    
      <category term="tools" scheme="http://sparkx.com.cn/categories/zookeeper/tools/"/>
    
    
      <category term="zookeeper" scheme="http://sparkx.com.cn/tags/zookeeper/"/>
    
  </entry>
  
  <entry>
    <title>spark rdd编程实战</title>
    <link href="http://sparkx.com.cn/spark/spark-rdd-programming/"/>
    <id>http://sparkx.com.cn/spark/spark-rdd-programming/</id>
    <published>2019-12-11T11:46:59.000Z</published>
    <updated>2019-12-12T16:39:04.966Z</updated>
    
    <content type="html"><![CDATA[<p>工欲善其事必先利其器，<a href="http://sparkx.com.cn/spark/spark-setup/">spark集群环境搭建</a>完成后，接下来学习一下spark rdd的编程实战。</p><h1 id="创建RDD"><a href="#创建RDD" class="headerlink" title="创建RDD"></a>创建RDD</h1><ul><li>从文件系统中加载数据创建RDD<br>Spark采用textFile()方法从文件系统中加载数据创建RDD，该方法把URI作为参数，URI可以是：<code>本地文件地址</code>、<code>分布式系统HDFS地址</code>、<code>Amazon S3地址</code>。<br><a href="http://spark.apache.org/docs/latest/quick-start.html" target="_blank" rel="noopener">点击进入官方文档</a><br>首先启动spark-shell,步骤如下：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root@master1:~<span class="comment"># cd $SPARK_HOME</span></span><br><span class="line">root@master1:/usr/local/spark/spark-2.4.4-bin-hadoop2.6<span class="comment"># ./bin/spark-shell</span></span><br><span class="line">19/12/11 20:18:27 WARN util.NativeCodeLoader: Unable to <span class="keyword">load</span> <span class="keyword">native</span>-hadoop <span class="keyword">library</span> <span class="keyword">for</span> your platform... <span class="keyword">using</span> builtin-<span class="keyword">java</span> classes <span class="keyword">where</span> applicable</span><br><span class="line">Setting <span class="keyword">default</span> <span class="keyword">log</span> <span class="keyword">level</span> <span class="keyword">to</span> <span class="string">"WARN"</span>.</span><br><span class="line"><span class="keyword">To</span> adjust <span class="keyword">logging</span> <span class="keyword">level</span> <span class="keyword">use</span> sc.setLogLevel(newLevel). <span class="keyword">For</span> SparkR, <span class="keyword">use</span> setLogLevel(newLevel).</span><br><span class="line">Spark <span class="keyword">context</span> Web UI available <span class="keyword">at</span> <span class="keyword">http</span>://master1:<span class="number">4040</span></span><br><span class="line">Spark <span class="keyword">context</span> available <span class="keyword">as</span> <span class="string">'sc'</span> (<span class="keyword">master</span> = <span class="keyword">local</span>[*], app <span class="keyword">id</span> = <span class="keyword">local</span><span class="number">-1576066723716</span>).</span><br><span class="line">Spark <span class="keyword">session</span> available <span class="keyword">as</span> <span class="string">'spark'</span>.</span><br><span class="line">Welcome <span class="keyword">to</span></span><br><span class="line">      ____              __</span><br><span class="line">     / __/__  ___ _____/ /__</span><br><span class="line">    _\ \/ _ \/ _ <span class="string">`/ __/  '_/</span></span><br><span class="line"><span class="string">   /___/ .__/\_,_/_/ /_/\_\   version 2.4.4</span></span><br><span class="line"><span class="string">      /_/</span></span><br><span class="line"><span class="string">         </span></span><br><span class="line"><span class="string">Using Scala version 2.11.12 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_71)</span></span><br><span class="line"><span class="string">Type in expressions to have them evaluated.</span></span><br><span class="line"><span class="string">Type :help for more information.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">scala&gt;</span></span><br></pre></td></tr></table></figure>从本地文件系统加载数据,读本地文件的目录前加上<code>file://</code>，否则会默认从集群中读取，而读不到会报错。<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">scala</span>&gt; val textFile = spark.<span class="keyword">read</span>.textFile(<span class="string">"/usr/local/spark/spark-2.4.4-bin-hadoop2.6/README.md"</span>)</span><br><span class="line">org.apache.spark.sql.AnalysisException: Path does not exist: hdfs:<span class="comment">//master1:9000/usr/local/spark/spark-2.4.4-bin-hadoop2.6/README.md;</span></span><br><span class="line">  at org.apache.spark.sql.execution.datasources.DataSource$<span class="variable">$anonfun</span><span class="variable">$org</span><span class="variable">$apache</span><span class="variable">$spark</span><span class="variable">$sql</span><span class="variable">$execution</span><span class="variable">$datasources</span><span class="variable">$DataSource</span>$<span class="variable">$checkAndGlobPathIfNecessary</span><span class="variable">$1</span>.apply(DataSource.<span class="keyword">scala</span>:558)</span><br><span class="line">  at org.apache.spark.sql.execution.datasources.DataSource$<span class="variable">$anonfun</span><span class="variable">$org</span><span class="variable">$apache</span><span class="variable">$spark</span><span class="variable">$sql</span><span class="variable">$execution</span><span class="variable">$datasources</span><span class="variable">$DataSource</span>$<span class="variable">$checkAndGlobPathIfNecessary</span><span class="variable">$1</span>.apply(DataSource.<span class="keyword">scala</span>:545)</span><br><span class="line">  at <span class="keyword">scala</span>.collection.TraversableLike$<span class="variable">$anonfun</span><span class="variable">$flatMap</span><span class="variable">$1</span>.apply(TraversableLike.<span class="keyword">scala</span>:241)</span><br><span class="line">  at <span class="keyword">scala</span>.collection.TraversableLike$<span class="variable">$anonfun</span><span class="variable">$flatMap</span><span class="variable">$1</span>.apply(TraversableLike.<span class="keyword">scala</span>:241)</span><br><span class="line">  at <span class="keyword">scala</span>.collection.immutable.<span class="keyword">List</span>.<span class="keyword">foreach</span>(<span class="keyword">List</span>.<span class="keyword">scala</span>:392)</span><br><span class="line">  at <span class="keyword">scala</span>.collection.TraversableLike<span class="variable">$class</span>.flatMap(TraversableLike.<span class="keyword">scala</span>:241)</span><br><span class="line">  at <span class="keyword">scala</span>.collection.immutable.<span class="keyword">List</span>.flatMap(<span class="keyword">List</span>.<span class="keyword">scala</span>:355)</span><br><span class="line">  at org.apache.spark.sql.execution.datasources.DataSource.org<span class="variable">$apache</span><span class="variable">$spark</span><span class="variable">$sql</span><span class="variable">$execution</span><span class="variable">$datasources</span><span class="variable">$DataSource</span>$<span class="variable">$checkAndGlobPathIfNecessary</span>(DataSource.<span class="keyword">scala</span>:545)</span><br><span class="line">  at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.<span class="keyword">scala</span>:359)</span><br><span class="line">  at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.<span class="keyword">scala</span>:223)</span><br><span class="line">  at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.<span class="keyword">scala</span>:211)</span><br><span class="line">  at org.apache.spark.sql.DataFrameReader.text(DataFrameReader.<span class="keyword">scala</span>:714)</span><br><span class="line">  at org.apache.spark.sql.DataFrameReader.textFile(DataFrameReader.<span class="keyword">scala</span>:756)</span><br><span class="line">  at org.apache.spark.sql.DataFrameReader.textFile(DataFrameReader.<span class="keyword">scala</span>:723)</span><br><span class="line">  ... 49 elided</span><br><span class="line"> 正确的方法</span><br><span class="line"><span class="keyword">scala</span>&gt; val textFile = spark.<span class="keyword">read</span>.textFile(<span class="string">"file:///usr/local/spark/spark-2.4.4-bin-hadoop2.6/README.md"</span>)</span><br><span class="line">textFile: org.apache.spark.sql.Dataset[String] = [value: string] #得到的是Dataset</span><br><span class="line"><span class="keyword">scala</span>&gt; textFile.<span class="keyword">count</span>() #统计单词</span><br><span class="line">res0: Long = 105                                                                </span><br><span class="line"></span><br><span class="line"><span class="keyword">scala</span>&gt; textFile.first() #读取第一行</span><br><span class="line">res1: String = # Apache Spark</span><br><span class="line"><span class="keyword">scala</span>&gt; val lineWithSpark = textFile.filter(<span class="keyword">line</span>=&gt;<span class="keyword">line</span>.contains(<span class="string">"Spark"</span>))</span><br><span class="line">lineWithSpark: org.apache.spark.sql.Dataset[String] = [value: string] #Dataset通过filter生成一个新的Dataset</span><br><span class="line"></span><br><span class="line"><span class="keyword">scala</span>&gt; textFile.filter(<span class="keyword">line</span>=&gt;<span class="keyword">line</span>.contains(<span class="string">"Spark"</span>)).<span class="keyword">count</span>() #统计含有<span class="string">"Spark"</span>的行数</span><br><span class="line">res2: Long = 20</span><br></pre></td></tr></table></figure></li><li>从分布式文件系统HDFS中加载数据<br>首先我们再hdfs上创建/spark目录，并将spark-2.4.4-bin-hadoop.2.6中的README.md上传到该目录中。<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root<span class="variable">@master1</span><span class="symbol">:/usr/local/spark/spark-</span><span class="number">2.4</span>.<span class="number">4</span>-bin-hadoop2.<span class="number">6</span><span class="comment"># hdfs dfs -mkdir /spark</span></span><br><span class="line"><span class="number">19/12</span>/<span class="number">11 20</span><span class="symbol">:</span><span class="number">46:38</span> WARN <span class="symbol">util.NativeCodeLoader:</span> Unable to load native-hadoop library <span class="keyword">for</span> your platform... using builtin-java classes where applicable</span><br><span class="line">root<span class="variable">@master1</span><span class="symbol">:/usr/local/spark/spark-</span><span class="number">2.4</span>.<span class="number">4</span>-bin-hadoop2.<span class="number">6</span><span class="comment"># hdfs dfs -put README.md /spark</span></span><br><span class="line"><span class="number">19/12</span>/<span class="number">11 20</span><span class="symbol">:</span><span class="number">46:50</span> WARN <span class="symbol">util.NativeCodeLoader:</span> Unable to load native-hadoop library <span class="keyword">for</span> your platform... using builtin-java classes where applicable</span><br><span class="line">root<span class="variable">@master1</span><span class="symbol">:/usr/local/spark/spark-</span><span class="number">2.4</span>.<span class="number">4</span>-bin-hadoop2.<span class="number">6</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>在<a href="http://192.168.112.120:50070/explorer.html#/spark" target="_blank" rel="noopener">http://192.168.112.120:50070/explorer.html#/spark</a> 中查看文件，如下:<br><img src="/images/hadoop/hdfs_spark_readme.png" alt=""><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#以下三种写法都正确</span><br><span class="line">scala&gt; val lines = sc.textFile(<span class="string">"hdfs://master1:9000/spark/README.md"</span>)</span><br><span class="line">lines: org<span class="selector-class">.apache</span><span class="selector-class">.spark</span><span class="selector-class">.rdd</span><span class="selector-class">.RDD</span>[String] = hdfs:<span class="comment">//master1:9000/spark/README.md MapPartitionsRDD[17] at textFile at &lt;console&gt;:24</span></span><br><span class="line"></span><br><span class="line">scala&gt; val lines = sc.textFile(<span class="string">"/user/spark/README.md"</span>)</span><br><span class="line">lines: org<span class="selector-class">.apache</span><span class="selector-class">.spark</span><span class="selector-class">.rdd</span><span class="selector-class">.RDD</span>[String] = /user/spark/README<span class="selector-class">.md</span> MapPartitionsRDD[<span class="number">19</span>] at textFile at &lt;console&gt;:<span class="number">24</span></span><br><span class="line"></span><br><span class="line">scala&gt; val lines = sc.textFile(<span class="string">"/spark/README.md"</span>)</span><br><span class="line">lines: org<span class="selector-class">.apache</span><span class="selector-class">.spark</span><span class="selector-class">.rdd</span><span class="selector-class">.RDD</span>[String] = /spark/README<span class="selector-class">.md</span> MapPartitionsRDD[<span class="number">21</span>] at textFile at &lt;console&gt;:<span class="number">24</span></span><br><span class="line"></span><br><span class="line">scala&gt; lines.count()</span><br><span class="line">res3: Long = <span class="number">105</span></span><br></pre></td></tr></table></figure></li><li>通过并行集合(数组)创建RDD<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; var <span class="built_in">array</span> = Array(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line"><span class="built_in">array</span>: Array[Int] = Array(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; var rdd = sc.parallelize(<span class="built_in">array</span>)</span><br><span class="line">rdd: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[<span class="number">22</span>] at parallelize at &lt;console&gt;:<span class="number">26</span></span><br><span class="line"></span><br><span class="line">scala&gt; val rdd2 = sc.parallelize(list)</span><br><span class="line">rdd2: org.apache.spark.rdd.RDD[Int] = ParallelCollectionRDD[<span class="number">23</span>] at parallelize at &lt;console&gt;:<span class="number">26</span></span><br><span class="line"></span><br><span class="line">scala&gt; rdd.collect()</span><br><span class="line">res4: Array[Int] = Array(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; rdd2.collect()</span><br><span class="line">res5: Array[Int] = Array(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure><h1 id="更多Dataset的操作"><a href="#更多Dataset的操作" class="headerlink" title="更多Dataset的操作"></a>更多Dataset的操作</h1><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; textFile.<span class="built_in">map</span>(<span class="built_in">line</span>=&gt;<span class="built_in">line</span>.<span class="built_in">split</span>(<span class="string">" "</span>).<span class="built_in">size</span>).reduce((a,b)=&gt;<span class="keyword">if</span>(a&gt;b) a <span class="keyword">else</span> b) #获取词数最大的值</span><br><span class="line">res0: Int = <span class="number">22</span> </span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">import</span> java.lang.Math</span><br><span class="line"><span class="keyword">import</span> java.lang.Math</span><br><span class="line"></span><br><span class="line">scala&gt; textFile.<span class="built_in">map</span>(<span class="built_in">line</span>=&gt;<span class="built_in">line</span>.<span class="built_in">split</span>(<span class="string">" "</span>).<span class="built_in">size</span>).reduce((a,b)=&gt;Math.<span class="built_in">max</span>(a,b)) #用函数操作</span><br><span class="line">res1: Int = <span class="number">22</span></span><br><span class="line">#Spark很简单的实现MapReduce，并通过groupByKey来统计词的出现词数</span><br><span class="line">scala&gt; val wordCounts = textFile.flatMap(<span class="built_in">line</span> =&gt; <span class="built_in">line</span>.<span class="built_in">split</span>(<span class="string">" "</span>)).groupByKey(identity).count()</span><br><span class="line">wordCounts: org.apache.spark.sql.Dataset[(<span class="keyword">String</span>, Long)] = [value: string, count(<span class="number">1</span>): bigint]</span><br><span class="line"></span><br><span class="line">scala&gt; wordCounts.collect() #调用collect()函数输出</span><br><span class="line">res2: <span class="keyword">Array</span>[(<span class="keyword">String</span>, Long)] = <span class="keyword">Array</span>((online,<span class="number">1</span>), (graphs,<span class="number">1</span>), ([<span class="string">"Parallel,1), (["</span>Building,<span class="number">1</span>), (thread,<span class="number">1</span>), (documentation,<span class="number">3</span>), (command,,<span class="number">2</span>), (abbreviated,<span class="number">1</span>), (overview,<span class="number">1</span>), (rich,<span class="number">1</span>), (<span class="built_in">set</span>,<span class="number">2</span>), (-DskipTests,<span class="number">1</span>), (name,<span class="number">1</span>), (page](http:<span class="comment">//spark.apache.org/documentation.html).,1), (["Specifying,1), (stream,1), (run:,1), (not,1), (programs,2), (tests,2), (./dev/run-tests,1), (will,1), ([run,1), (particular,2), (option,1), (Alternatively,,1), (by,1), (must,1), (using,5), (you,4), (MLlib,1), (DataFrames,,1), (variable,1), (Note,1), (core,1), (more,1), (protocols,1), (guidance,2), (shell:,2), (can,7), (site,,1), (systems.,1), (Maven,1), ([building,1), (configure,1), (for,12), (README,1), (Interactive,2), (how,3), ([Configuration,1), (Hive,2), (system,1), (provides,1), (Hadoop-supported,1), (pre-built,1...</span></span><br><span class="line">scala&gt;</span><br></pre></td></tr></table></figure><h1 id="Caching"><a href="#Caching" class="headerlink" title="Caching"></a>Caching</h1>spark也支持将拉取的数据集缓存下来，对于重复访问的热点数据非常好。<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">scala</span>&gt; lineWithSpark.cache()</span><br><span class="line">res3: lineWithSpark.<span class="keyword">type</span> = [value: string]</span><br><span class="line"></span><br><span class="line"><span class="keyword">scala</span>&gt; lineWithSpark.<span class="keyword">count</span>()</span><br><span class="line">res4: Long = 20</span><br><span class="line"></span><br><span class="line"><span class="keyword">scala</span>&gt; lineWithSpark.<span class="keyword">count</span>()</span><br><span class="line">res5: Long = 20</span><br></pre></td></tr></table></figure><h1 id="独立应用"><a href="#独立应用" class="headerlink" title="独立应用"></a>独立应用</h1>直接编写程序脚本，打成jar包，提交到spark集群执行。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* SimpleApp.scala */</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">SparkSession</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">SimpleApp</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]) &#123;</span><br><span class="line">    <span class="keyword">val</span> logFile = <span class="string">"YOUR_SPARK_HOME/README.md"</span> <span class="comment">// Should be some file on your system</span></span><br><span class="line">    <span class="keyword">val</span> spark = <span class="type">SparkSession</span>.builder.appName(<span class="string">"Simple Application"</span>).getOrCreate()</span><br><span class="line">    <span class="keyword">val</span> logData = spark.read.textFile(logFile).cache()</span><br><span class="line">    <span class="keyword">val</span> numAs = logData.filter(line =&gt; line.contains(<span class="string">"a"</span>)).count()</span><br><span class="line">    <span class="keyword">val</span> numBs = logData.filter(line =&gt; line.contains(<span class="string">"b"</span>)).count()</span><br><span class="line">    println(<span class="string">s"Lines with a: <span class="subst">$numAs</span>, Lines with b: <span class="subst">$numBs</span>"</span>)</span><br><span class="line">    spark.stop()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    <summary type="html">
    
      spark rdd编程是最基础的，本节从rdd编程实战讲解rdd的用法。
    
    </summary>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/categories/spark/"/>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>flink简介-快速入门</title>
    <link href="http://sparkx.com.cn/flink/flink-note/"/>
    <id>http://sparkx.com.cn/flink/flink-note/</id>
    <published>2019-12-11T01:27:00.000Z</published>
    <updated>2019-12-13T12:01:05.486Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Flink是什么"><a href="#Flink是什么" class="headerlink" title="Flink是什么"></a>Flink是什么</h1><p>Flink 是一个分布式大数据处理引擎，可对有限数据流和无限数据流进行有状态计算。可部署在各种集群环境，对各种大小的数据规模进行快速计算。Flink提供了诸多更高抽象层的API以便用户编写分布式任务：</p><table><thead><tr><th>API</th><th align="left">描述</th></tr></thead><tbody><tr><td>DataSet API</td><td align="left">对静态数据进行批处理操作，将静态数据抽象成分布式的数据集，用户可以方便地使用Flink提供的各种操作符对分布是数据集进行处理。</td></tr><tr><td>DataStream API</td><td align="left">对数据流进行流式处理操作，将流式的数据抽象成分布式的数据流，用户可以方便地对分布式数据流进行各种操作。</td></tr><tr><td>Table API</td><td align="left">对结构化数据进行查询操作，将结构化数据抽象成关系表，并通过类SQL的DSL对关系表进行各种查询操作。</td></tr></tbody></table><h1 id="Flink里的基础概念"><a href="#Flink里的基础概念" class="headerlink" title="Flink里的基础概念"></a>Flink里的基础概念</h1><table><thead><tr><th>名称</th><th align="left">描述</th></tr></thead><tbody><tr><td>Client</td><td align="left">提交任务给JobManager</td></tr><tr><td>JobManager</td><td align="left">分发任务给TaskManager</td></tr><tr><td>TaskManager</td><td align="left">会心跳会报任务状态</td></tr></tbody></table><h1 id="Flink流式处理特性"><a href="#Flink流式处理特性" class="headerlink" title="Flink流式处理特性"></a>Flink流式处理特性</h1><ul><li>支持高吞吐量、低延时、高性能的流式处理。</li><li>支持带有事件的时间窗口（Window）操作。</li><li>支持高度灵活的窗口（Window）操作，支持基于time、count、session以及data-driven的窗口操作。</li><li>支持具有Backpressure功能的持续流模型。</li><li>支持基于轻量级分布式快照（Snapshot）实现的容错和有状态计算的Exactly-once语义。</li><li>支持Batch on Streaming处理和realtime Streaming处理。</li></ul><h1 id="理解流式处理和批处理系统的差别"><a href="#理解流式处理和批处理系统的差别" class="headerlink" title="理解流式处理和批处理系统的差别"></a>理解流式处理和批处理系统的差别</h1><ul><li>流式处理：当一条数据被处理完成后，序列化到缓存中，然后立刻通过网络传输到下一个节点，由下一个节点继续处理。代表：Apache Storm、Apache Smaza。</li><li>批处理：当一条数据被处理完成后，序列化到缓存中，并不会立刻通过网络传输到下一个节点，当缓存写满，就持久化到本地硬盘上，当所有数据都被处理完成后，才开始将处理后的数据通过网络传输到下一个节点。代表：Apache Storm、Apache Smaza。Spark Streaming看似流式处理，其实是一种micro-batch架构。</li></ul><p>对于上述两种数据传输模式，Flink的执行引擎采用了一种十分灵活的方式支持这两种传输模型，Flink以固定的缓存块为单位进行网络数据传输，用户可以通过缓存块超时值指定缓存块的传输时机，如果缓存块超时值为0，则Flink的数据传输方式类似流式处理模型，此时可以获得最低处理延时。如果缓存块超时值为大于零的一个值(理论上无限大)，则Flink的数据传输方式类似批处理模型，此时系统可以获得最高的吞吐量。</p>]]></content>
    
    <summary type="html">
    
      对Flink最权威的解释是官方[点击进入官网](https://flink.apache.org/)文档，下面在个人理解基础上对Flink进行简单的介绍。
    
    </summary>
    
    
      <category term="flink" scheme="http://sparkx.com.cn/categories/flink/"/>
    
    
      <category term="flink" scheme="http://sparkx.com.cn/tags/flink/"/>
    
  </entry>
  
  <entry>
    <title>spark example 初体验</title>
    <link href="http://sparkx.com.cn/spark/spark-examples/"/>
    <id>http://sparkx.com.cn/spark/spark-examples/</id>
    <published>2019-12-09T15:13:44.000Z</published>
    <updated>2019-12-09T15:16:12.685Z</updated>
    
    <content type="html"><![CDATA[<p>下面在搭建的集群中运行spark自带的例子，体验一下spark独立集群管理器和采用Hadoop YARN管理器的不同。</p><h1 id="采用独立集群管理器"><a href="#采用独立集群管理器" class="headerlink" title="采用独立集群管理器"></a>采用独立集群管理器</h1><p>利用给的例子计算PI的值。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">root@master1:/usr/local/spark/spark-2.4.4-bin-hadoop2.6/bin#</span> <span class="string">spark-submit</span> <span class="string">--class</span> <span class="string">org.apache.spark.examples.SparkPi</span> <span class="string">--master</span> <span class="string">spark://master1:7077</span> <span class="string">../examples/jars/spark-examples_2.11-2.4.4.jar</span> <span class="number">100</span></span><br><span class="line"><span class="attr">19/12/09 22:50:38 WARN util.NativeCodeLoader:</span> <span class="string">Unable</span> <span class="string">to</span> <span class="string">load</span> <span class="string">native-hadoop</span> <span class="string">library</span> <span class="string">for</span> <span class="string">your</span> <span class="string">platform...</span> <span class="string">using</span> <span class="string">builtin-java</span> <span class="string">classes</span> <span class="string">where</span> <span class="string">applicable</span></span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO spark.SparkContext:</span> <span class="string">Running</span> <span class="string">Spark</span> <span class="string">version</span> <span class="number">2.4</span><span class="number">.4</span></span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO spark.SparkContext: Submitted application:</span> <span class="string">Spark</span> <span class="string">Pi</span></span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO spark.SecurityManager: Changing view acls to:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO spark.SecurityManager: Changing modify acls to:</span> <span class="string">root</span></span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO spark.SecurityManager: Changing view acls groups to:</span> </span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO spark.SecurityManager: Changing modify acls groups to:</span> </span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO spark.SecurityManager: SecurityManager:</span> <span class="string">authentication</span> <span class="string">disabled;</span> <span class="string">ui</span> <span class="string">acls</span> <span class="string">disabled;</span> <span class="attr">users  with view permissions:</span> <span class="string">Set(root);</span> <span class="attr">groups with view permissions:</span> <span class="string">Set();</span> <span class="attr">users  with modify permissions:</span> <span class="string">Set(root);</span> <span class="attr">groups with modify permissions:</span> <span class="string">Set()</span></span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO util.Utils:</span> <span class="string">Successfully</span> <span class="string">started</span> <span class="string">service</span> <span class="string">'sparkDriver'</span> <span class="string">on</span> <span class="string">port</span> <span class="number">44644</span><span class="string">.</span></span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO spark.SparkEnv:</span> <span class="string">Registering</span> <span class="string">MapOutputTracker</span></span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO spark.SparkEnv:</span> <span class="string">Registering</span> <span class="string">BlockManagerMaster</span></span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO storage.BlockManagerMasterEndpoint:</span> <span class="string">Using</span> <span class="string">org.apache.spark.storage.DefaultTopologyMapper</span> <span class="string">for</span> <span class="string">getting</span> <span class="string">topology</span> <span class="string">information</span></span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO storage.BlockManagerMasterEndpoint:</span> <span class="string">BlockManagerMasterEndpoint</span> <span class="string">up</span></span><br><span class="line"><span class="attr">19/12/09 22:50:39 INFO storage.DiskBlockManager:</span> <span class="string">Created</span> <span class="string">local</span> <span class="string">directory</span> <span class="string">at</span> <span class="string">/tmp/blockmgr-ccafdfa2-6ca1-45c8-95b0-51b36272cde7</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO memory.MemoryStore:</span> <span class="string">MemoryStore</span> <span class="string">started</span> <span class="string">with</span> <span class="string">capacity</span> <span class="number">413.9</span> <span class="string">MB</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO spark.SparkEnv:</span> <span class="string">Registering</span> <span class="string">OutputCommitCoordinator</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO util.log:</span> <span class="string">Logging</span> <span class="string">initialized</span> <span class="string">@3244ms</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO server.Server:</span> <span class="string">jetty-9.3.z-SNAPSHOT,</span> <span class="attr">build timestamp:</span> <span class="string">unknown,</span> <span class="attr">git hash:</span> <span class="string">unknown</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO server.Server:</span> <span class="string">Started</span> <span class="string">@3490ms</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO server.AbstractConnector:</span> <span class="string">Started</span> <span class="string">ServerConnector@4e4f58b8&#123;HTTP/1.1,[http/1.1]&#125;&#123;0.0.0.0:4040&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO util.Utils:</span> <span class="string">Successfully</span> <span class="string">started</span> <span class="string">service</span> <span class="string">'SparkUI'</span> <span class="string">on</span> <span class="string">port</span> <span class="number">4040</span><span class="string">.</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@70f43b45&#123;/jobs,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@41de5768&#123;/jobs/json,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@5f577419&#123;/jobs/job,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@3d526ad9&#123;/jobs/job/json,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@e041f0c&#123;/stages,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@6a175569&#123;/stages/json,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@11963225&#123;/stages/stage,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@4102b1b1&#123;/stages/stage/json,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@61a5b4ae&#123;/stages/pool,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@3a71c100&#123;/stages/pool/json,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@5b69fd74&#123;/storage,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@f325091&#123;/storage/json,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@437e951d&#123;/storage/rdd,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@77b325b3&#123;/storage/rdd/json,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@63a5e46c&#123;/environment,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@7e8e8651&#123;/environment/json,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@49ef32e0&#123;/executors,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@271f18d3&#123;/executors/json,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@6bd51ed8&#123;/executors/threadDump,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@61e3a1fd&#123;/executors/threadDump/json,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@51abf713&#123;/static,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@3be8821f&#123;/,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@64b31700&#123;/api,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@85ec632&#123;/jobs/job/kill,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@1c05a54d&#123;/stages/stage/kill,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO ui.SparkUI:</span> <span class="string">Bound</span> <span class="string">SparkUI</span> <span class="string">to</span> <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span><span class="string">,</span> <span class="string">and</span> <span class="string">started</span> <span class="string">at</span> <span class="string">http://master1:4040</span></span><br><span class="line"><span class="attr">19/12/09 22:50:40 INFO spark.SparkContext:</span> <span class="string">Added</span> <span class="string">JAR</span> <span class="string">file:/usr/local/spark/spark-2.4.4-bin-hadoop2.6/bin/../examples/jars/spark-examples_2.11-2.4.4.jar</span> <span class="string">at</span> <span class="string">spark://master1:44644/jars/spark-examples_2.11-2.4.4.jar</span> <span class="string">with</span> <span class="string">timestamp</span> <span class="number">1575903040745</span></span><br><span class="line"><span class="number">19</span><span class="string">/12/09</span> <span class="number">22</span><span class="string">:50:41</span> <span class="string">INFO</span> <span class="string">client.StandaloneAppClient$ClientEndpoint:</span> <span class="string">Connecting</span> <span class="string">to</span> <span class="string">master</span> <span class="string">spark://master1:7077...</span></span><br><span class="line"><span class="attr">19/12/09 22:50:41 INFO client.TransportClientFactory:</span> <span class="string">Successfully</span> <span class="string">created</span> <span class="string">connection</span> <span class="string">to</span> <span class="string">master1/192.168.112.120:7077</span> <span class="string">after</span> <span class="number">171</span> <span class="string">ms</span> <span class="string">(0</span> <span class="string">ms</span> <span class="string">spent</span> <span class="string">in</span> <span class="string">bootstraps)</span></span><br><span class="line"><span class="attr">19/12/09 22:50:41 INFO cluster.StandaloneSchedulerBackend:</span> <span class="string">Connected</span> <span class="string">to</span> <span class="string">Spark</span> <span class="string">cluster</span> <span class="string">with</span> <span class="string">app</span> <span class="string">ID</span> <span class="string">app-20191209225041-0000</span></span><br><span class="line"><span class="attr">19/12/09 22:50:41 INFO util.Utils:</span> <span class="string">Successfully</span> <span class="string">started</span> <span class="string">service</span> <span class="string">'org.apache.spark.network.netty.NettyBlockTransferService'</span> <span class="string">on</span> <span class="string">port</span> <span class="number">44526</span><span class="string">.</span></span><br><span class="line"><span class="attr">19/12/09 22:50:41 INFO netty.NettyBlockTransferService:</span> <span class="string">Server</span> <span class="string">created</span> <span class="string">on</span> <span class="string">master1:44526</span></span><br><span class="line"><span class="attr">19/12/09 22:50:41 INFO storage.BlockManager:</span> <span class="string">Using</span> <span class="string">org.apache.spark.storage.RandomBlockReplicationPolicy</span> <span class="string">for</span> <span class="string">block</span> <span class="string">replication</span> <span class="string">policy</span></span><br><span class="line"><span class="number">19</span><span class="string">/12/09</span> <span class="number">22</span><span class="string">:50:41</span> <span class="string">INFO</span> <span class="string">client.StandaloneAppClient$ClientEndpoint:</span> <span class="attr">Executor added:</span> <span class="string">app-20191209225041-0000/0</span> <span class="string">on</span> <span class="string">worker-20191209224928-192.168.112.122-40527</span> <span class="string">(192.168.112.122:40527)</span> <span class="string">with</span> <span class="number">1</span> <span class="string">core(s)</span></span><br><span class="line"><span class="attr">19/12/09 22:50:41 INFO cluster.StandaloneSchedulerBackend:</span> <span class="string">Granted</span> <span class="string">executor</span> <span class="string">ID</span> <span class="string">app-20191209225041-0000/0</span> <span class="string">on</span> <span class="string">hostPort</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">:40527</span> <span class="string">with</span> <span class="number">1</span> <span class="string">core(s),</span> <span class="number">600.0</span> <span class="string">MB</span> <span class="string">RAM</span></span><br><span class="line"><span class="number">19</span><span class="string">/12/09</span> <span class="number">22</span><span class="string">:50:41</span> <span class="string">INFO</span> <span class="string">client.StandaloneAppClient$ClientEndpoint:</span> <span class="attr">Executor added:</span> <span class="string">app-20191209225041-0000/1</span> <span class="string">on</span> <span class="string">worker-20191209224934-192.168.112.121-39568</span> <span class="string">(192.168.112.121:39568)</span> <span class="string">with</span> <span class="number">1</span> <span class="string">core(s)</span></span><br><span class="line"><span class="attr">19/12/09 22:50:41 INFO cluster.StandaloneSchedulerBackend:</span> <span class="string">Granted</span> <span class="string">executor</span> <span class="string">ID</span> <span class="string">app-20191209225041-0000/1</span> <span class="string">on</span> <span class="string">hostPort</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">:39568</span> <span class="string">with</span> <span class="number">1</span> <span class="string">core(s),</span> <span class="number">600.0</span> <span class="string">MB</span> <span class="string">RAM</span></span><br><span class="line"><span class="attr">19/12/09 22:50:42 INFO storage.BlockManagerMaster:</span> <span class="string">Registering</span> <span class="string">BlockManager</span> <span class="string">BlockManagerId(driver,</span> <span class="string">master1,</span> <span class="number">44526</span><span class="string">,</span> <span class="string">None)</span></span><br><span class="line"><span class="attr">19/12/09 22:50:42 INFO storage.BlockManagerMasterEndpoint:</span> <span class="string">Registering</span> <span class="string">block</span> <span class="string">manager</span> <span class="string">master1:44526</span> <span class="string">with</span> <span class="number">413.9</span> <span class="string">MB</span> <span class="string">RAM,</span> <span class="string">BlockManagerId(driver,</span> <span class="string">master1,</span> <span class="number">44526</span><span class="string">,</span> <span class="string">None)</span></span><br><span class="line"><span class="attr">19/12/09 22:50:42 INFO storage.BlockManagerMaster:</span> <span class="string">Registered</span> <span class="string">BlockManager</span> <span class="string">BlockManagerId(driver,</span> <span class="string">master1,</span> <span class="number">44526</span><span class="string">,</span> <span class="string">None)</span></span><br><span class="line"><span class="attr">19/12/09 22:50:42 INFO storage.BlockManager: Initialized BlockManager:</span> <span class="string">BlockManagerId(driver,</span> <span class="string">master1,</span> <span class="number">44526</span><span class="string">,</span> <span class="string">None)</span></span><br><span class="line"><span class="number">19</span><span class="string">/12/09</span> <span class="number">22</span><span class="string">:50:42</span> <span class="string">INFO</span> <span class="string">client.StandaloneAppClient$ClientEndpoint:</span> <span class="attr">Executor updated:</span> <span class="string">app-20191209225041-0000/0</span> <span class="string">is</span> <span class="string">now</span> <span class="string">RUNNING</span></span><br><span class="line"><span class="number">19</span><span class="string">/12/09</span> <span class="number">22</span><span class="string">:50:42</span> <span class="string">INFO</span> <span class="string">client.StandaloneAppClient$ClientEndpoint:</span> <span class="attr">Executor updated:</span> <span class="string">app-20191209225041-0000/1</span> <span class="string">is</span> <span class="string">now</span> <span class="string">RUNNING</span></span><br><span class="line"><span class="attr">19/12/09 22:51:00 INFO handler.ContextHandler:</span> <span class="string">Started</span> <span class="string">o.s.j.s.ServletContextHandler@37095ded&#123;/metrics/json,null,AVAILABLE,@Spark&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:51:00 INFO cluster.StandaloneSchedulerBackend: SchedulerBackend is ready for scheduling beginning after reached minRegisteredResourcesRatio:</span> <span class="number">0.0</span></span><br><span class="line"><span class="attr">19/12/09 22:51:10 INFO spark.SparkContext: Starting job:</span> <span class="string">reduce</span> <span class="string">at</span> <span class="string">SparkPi.scala:38</span></span><br><span class="line"><span class="attr">19/12/09 22:51:10 INFO scheduler.DAGScheduler:</span> <span class="string">Got</span> <span class="string">job</span> <span class="number">0</span> <span class="string">(reduce</span> <span class="string">at</span> <span class="string">SparkPi.scala:38)</span> <span class="string">with</span> <span class="number">100</span> <span class="string">output</span> <span class="string">partitions</span></span><br><span class="line"><span class="attr">19/12/09 22:51:10 INFO scheduler.DAGScheduler: Final stage:</span> <span class="string">ResultStage</span> <span class="number">0</span> <span class="string">(reduce</span> <span class="string">at</span> <span class="string">SparkPi.scala:38)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:10 INFO scheduler.DAGScheduler: Parents of final stage:</span> <span class="string">List()</span></span><br><span class="line"><span class="attr">19/12/09 22:51:10 INFO scheduler.DAGScheduler: Missing parents:</span> <span class="string">List()</span></span><br><span class="line"><span class="attr">19/12/09 22:51:10 INFO scheduler.DAGScheduler:</span> <span class="string">Submitting</span> <span class="string">ResultStage</span> <span class="number">0</span> <span class="string">(MapPartitionsRDD[1]</span> <span class="string">at</span> <span class="string">map</span> <span class="string">at</span> <span class="string">SparkPi.scala:34),</span> <span class="string">which</span> <span class="string">has</span> <span class="literal">no</span> <span class="string">missing</span> <span class="string">parents</span></span><br><span class="line"><span class="attr">19/12/09 22:51:11 INFO memory.MemoryStore:</span> <span class="string">Block</span> <span class="string">broadcast_0</span> <span class="string">stored</span> <span class="string">as</span> <span class="string">values</span> <span class="string">in</span> <span class="string">memory</span> <span class="string">(estimated</span> <span class="string">size</span> <span class="number">1936.0</span> <span class="string">B,</span> <span class="string">free</span> <span class="number">413.9</span> <span class="string">MB)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:13 INFO memory.MemoryStore:</span> <span class="string">Block</span> <span class="string">broadcast_0_piece0</span> <span class="string">stored</span> <span class="string">as</span> <span class="string">bytes</span> <span class="string">in</span> <span class="string">memory</span> <span class="string">(estimated</span> <span class="string">size</span> <span class="number">1256.0</span> <span class="string">B,</span> <span class="string">free</span> <span class="number">413.9</span> <span class="string">MB)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:13 INFO storage.BlockManagerInfo:</span> <span class="string">Added</span> <span class="string">broadcast_0_piece0</span> <span class="string">in</span> <span class="string">memory</span> <span class="string">on</span> <span class="string">master1:44526</span> <span class="string">(size:</span> <span class="number">1256.0</span> <span class="string">B,</span> <span class="attr">free:</span> <span class="number">413.9</span> <span class="string">MB)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:13 INFO spark.SparkContext:</span> <span class="string">Created</span> <span class="string">broadcast</span> <span class="number">0</span> <span class="string">from</span> <span class="string">broadcast</span> <span class="string">at</span> <span class="string">DAGScheduler.scala:1161</span></span><br><span class="line"><span class="attr">19/12/09 22:51:13 INFO scheduler.DAGScheduler:</span> <span class="string">Submitting</span> <span class="number">100</span> <span class="string">missing</span> <span class="string">tasks</span> <span class="string">from</span> <span class="string">ResultStage</span> <span class="number">0</span> <span class="string">(MapPartitionsRDD[1]</span> <span class="string">at</span> <span class="string">map</span> <span class="string">at</span> <span class="string">SparkPi.scala:34)</span> <span class="string">(first</span> <span class="number">15</span> <span class="string">tasks</span> <span class="string">are</span> <span class="string">for</span> <span class="string">partitions</span> <span class="string">Vector(0,</span> <span class="number">1</span><span class="string">,</span> <span class="number">2</span><span class="string">,</span> <span class="number">3</span><span class="string">,</span> <span class="number">4</span><span class="string">,</span> <span class="number">5</span><span class="string">,</span> <span class="number">6</span><span class="string">,</span> <span class="number">7</span><span class="string">,</span> <span class="number">8</span><span class="string">,</span> <span class="number">9</span><span class="string">,</span> <span class="number">10</span><span class="string">,</span> <span class="number">11</span><span class="string">,</span> <span class="number">12</span><span class="string">,</span> <span class="number">13</span><span class="string">,</span> <span class="number">14</span><span class="string">))</span></span><br><span class="line"><span class="attr">19/12/09 22:51:13 INFO scheduler.TaskSchedulerImpl:</span> <span class="string">Adding</span> <span class="string">task</span> <span class="string">set</span> <span class="number">0.0</span> <span class="string">with</span> <span class="number">100</span> <span class="string">tasks</span></span><br><span class="line"><span class="attr">19/12/09 22:51:28 WARN scheduler.TaskSchedulerImpl:</span> <span class="string">Initial</span> <span class="string">job</span> <span class="string">has</span> <span class="string">not</span> <span class="string">accepted</span> <span class="string">any</span> <span class="string">resources;</span> <span class="string">check</span> <span class="string">your</span> <span class="string">cluster</span> <span class="string">UI</span> <span class="string">to</span> <span class="string">ensure</span> <span class="string">that</span> <span class="string">workers</span> <span class="string">are</span> <span class="string">registered</span> <span class="string">and</span> <span class="string">have</span> <span class="string">sufficient</span> <span class="string">resources</span></span><br><span class="line"><span class="number">19</span><span class="string">/12/09</span> <span class="number">22</span><span class="string">:51:33</span> <span class="string">INFO</span> <span class="string">cluster.CoarseGrainedSchedulerBackend$DriverEndpoint:</span> <span class="string">Registered</span> <span class="string">executor</span> <span class="string">NettyRpcEndpointRef(spark-client://Executor)</span> <span class="string">(192.168.112.122:35134)</span> <span class="string">with</span> <span class="string">ID</span> <span class="number">0</span></span><br><span class="line"><span class="attr">19/12/09 22:51:33 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">0.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">0</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">0</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:35 INFO storage.BlockManagerMasterEndpoint:</span> <span class="string">Registering</span> <span class="string">block</span> <span class="string">manager</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">:44039</span> <span class="string">with</span> <span class="number">168.0</span> <span class="string">MB</span> <span class="string">RAM,</span> <span class="string">BlockManagerId(0,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="number">44039</span><span class="string">,</span> <span class="string">None)</span></span><br><span class="line"><span class="number">19</span><span class="string">/12/09</span> <span class="number">22</span><span class="string">:51:36</span> <span class="string">INFO</span> <span class="string">cluster.CoarseGrainedSchedulerBackend$DriverEndpoint:</span> <span class="string">Registered</span> <span class="string">executor</span> <span class="string">NettyRpcEndpointRef(spark-client://Executor)</span> <span class="string">(192.168.112.121:58772)</span> <span class="string">with</span> <span class="string">ID</span> <span class="number">1</span></span><br><span class="line"><span class="attr">19/12/09 22:51:36 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">1.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">1</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">1</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:40 INFO storage.BlockManagerMasterEndpoint:</span> <span class="string">Registering</span> <span class="string">block</span> <span class="string">manager</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">:41833</span> <span class="string">with</span> <span class="number">168.0</span> <span class="string">MB</span> <span class="string">RAM,</span> <span class="string">BlockManagerId(1,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="number">41833</span><span class="string">,</span> <span class="string">None)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:51 INFO storage.BlockManagerInfo:</span> <span class="string">Added</span> <span class="string">broadcast_0_piece0</span> <span class="string">in</span> <span class="string">memory</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">:44039</span> <span class="string">(size:</span> <span class="number">1256.0</span> <span class="string">B,</span> <span class="attr">free:</span> <span class="number">168.0</span> <span class="string">MB)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:53 INFO storage.BlockManagerInfo:</span> <span class="string">Added</span> <span class="string">broadcast_0_piece0</span> <span class="string">in</span> <span class="string">memory</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">:41833</span> <span class="string">(size:</span> <span class="number">1256.0</span> <span class="string">B,</span> <span class="attr">free:</span> <span class="number">168.0</span> <span class="string">MB)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:54 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">2.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">2</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">2</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:54 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">0.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">0</span><span class="string">)</span> <span class="string">in</span> <span class="number">20773</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(1/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:54 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">3.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">3</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">3</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:54 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">2.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">2</span><span class="string">)</span> <span class="string">in</span> <span class="number">606</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(2/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:55 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">4.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">4</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">4</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:55 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">3.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">3</span><span class="string">)</span> <span class="string">in</span> <span class="number">481</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(3/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">5.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">5</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">5</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">4.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">4</span><span class="string">)</span> <span class="string">in</span> <span class="number">760</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(4/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">6.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">6</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">6</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">1.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">1</span><span class="string">)</span> <span class="string">in</span> <span class="number">20403</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(5/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">7.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">7</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">7</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">6.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">6</span><span class="string">)</span> <span class="string">in</span> <span class="number">45</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(6/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">8.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">8</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">8</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">7.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">7</span><span class="string">)</span> <span class="string">in</span> <span class="number">38</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(7/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">9.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">9</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">9</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">8.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">8</span><span class="string">)</span> <span class="string">in</span> <span class="number">64</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(8/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">10.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">10</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">10</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:56 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">9.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">9</span><span class="string">)</span> <span class="string">in</span> <span class="number">31</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(9/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">11.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">11</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">11</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">10.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">10</span><span class="string">)</span> <span class="string">in</span> <span class="number">190</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(10/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">12.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">12</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">12</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">5.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">5</span><span class="string">)</span> <span class="string">in</span> <span class="number">1140</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(11/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">13.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">13</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">13</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">12.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">12</span><span class="string">)</span> <span class="string">in</span> <span class="number">30</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(12/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">14.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">14</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">14</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">13.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">13</span><span class="string">)</span> <span class="string">in</span> <span class="number">26</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(13/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">15.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">15</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">15</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">14.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">14</span><span class="string">)</span> <span class="string">in</span> <span class="number">49</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(14/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">16.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">16</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">16</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">11.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">11</span><span class="string">)</span> <span class="string">in</span> <span class="number">289</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(15/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">17.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">17</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">17</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">15.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">15</span><span class="string">)</span> <span class="string">in</span> <span class="number">36</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(16/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">18.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">18</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">18</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">17.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">17</span><span class="string">)</span> <span class="string">in</span> <span class="number">28</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(17/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">19.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">19</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">19</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">18.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">18</span><span class="string">)</span> <span class="string">in</span> <span class="number">25</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(18/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">20.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">20</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">20</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">19.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">19</span><span class="string">)</span> <span class="string">in</span> <span class="number">49</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(19/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">21.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">21</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">21</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">20.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">20</span><span class="string">)</span> <span class="string">in</span> <span class="number">46</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(20/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">22.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">22</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">22</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">21.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">21</span><span class="string">)</span> <span class="string">in</span> <span class="number">33</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(21/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">22.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">22</span><span class="string">)</span> <span class="string">in</span> <span class="number">30</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(22/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">23.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">23</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">23</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">24.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">24</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">24</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">23.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">23</span><span class="string">)</span> <span class="string">in</span> <span class="number">35</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(23/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">25.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">25</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">25</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">24.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">24</span><span class="string">)</span> <span class="string">in</span> <span class="number">40</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(24/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">26.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">26</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">26</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">25.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">25</span><span class="string">)</span> <span class="string">in</span> <span class="number">31</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(25/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">27.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">27</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">27</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">26.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">26</span><span class="string">)</span> <span class="string">in</span> <span class="number">91</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(26/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">28.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">28</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">28</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">27.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">27</span><span class="string">)</span> <span class="string">in</span> <span class="number">36</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(27/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">29.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">29</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">29</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">28.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">28</span><span class="string">)</span> <span class="string">in</span> <span class="number">29</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(28/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">30.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">30</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">30</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">29.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">29</span><span class="string">)</span> <span class="string">in</span> <span class="number">26</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(29/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">31.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">31</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">31</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">30.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">30</span><span class="string">)</span> <span class="string">in</span> <span class="number">34</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(30/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">32.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">32</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">32</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">31.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">31</span><span class="string">)</span> <span class="string">in</span> <span class="number">25</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(31/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">33.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">33</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">33</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">32.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">32</span><span class="string">)</span> <span class="string">in</span> <span class="number">20</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(32/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">34.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">34</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">34</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">33.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">33</span><span class="string">)</span> <span class="string">in</span> <span class="number">31</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(33/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">35.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">35</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">35</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">34.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">34</span><span class="string">)</span> <span class="string">in</span> <span class="number">21</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(34/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">36.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">36</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">36</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">35.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">35</span><span class="string">)</span> <span class="string">in</span> <span class="number">18</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(35/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">37.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">37</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">37</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">36.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">36</span><span class="string">)</span> <span class="string">in</span> <span class="number">27</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(36/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">38.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">38</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">38</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">37.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">37</span><span class="string">)</span> <span class="string">in</span> <span class="number">25</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(37/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">39.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">39</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">39</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:57 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">38.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">38</span><span class="string">)</span> <span class="string">in</span> <span class="number">19</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(38/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">40.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">40</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">40</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">39.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">39</span><span class="string">)</span> <span class="string">in</span> <span class="number">19</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(39/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">41.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">41</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">41</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">40.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">40</span><span class="string">)</span> <span class="string">in</span> <span class="number">29</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(40/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">42.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">42</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">42</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">16.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">16</span><span class="string">)</span> <span class="string">in</span> <span class="number">732</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(41/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">43.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">43</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">43</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">41.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">41</span><span class="string">)</span> <span class="string">in</span> <span class="number">24</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(42/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">44.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">44</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">44</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">43.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">43</span><span class="string">)</span> <span class="string">in</span> <span class="number">17</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(43/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">45.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">45</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">45</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">44.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">44</span><span class="string">)</span> <span class="string">in</span> <span class="number">18</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(44/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">46.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">46</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">46</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">45.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">45</span><span class="string">)</span> <span class="string">in</span> <span class="number">16</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(45/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">47.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">47</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">47</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">46.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">46</span><span class="string">)</span> <span class="string">in</span> <span class="number">15</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(46/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">48.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">48</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">48</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">47.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">47</span><span class="string">)</span> <span class="string">in</span> <span class="number">14</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(47/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">49.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">49</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">49</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">48.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">48</span><span class="string">)</span> <span class="string">in</span> <span class="number">30</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(48/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">50.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">50</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">50</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">49.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">49</span><span class="string">)</span> <span class="string">in</span> <span class="number">22</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(49/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">51.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">51</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">51</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">50.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">50</span><span class="string">)</span> <span class="string">in</span> <span class="number">33</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(50/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">52.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">52</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">52</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">51.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">51</span><span class="string">)</span> <span class="string">in</span> <span class="number">40</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(51/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">53.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">53</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">53</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">52.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">52</span><span class="string">)</span> <span class="string">in</span> <span class="number">36</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(52/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">54.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">54</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">54</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">53.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">53</span><span class="string">)</span> <span class="string">in</span> <span class="number">21</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(53/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">55.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">55</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">55</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">54.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">54</span><span class="string">)</span> <span class="string">in</span> <span class="number">23</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(54/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">56.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">56</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">56</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">42.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">42</span><span class="string">)</span> <span class="string">in</span> <span class="number">274</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(55/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">57.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">57</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">57</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">55.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">55</span><span class="string">)</span> <span class="string">in</span> <span class="number">24</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(56/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">58.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">58</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">58</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">57.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">57</span><span class="string">)</span> <span class="string">in</span> <span class="number">27</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(57/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">59.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">59</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">59</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">58.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">58</span><span class="string">)</span> <span class="string">in</span> <span class="number">24</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(58/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">60.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">60</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">60</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">59.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">59</span><span class="string">)</span> <span class="string">in</span> <span class="number">22</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(59/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">61.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">61</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">61</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">60.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">60</span><span class="string">)</span> <span class="string">in</span> <span class="number">33</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(60/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">62.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">62</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">62</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">61.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">61</span><span class="string">)</span> <span class="string">in</span> <span class="number">43</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(61/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">56.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">56</span><span class="string">)</span> <span class="string">in</span> <span class="number">151</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(62/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">63.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">63</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">63</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">62.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">62</span><span class="string">)</span> <span class="string">in</span> <span class="number">56</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(63/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">64.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">64</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">64</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">65.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">65</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">65</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">64.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">64</span><span class="string">)</span> <span class="string">in</span> <span class="number">36</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(64/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">66.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">66</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">66</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">65.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">65</span><span class="string">)</span> <span class="string">in</span> <span class="number">66</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(65/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">67.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">67</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">67</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">66.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">66</span><span class="string">)</span> <span class="string">in</span> <span class="number">69</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(66/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">68.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">68</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">68</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">67.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">67</span><span class="string">)</span> <span class="string">in</span> <span class="number">23</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(67/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">69.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">69</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">69</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">68.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">68</span><span class="string">)</span> <span class="string">in</span> <span class="number">25</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(68/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">70.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">70</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">70</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">69.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">69</span><span class="string">)</span> <span class="string">in</span> <span class="number">30</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(69/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">71.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">71</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">71</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">63.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">63</span><span class="string">)</span> <span class="string">in</span> <span class="number">246</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(70/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">72.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">72</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">72</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">70.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">70</span><span class="string">)</span> <span class="string">in</span> <span class="number">27</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(71/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">73.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">73</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">73</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">72.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">72</span><span class="string">)</span> <span class="string">in</span> <span class="number">30</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(72/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">74.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">74</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">74</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">73.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">73</span><span class="string">)</span> <span class="string">in</span> <span class="number">26</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(73/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">75.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">75</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">75</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">74.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">74</span><span class="string">)</span> <span class="string">in</span> <span class="number">28</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(74/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">76.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">76</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">76</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">75.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">75</span><span class="string">)</span> <span class="string">in</span> <span class="number">28</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(75/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">77.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">77</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">77</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">76.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">76</span><span class="string">)</span> <span class="string">in</span> <span class="number">20</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(76/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">78.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">78</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">78</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">77.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">77</span><span class="string">)</span> <span class="string">in</span> <span class="number">22</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(77/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">79.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">79</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">79</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">71.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">71</span><span class="string">)</span> <span class="string">in</span> <span class="number">167</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(78/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">80.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">80</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">80</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">79.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">79</span><span class="string">)</span> <span class="string">in</span> <span class="number">27</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(79/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">81.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">81</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">81</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">78.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">78</span><span class="string">)</span> <span class="string">in</span> <span class="number">62</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(80/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">80.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">80</span><span class="string">)</span> <span class="string">in</span> <span class="number">30</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(81/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">82.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">82</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">82</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">83.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">83</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">83</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">81.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">81</span><span class="string">)</span> <span class="string">in</span> <span class="number">26</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(82/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">84.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">84</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">84</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:58 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">82.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">82</span><span class="string">)</span> <span class="string">in</span> <span class="number">31</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(83/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">85.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">85</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">85</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">83.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">83</span><span class="string">)</span> <span class="string">in</span> <span class="number">27</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(84/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">86.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">86</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">86</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">84.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">84</span><span class="string">)</span> <span class="string">in</span> <span class="number">40</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(85/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">85.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">85</span><span class="string">)</span> <span class="string">in</span> <span class="number">27</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(86/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">87.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">87</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">87</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">88.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">88</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">88</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">87.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">87</span><span class="string">)</span> <span class="string">in</span> <span class="number">23</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(87/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">89.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">89</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">89</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">86.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">86</span><span class="string">)</span> <span class="string">in</span> <span class="number">32</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(88/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">90.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">90</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">90</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">91.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">91</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">91</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">89.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">89</span><span class="string">)</span> <span class="string">in</span> <span class="number">211</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(89/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">88.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">88</span><span class="string">)</span> <span class="string">in</span> <span class="number">215</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(90/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">92.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">92</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">92</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">91.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">91</span><span class="string">)</span> <span class="string">in</span> <span class="number">23</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(91/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">93.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">93</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">93</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">90.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">90</span><span class="string">)</span> <span class="string">in</span> <span class="number">203</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(92/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">94.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">94</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">94</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">92.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">92</span><span class="string">)</span> <span class="string">in</span> <span class="number">25</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(93/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">95.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">95</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">95</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">93.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">93</span><span class="string">)</span> <span class="string">in</span> <span class="number">24</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(94/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">96.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">96</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">96</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">94.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">94</span><span class="string">)</span> <span class="string">in</span> <span class="number">26</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(95/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">97.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">97</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">97</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">96.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">96</span><span class="string">)</span> <span class="string">in</span> <span class="number">19</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(96/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">98.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">98</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span><span class="string">,</span> <span class="string">executor</span> <span class="number">0</span><span class="string">,</span> <span class="string">partition</span> <span class="number">98</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">95.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">95</span><span class="string">)</span> <span class="string">in</span> <span class="number">39</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(97/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Starting</span> <span class="string">task</span> <span class="number">99.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">99</span><span class="string">,</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span><span class="string">,</span> <span class="string">executor</span> <span class="number">1</span><span class="string">,</span> <span class="string">partition</span> <span class="number">99</span><span class="string">,</span> <span class="string">PROCESS_LOCAL,</span> <span class="number">7870</span> <span class="string">bytes)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">97.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">97</span><span class="string">)</span> <span class="string">in</span> <span class="number">23</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(98/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">98.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">98</span><span class="string">)</span> <span class="string">in</span> <span class="number">31</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.122</span> <span class="string">(executor</span> <span class="number">0</span><span class="string">)</span> <span class="string">(99/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSetManager:</span> <span class="string">Finished</span> <span class="string">task</span> <span class="number">99.0</span> <span class="string">in</span> <span class="string">stage</span> <span class="number">0.0</span> <span class="string">(TID</span> <span class="number">99</span><span class="string">)</span> <span class="string">in</span> <span class="number">20</span> <span class="string">ms</span> <span class="string">on</span> <span class="number">192.168</span><span class="number">.112</span><span class="number">.121</span> <span class="string">(executor</span> <span class="number">1</span><span class="string">)</span> <span class="string">(100/100)</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.TaskSchedulerImpl:</span> <span class="string">Removed</span> <span class="string">TaskSet</span> <span class="number">0.0</span><span class="string">,</span> <span class="string">whose</span> <span class="string">tasks</span> <span class="string">have</span> <span class="string">all</span> <span class="string">completed,</span> <span class="string">from</span> <span class="string">pool</span> </span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.DAGScheduler:</span> <span class="string">ResultStage</span> <span class="number">0</span> <span class="string">(reduce</span> <span class="string">at</span> <span class="string">SparkPi.scala:38)</span> <span class="string">finished</span> <span class="string">in</span> <span class="number">48.587</span> <span class="string">s</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO scheduler.DAGScheduler: Job 0 finished:</span> <span class="string">reduce</span> <span class="string">at</span> <span class="string">SparkPi.scala:38,</span> <span class="string">took</span> <span class="number">49.130196</span> <span class="string">s</span></span><br><span class="line"><span class="string">Pi</span> <span class="string">is</span> <span class="string">roughly</span> <span class="number">3.1412139141213915</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO server.AbstractConnector:</span> <span class="string">Stopped</span> <span class="string">Spark@4e4f58b8&#123;HTTP/1.1,[http/1.1]&#125;&#123;0.0.0.0:4040&#125;</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO ui.SparkUI:</span> <span class="string">Stopped</span> <span class="string">Spark</span> <span class="string">web</span> <span class="string">UI</span> <span class="string">at</span> <span class="string">http://master1:4040</span></span><br><span class="line"><span class="attr">19/12/09 22:51:59 INFO cluster.StandaloneSchedulerBackend:</span> <span class="string">Shutting</span> <span class="string">down</span> <span class="string">all</span> <span class="string">executors</span></span><br><span class="line"><span class="number">19</span><span class="string">/12/09</span> <span class="number">22</span><span class="string">:51:59</span> <span class="string">INFO</span> <span class="string">cluster.CoarseGrainedSchedulerBackend$DriverEndpoint:</span> <span class="string">Asking</span> <span class="string">each</span> <span class="string">executor</span> <span class="string">to</span> <span class="string">shut</span> <span class="string">down</span></span><br><span class="line"><span class="attr">19/12/09 22:52:00 INFO spark.MapOutputTrackerMasterEndpoint:</span> <span class="string">MapOutputTrackerMasterEndpoint</span> <span class="string">stopped!</span></span><br><span class="line"><span class="attr">19/12/09 22:52:00 INFO memory.MemoryStore:</span> <span class="string">MemoryStore</span> <span class="string">cleared</span></span><br><span class="line"><span class="attr">19/12/09 22:52:00 INFO storage.BlockManager:</span> <span class="string">BlockManager</span> <span class="string">stopped</span></span><br><span class="line"><span class="attr">19/12/09 22:52:00 INFO storage.BlockManagerMaster:</span> <span class="string">BlockManagerMaster</span> <span class="string">stopped</span></span><br><span class="line"><span class="number">19</span><span class="string">/12/09</span> <span class="number">22</span><span class="string">:52:00</span> <span class="string">INFO</span> <span class="string">scheduler.OutputCommitCoordinator$OutputCommitCoordinatorEndpoint:</span> <span class="string">OutputCommitCoordinator</span> <span class="string">stopped!</span></span><br><span class="line"><span class="attr">19/12/09 22:52:00 INFO spark.SparkContext:</span> <span class="string">Successfully</span> <span class="string">stopped</span> <span class="string">SparkContext</span></span><br><span class="line"><span class="attr">19/12/09 22:52:00 INFO util.ShutdownHookManager:</span> <span class="string">Shutdown</span> <span class="string">hook</span> <span class="string">called</span></span><br><span class="line"><span class="attr">19/12/09 22:52:00 INFO util.ShutdownHookManager:</span> <span class="string">Deleting</span> <span class="string">directory</span> <span class="string">/tmp/spark-f26e5cea-4f00-4647-af4d-dab993ca947c</span></span><br><span class="line"><span class="attr">19/12/09 22:52:00 INFO util.ShutdownHookManager:</span> <span class="string">Deleting</span> <span class="string">directory</span> <span class="string">/tmp/spark-c61eaf6a-be22-463a-9578-bb479e91105e</span></span><br></pre></td></tr></table></figure><p><img src="/images/spark/spark_pi.png" alt="运行过程中"><br><img src="/images/spark/spark_pi_result.png" alt="运行结束"><br>也可以用spark-shell连接到独立集群管理器上</p><h1 id="采用Hadoop-YARN管理器"><a href="#采用Hadoop-YARN管理器" class="headerlink" title="采用Hadoop YARN管理器"></a>采用Hadoop YARN管理器</h1><p>向Hadoop YARN集群管理器提交应用，需要把yarn-cluster作为主要参数传递给spark-submit。</p><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br></pre></td><td class="code"><pre><span class="line">root@master1:/usr/local/spark/spark-<span class="number">2.4</span>.<span class="number">4</span>-bin-hadoop2.<span class="number">6</span>/bin<span class="comment"># spark-submit --class org.apache.spark.examples.SparkPi --master yarn-cluster ../examples/jars/spark-examples_2.11-2.4.4.jarWarning: Master yarn-cluster is deprecated since 2.0. Please use master "yarn" with specified deploy mode instead.</span></span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">17</span> WARN util.NativeCodeLoader: Unable <span class="keyword">to</span> <span class="built_in">load</span> native-hadoop library <span class="keyword">for</span> your platform... using builtin-java classes where applicable</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">18</span> INFO client.RMProxy: Connecting <span class="keyword">to</span> ResourceManager at master1/<span class="number">192.168</span>.<span class="number">112.120</span>:<span class="number">8032</span></span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">18</span> INFO yarn.Client: Requesting a new application <span class="keyword">from</span> cluster with <span class="number">2</span> NodeManagers</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">19</span> INFO yarn.Client: Verifying our application has not requested more than the maximum memory capability of the cluster (<span class="number">8192</span> MB per container)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">19</span> INFO yarn.Client: Will allocate AM container, with <span class="number">1408</span> MB memory including <span class="number">384</span> MB overhead</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">19</span> INFO yarn.Client: Setting up container launch context <span class="keyword">for</span> our AM</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">19</span> INFO yarn.Client: Setting up the launch environment <span class="keyword">for</span> our AM container</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">19</span> INFO yarn.Client: Preparing resources <span class="keyword">for</span> our AM container</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">19</span> WARN yarn.Client: Neither spark.yarn.jars nor spark.yarn.archive is <span class="built_in">set</span>, falling back <span class="keyword">to</span> uploading libraries under SPARK_HOME.</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">25</span> INFO yarn.Client: Uploading resource file:/tmp/spark-<span class="number">1</span>d442b04-<span class="number">7</span>d9f-<span class="number">43</span>b5-b545-<span class="number">6</span>ba142b05fac/__spark_libs__8206803058515169480.zip -&gt; hdfs://master1:<span class="number">9000</span>/<span class="keyword">user</span>/root/.sparkStaging/application_1575900906070_0001/__spark_libs__8206803058515169480.zip</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">37</span> INFO yarn.Client: Uploading resource file:/usr/local/spark/spark-<span class="number">2.4</span>.<span class="number">4</span>-bin-hadoop2.<span class="number">6</span>/examples/jars/spark-examples_2.<span class="number">11</span>-<span class="number">2.4</span>.<span class="number">4</span>.jar -&gt; hdfs://master1:<span class="number">9000</span>/<span class="keyword">user</span>/root/.sparkStaging/application_1575900906070_0001/spark-examples_2.<span class="number">11</span>-<span class="number">2.4</span>.<span class="number">4</span>.jar</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">38</span> INFO yarn.Client: Uploading resource file:/tmp/spark-<span class="number">1</span>d442b04-<span class="number">7</span>d9f-<span class="number">43</span>b5-b545-<span class="number">6</span>ba142b05fac/__spark_conf__3621272077162715481.zip -&gt; hdfs://master1:<span class="number">9000</span>/<span class="keyword">user</span>/root/.sparkStaging/application_1575900906070_0001/__spark_conf__.zip</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">38</span> INFO spark.SecurityManager: Changing view acls <span class="keyword">to</span>: root</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">38</span> INFO spark.SecurityManager: Changing modify acls <span class="keyword">to</span>: root</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">38</span> INFO spark.SecurityManager: Changing view acls groups <span class="keyword">to</span>: </span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">38</span> INFO spark.SecurityManager: Changing modify acls groups <span class="keyword">to</span>: </span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">38</span> INFO spark.SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(root); groups with view permissions: Set(); users  with modify permissions: Set(root); groups with modify permissions: Set()</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">40</span> INFO yarn.Client: Submitting application application_1575900906070_0001 <span class="keyword">to</span> ResourceManager</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">41</span> INFO impl.YarnClientImpl: Submitted application application_1575900906070_0001</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">42</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">42</span> INFO yarn.Client: </span><br><span class="line">         client token: N/A</span><br><span class="line">         diagnostics: N/A</span><br><span class="line">         ApplicationMaster host: N/A</span><br><span class="line">         ApplicationMaster RPC <span class="keyword">port</span>: -<span class="number">1</span></span><br><span class="line">         queue: <span class="keyword">default</span></span><br><span class="line">         start time: <span class="number">1575903821002</span></span><br><span class="line">         final status: UNDEFINED</span><br><span class="line">         tracking URL: http://master1:<span class="number">8088</span>/proxy/application_1575900906070_0001/</span><br><span class="line">         <span class="keyword">user</span>: root</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">43</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">44</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">45</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">46</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">47</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">48</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">49</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">50</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">51</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">52</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">53</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">54</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">55</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">56</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">57</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">58</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">03</span>:<span class="number">59</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">00</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">01</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">02</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">03</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">04</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">05</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">06</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">07</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">08</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">09</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">10</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">11</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">12</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">13</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">14</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">15</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">16</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">17</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">18</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">19</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">20</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">21</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">22</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">23</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">24</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">25</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">26</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">27</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">28</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">29</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">30</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">31</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">32</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">33</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">34</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">35</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">36</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">37</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">38</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">39</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">40</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">41</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">42</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">43</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">44</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">45</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">46</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">47</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: ACCEPTED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">48</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">48</span> INFO yarn.Client: </span><br><span class="line">         client token: N/A</span><br><span class="line">         diagnostics: N/A</span><br><span class="line">         ApplicationMaster host: worker2</span><br><span class="line">         ApplicationMaster RPC <span class="keyword">port</span>: <span class="number">46666</span></span><br><span class="line">         queue: <span class="keyword">default</span></span><br><span class="line">         start time: <span class="number">1575903821002</span></span><br><span class="line">         final status: UNDEFINED</span><br><span class="line">         tracking URL: http://master1:<span class="number">8088</span>/proxy/application_1575900906070_0001/</span><br><span class="line">         <span class="keyword">user</span>: root</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">49</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">50</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">51</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">52</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">53</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">54</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">55</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">56</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">57</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">58</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">04</span>:<span class="number">59</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">00</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">01</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">02</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">03</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">04</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">05</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">06</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">07</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">08</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">09</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">10</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">11</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">12</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">13</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">14</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">15</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">16</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">17</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">18</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">19</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">20</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">21</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">22</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">23</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">24</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">25</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">26</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">27</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">28</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">29</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">30</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">31</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">32</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">33</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">34</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">35</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">36</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">37</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">38</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">39</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">40</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">41</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">42</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">43</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">44</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">45</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">46</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">47</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">48</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">49</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">50</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">51</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">52</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">53</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">54</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">55</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">56</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">57</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">58</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">05</span>:<span class="number">59</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">00</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">01</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">02</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">03</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">04</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">05</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">06</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">07</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">08</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">09</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">10</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">11</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">12</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">13</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">14</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">15</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">16</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">17</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">18</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">19</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">20</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">21</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: RUNNING)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">22</span> INFO yarn.Client: Application report <span class="keyword">for</span> application_1575900906070_0001 (<span class="keyword">state</span>: FINISHED)</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">22</span> INFO yarn.Client: </span><br><span class="line">         client token: N/A</span><br><span class="line">         diagnostics: N/A</span><br><span class="line">         ApplicationMaster host: worker2</span><br><span class="line">         ApplicationMaster RPC <span class="keyword">port</span>: <span class="number">46666</span></span><br><span class="line">         queue: <span class="keyword">default</span></span><br><span class="line">         start time: <span class="number">1575903821002</span></span><br><span class="line">         final status: SUCCEEDED</span><br><span class="line">         tracking URL: http://master1:<span class="number">8088</span>/proxy/application_1575900906070_0001/A</span><br><span class="line">         <span class="keyword">user</span>: root</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">22</span> INFO util.ShutdownHookManager: Shutdown hook called</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">22</span> INFO util.ShutdownHookManager: Deleting directory /tmp/spark-d61c2e6f-<span class="number">2691</span>-<span class="number">4</span>a92-<span class="number">84</span>cf-d0afa23334cc</span><br><span class="line"><span class="number">19</span>/<span class="number">12</span>/<span class="number">09</span> <span class="number">23</span>:<span class="number">06</span>:<span class="number">22</span> INFO util.ShutdownHookManager: Deleting directory /tmp/spark-<span class="number">1</span>d442b04-<span class="number">7</span>d9f-<span class="number">43</span>b5-b545-<span class="number">6</span>ba142b05fac</span><br></pre></td></tr></table></figure><p>这时查看hadoop yarn的管理界面<a href="http://192.168.112.120:8088/cluster" target="_blank" rel="noopener">192.168.112.120:8088</a>，可以看到有运行的job。<br><img src="/images/hadoop/hadoop_yarn_execute_job.png" alt="job运行中"><br><img src="/images/hadoop/hadoop_yarn_execute_job_result.png" alt="job运行结束"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;下面在搭建的集群中运行spark自带的例子，体验一下spark独立集群管理器和采用Hadoop YARN管理器的不同。&lt;/p&gt;
&lt;h1 id=&quot;采用独立集群管理器&quot;&gt;&lt;a href=&quot;#采用独立集群管理器&quot; class=&quot;headerlink&quot; title=&quot;采用独立集群管
      
    
    </summary>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/categories/spark/"/>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>spark集群环境搭建</title>
    <link href="http://sparkx.com.cn/spark/spark-setup/"/>
    <id>http://sparkx.com.cn/spark/spark-setup/</id>
    <published>2019-12-05T12:19:59.000Z</published>
    <updated>2019-12-09T15:14:40.399Z</updated>
    
    <content type="html"><![CDATA[<p>工欲善其事必先利其器，所以这节就简单介绍一下spark集群环境的搭建。</p><h1 id="虚拟机准备"><a href="#虚拟机准备" class="headerlink" title="虚拟机准备"></a>虚拟机准备</h1><p>虚拟机这里使用Ubuntn，具体版本可以自己选择，安装方法网上很容易搜索到，自行安装即可。</p><h1 id="Hadoop环境搭建"><a href="#Hadoop环境搭建" class="headerlink" title="Hadoop环境搭建"></a>Hadoop环境搭建</h1><p>搭建虚拟机环境可能遇到下面问题，根据给出的博客解决即可。</p><ul><li><a href="https://www.iteye.com/blog/kevin12-2271687" target="_blank" rel="noopener">Ubuntu15.10设置用root账号登录</a></li><li><a href="https://www.iteye.com/blog/kevin12-2271690" target="_blank" rel="noopener">VMware中安装了ubuntu全屏设置</a></li><li><a href="https://www.iteye.com/blog/kevin12-2273491" target="_blank" rel="noopener">ubuntu 15.10虚拟机设置静态ip</a></li><li><a href="https://www.iteye.com/blog/kevin12-2273532" target="_blank" rel="noopener">hadoop2.6.0集群的搭建方法</a></li><li><a href="https://www.iteye.com/blog/kevin12-2273556" target="_blank" rel="noopener">spark1.6.0搭建（基于hadoop2.6.0分布式）</a><h1 id="Spark2-x的搭建步骤"><a href="#Spark2-x的搭建步骤" class="headerlink" title="Spark2.x的搭建步骤"></a>Spark2.x的搭建步骤</h1>Spark2.x的搭建和1.6.0搭建基本一样，下面记录一下自己搭建的简单步骤：<br>下载如下图：<a href="http://spark.apache.org/downloads.html" target="_blank" rel="noopener">点击进入官网</a><br><img src="/images/spark/spark_down.png" alt=""><br>拷贝到master1的/usr/local/spark目录下面，执行<code>tar -zxvf spark-2.4.4-bin-hadoop2.6.tar</code>命令解压。<br>将路径添加到环境变量中：<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/local/jdk/jdk1.8.0_71</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JRE_HOME</span>=<span class="variable">$&#123;JAVA_HOME&#125;</span>/jre</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">MAVEN_HOME</span>=/usr/local/maven/apache-maven-3.3.9</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">SCALA_HOME</span>=/usr/local/scala/scala-2.11.0</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HADOOP_HOME</span>=/usr/local/hadoop/hadoop-2.6.0</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HADOOP_CONF_DIR</span>=<span class="variable">$&#123;HADOOP_HOME&#125;</span>/etc/hadoop</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HADOOP_COMMON_LIB_NATIVE_DIR</span>=<span class="variable">$&#123;HADOOP_HOME&#125;</span>/lib/native</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HADOOP_OPTS</span>=<span class="string">"-Djava.library.path=<span class="variable">$&#123;HADOOP_HOME&#125;</span>/lib"</span></span><br><span class="line"><span class="comment">#export SPARK_HOME=/usr/local/spark/spark-1.6.0-bin-hadoop2.6</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">SPARK_HOME</span>=/usr/local/spark/spark-2.4.4-bin-hadoop2.6</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HIVE_HOME</span>=/usr/local/hive/apache-hive-1.2.1-bin</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HIVE_CONF_DIR</span>=<span class="variable">$&#123;HIVE_HOME&#125;</span>/conf</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ZOOKEEPER_HOME</span>=/usr/local/zookeeper/zookeeper-3.4.6</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">JSTORM_HOME</span>=/usr/local/jstorm/jstorm-2.1.1</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">STORM_HOME</span>=/usr/local/storm/apache-storm-1.0.1</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">KAFKA_HOME</span>=/usr/local/kafka/kafka_2.10-0.10.0.0</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">NODEJS_HOME</span>=/usr/local/nodejs/node-v4.4.7-linux-x64</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">IDEA_HOME</span>=/root/tools/idea</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ECLIPLSE_HOME</span>=/root/tools/eclipse</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">TOMCAT_HOME</span>=/usr/local/apache-tomcat-7.0.52</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">CLASS_PATH</span>=.:$&#123;JAVA_HOME&#125;/lib:<span class="variable">$&#123;JRE_HOME&#125;</span>/lib:<span class="variable">$&#123;HIVE_HOME&#125;</span>/lib</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=.:$&#123;JAVA_HOME&#125;/bin:<span class="variable">$&#123;MAVEN_HOME&#125;</span>/bin:<span class="variable">$&#123;SCALA_HOME&#125;</span>/bin:<span class="variable">$&#123;HADOOP_HOME&#125;</span>/bin:<span class="variable">$&#123;HADOOP_HOME&#125;</span>/sbin:<span class="variable">$&#123;SPARK_HOME&#125;</span>/bin:<span class="variable">$&#123;SPARK_HOME&#125;</span>/sbin:<span class="variable">$&#123;IDEA_HOME&#125;</span>/bin:<span class="variable">$&#123;ECLIPLSE_HOME&#125;</span>:<span class="variable">$&#123;HIVE_HOME&#125;</span>/bin:<span class="variable">$&#123;ZOOKEEPER_HOME&#125;</span>/bin:<span class="variable">$&#123;JSTORM&#125;</span>/bin:<span class="variable">$&#123;STORM_HOME&#125;</span>/bin:<span class="variable">$&#123;KAFKA_HOME&#125;</span>/bin:<span class="variable">$&#123;NODEJS_HOME&#125;</span>/bin:<span class="variable">$&#123;TOMCAT_HOME&#125;</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>配置Spark<br>配置slaves文件,进入/usr/local/spark/spark-2.4.4-bin-hadoop2.6目录，执行<code>mv slaves.template slaves</code>命令，重命名。<br>将<code>localhost</code>改为：<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">worker1</span><br><span class="line">worker2</span><br></pre></td></tr></table></figure>配置spark-env.sh文件，进入/usr/local/spark/spark-2.4.4-bin-hadoop2.6目录，执行命令<code>mv spark-env.sh.template spark-env.sh</code>命令，重命名。<br>添加如下内容：<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/usr/local/jdk/jdk1.8.0_71</span><br><span class="line"><span class="builtin-name">export</span> <span class="builtin-name">export</span> <span class="attribute">SCALA_HOME</span>=/usr/local/scala/scala-2.11.0</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HADOOP_HOME</span>=/usr/local/hadoop/hadoop-2.6.0</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HADOOP_CONF_DIR</span>=<span class="variable">$&#123;HADOOP_HOME&#125;</span>/etc/hadoop</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">SPARK_MASTER_IP</span>=master1</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">SPARK_WORKER_MEMORY</span>=600m</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">SPARK_EXECUTOR_MEMORY</span>=600m</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">SPARK_DRIVER_MEMORY</span>=1g</span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">SPARK_WORKDER_CORES</span>=2</span><br></pre></td></tr></table></figure>配置完成后，将master1上的/usr/local/spark/spark-2.4.4-bin-hadoop2.6拷贝到worer1和worker2中的/usr/local/spark目录下面。<br>命令:<code>scp -r ./spark-2.4.4-bin-hadoop2.6 worker1:/usr/local/spark/</code>拷贝到worker1。<br>命令:<code>scp -r ./spark-2.4.4-bin-hadoop2.6 worker2:/usr/local/spark/</code>拷贝到worker2。<br>至此，spark集群配置完成。<h1 id="启动Spark集群"><a href="#启动Spark集群" class="headerlink" title="启动Spark集群"></a>启动Spark集群</h1>首先启动hadoop集群。在master1节点上，进入root@master1:/usr/local/hadoop/hadoop-2.6.0/sbin目录运行如下命令<code>start-all.sh</code>启动hadoop。<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">root@master1:/usr/local/hadoop/hadoop-2.6.0/sbin# start-all.sh</span><br><span class="line">This<span class="built_in"> script </span>is Deprecated. Instead use start-dfs.sh <span class="keyword">and</span> start-yarn.sh</span><br><span class="line">19/12/09 22:14:46 WARN util.NativeCodeLoader: Unable <span class="keyword">to</span> load native-hadoop library <span class="keyword">for</span> your platform<span class="built_in">..</span>. using builtin-java classes where applicable</span><br><span class="line">Starting namenodes on [master1]</span><br><span class="line">master1: starting namenode,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.0/logs/hadoop-root-namenode-master1.out</span><br><span class="line">worker2: starting datanode,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.0/logs/hadoop-root-datanode-worker2.out</span><br><span class="line">worker1: starting datanode,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.0/logs/hadoop-root-datanode-worker1.out</span><br><span class="line">Starting secondary namenodes [master1]</span><br><span class="line">master1: starting secondarynamenode,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.0/logs/hadoop-root-secondarynamenode-master1.out</span><br><span class="line">19/12/09 22:15:03 WARN util.NativeCodeLoader: Unable <span class="keyword">to</span> load native-hadoop library <span class="keyword">for</span> your platform<span class="built_in">..</span>. using builtin-java classes where applicable</span><br><span class="line">starting yarn daemons</span><br><span class="line">starting resourcemanager,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.0/logs/yarn-root-resourcemanager-master1.out</span><br><span class="line">worker1: starting nodemanager,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.0/logs/yarn-root-nodemanager-worker1.out</span><br><span class="line">worker2: starting nodemanager,<span class="built_in"> logging </span><span class="keyword">to</span> /usr/local/hadoop/hadoop-2.6.0/logs/yarn-root-nodemanager-worker2.out</span><br><span class="line">root@master1:/usr/local/hadoop/hadoop-2.6.0/sbin# jps 用jps命令查看进程</span><br><span class="line">54320 SecondaryNameNode</span><br><span class="line">54706 ResourceManager</span><br><span class="line">58724 Jps</span><br><span class="line">53786 NameNode</span><br><span class="line">root@worker1:~# jps  worker1上的进程</span><br><span class="line">6069 Jps</span><br><span class="line">5766 DataNode</span><br><span class="line">5896 NodeManager</span><br><span class="line">root@worker2:~# jps  worker2上的进程</span><br><span class="line">5450 DataNode</span><br><span class="line">5756 Jps</span><br><span class="line">5580 NodeManager</span><br><span class="line">root@worker2:~# </span><br><span class="line">master1上显示以上4个进程，worker上显示上面3个进程说明hadoop启动成功。</span><br></pre></td></tr></table></figure>我的集群ip配置如下：<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@master1:~# cat /etc/hosts</span><br><span class="line"><span class="number">127.0.0.1</span>       localhost</span><br><span class="line"><span class="number">192.168.112.120</span> master1</span><br><span class="line"><span class="number">192.168.112.121</span> worker1</span><br><span class="line"><span class="number">192.168.112.122</span> worker2</span><br></pre></td></tr></table></figure>所以在浏览器中输入<a href="192.168.112.120:8088">192.168.112.120:8088</a>即可以查看hadoop yarn管理界。<br><img src="/images/hadoop/hadoop_cluster.png" alt=""><br>在浏览器中输入<a href="http://192.168.112.120:50070" target="_blank" rel="noopener">192.168.112.120:50070</a>可以查看hadoop集群状况。<br><img src="/images/hadoop/hadoop_cluster1.png" alt=""></li></ul><p><strong>启动Spark Mster节点</strong></p><figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">root@</span>master1:/usr/local/spark/spark<span class="number">-2.4</span><span class="number">.4</span>-bin-hadoop2<span class="number">.6</span>/sbin# start-all.sh</span><br><span class="line">starting org.apache.spark.deploy.master.Master, logging to /usr/local/spark/spark<span class="number">-2.4</span><span class="number">.4</span>-bin-hadoop2<span class="number">.6</span>/logs/spark-root-org.apache.spark.deploy.master.Master<span class="number">-1</span>-master1.<span class="keyword">out</span></span><br><span class="line">worker2: starting org.apache.spark.deploy.worker.Worker, logging to /usr/local/spark/spark<span class="number">-2.4</span><span class="number">.4</span>-bin-hadoop2<span class="number">.6</span>/logs/spark-root-org.apache.spark.deploy.worker.Worker<span class="number">-1</span>-worker2.<span class="keyword">out</span></span><br><span class="line">worker1: starting org.apache.spark.deploy.worker.Worker, logging to /usr/local/spark/spark<span class="number">-2.4</span><span class="number">.4</span>-bin-hadoop2<span class="number">.6</span>/logs/spark-root-org.apache.spark.deploy.worker.Worker<span class="number">-1</span>-worker1.<span class="keyword">out</span></span><br><span class="line">再次查看进程</span><br><span class="line"><span class="symbol">root@</span>master1:/usr/local/spark/spark<span class="number">-2.4</span><span class="number">.4</span>-bin-hadoop2<span class="number">.6</span>/sbin# jps</span><br><span class="line"><span class="number">54320</span> SecondaryNameNode</span><br><span class="line"><span class="number">18386</span> Jps</span><br><span class="line"><span class="number">54706</span> ResourceManager</span><br><span class="line"><span class="number">53786</span> NameNode</span><br><span class="line"><span class="number">17563</span> Master</span><br><span class="line"></span><br><span class="line"><span class="symbol">root@</span>worker1:~# jps</span><br><span class="line"><span class="number">6370</span> Jps</span><br><span class="line"><span class="number">6310</span> Worker</span><br><span class="line"><span class="number">5766</span> DataNode</span><br><span class="line"><span class="number">5896</span> NodeManager</span><br><span class="line"></span><br><span class="line"><span class="symbol">root@</span>worker2:~# jps</span><br><span class="line"><span class="number">5991</span> Worker</span><br><span class="line"><span class="number">5450</span> DataNode</span><br><span class="line"><span class="number">6043</span> Jps</span><br><span class="line"><span class="number">5580</span> NodeManager</span><br><span class="line">可以看到master上多了一个Master进程，worker1和worker2上分别多了Worker进程,说明spark集群启动成功。</span><br></pre></td></tr></table></figure><p>在浏览器中输入<a href="http://192.168.112.120:8080/" target="_blank" rel="noopener">192.168.112.120:8080</a>即可进入spark web页面查看spark集群的信息。<br><img src="/images/spark/spark_web.png" alt=""></p><h1 id="关闭Spark集群"><a href="#关闭Spark集群" class="headerlink" title="关闭Spark集群"></a>关闭Spark集群</h1><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root<span class="variable">@master1</span><span class="symbol">:/usr/local/spark/spark-</span><span class="number">2.4</span>.<span class="number">4</span>-bin-hadoop2.<span class="number">6</span>/sbin<span class="comment"># stop-all.sh</span></span><br><span class="line"><span class="symbol">worker2:</span> stopping org.apache.spark.deploy.worker.Worker</span><br><span class="line"><span class="symbol">worker1:</span> stopping org.apache.spark.deploy.worker.Worker</span><br><span class="line">stopping org.apache.spark.deploy.master.Master</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;工欲善其事必先利其器，所以这节就简单介绍一下spark集群环境的搭建。&lt;/p&gt;
&lt;h1 id=&quot;虚拟机准备&quot;&gt;&lt;a href=&quot;#虚拟机准备&quot; class=&quot;headerlink&quot; title=&quot;虚拟机准备&quot;&gt;&lt;/a&gt;虚拟机准备&lt;/h1&gt;&lt;p&gt;虚拟机这里使用Ubuntn，具
      
    
    </summary>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/categories/spark/"/>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>scala 快速入门3</title>
    <link href="http://sparkx.com.cn/scala/scala-note3/"/>
    <id>http://sparkx.com.cn/scala/scala-note3/</id>
    <published>2019-12-01T08:17:47.000Z</published>
    <updated>2019-12-09T13:48:28.706Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/scala.png" alt=""></p><h1 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h1><p>Scala中的继承与Java有着明显的不同，体现在下面几点：</p><ul><li>重写一个非抽象方法必须使用override修饰符</li><li>只有主构造器可以调用超类的主构造器</li><li>在子类中重写超类的抽象方法时，不需要使用override关键字</li><li>可以重写超类中的字段<br>Scala和Java一样，不允许类从多个超类继承。下面是一个抽象类和继承的例子，解释见注释。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span> </span>&#123;<span class="comment">//抽象类，不能直接被实例化,必须使用abstract关键字</span></span><br><span class="line">  <span class="keyword">val</span> carBrand:<span class="type">String</span> <span class="comment">//字段没有初始化值，就是一个抽象字段，但是必须声明类型，否则编译报错</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">info</span></span>() <span class="comment">//抽象方法，不需要使用abstract关键字</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">greeting</span></span>()&#123;println(<span class="string">"welecome to my car"</span>)&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BMWCar</span> <span class="keyword">extends</span> <span class="title">Car</span></span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> carBrand =<span class="string">"BMW"</span> <span class="comment">//重写超类字段，使用override关键字否则编译报错</span></span><br><span class="line">  <span class="comment">//重写超类抽象方法时，不需要使用override关键字，不过如果加上override编译也不会报错</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">info</span></span>()&#123;printf(<span class="string">"This is a %s car\n"</span>,carBrand)&#125;</span><br><span class="line">  <span class="comment">//重写超类的非抽象方法，必须使用关键字override</span></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">greeting</span></span>()&#123;println(<span class="string">"welcome to my BMW car"</span>)&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BYDCar</span> <span class="keyword">extends</span>  <span class="title">Car</span></span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">val</span> carBrand =<span class="string">"BYD"</span> <span class="comment">//重写超类字段，使用override关键字否则编译报错</span></span><br><span class="line">  <span class="comment">//重写超类抽象方法时，不需要使用override关键字，不过如果加上override编译也不会报错</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">info</span></span>()&#123;printf(<span class="string">"This is a %s car\n"</span>,carBrand)&#125;</span><br><span class="line">  <span class="comment">//重写超类的非抽象方法，必须使用关键字override</span></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">greeting</span></span>()&#123;println(<span class="string">"welcome to my BYD car"</span>)&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">MyCar</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> myCar1 = <span class="keyword">new</span> <span class="type">BMWCar</span>()</span><br><span class="line">    <span class="keyword">val</span> myCar2 = <span class="keyword">new</span> <span class="type">BYDCar</span>()</span><br><span class="line">    myCar1.greeting()</span><br><span class="line">    myCar1.info()</span><br><span class="line">    myCar2.greeting()</span><br><span class="line">    myCar2.info()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="特质-trait"><a href="#特质-trait" class="headerlink" title="特质(trait)"></a>特质(trait)</h1></li><li>特质概念<br>Scala中没有接口的概念，而是提供了<code>特质</code>，它不仅实现了接口的功能，还具备了很多其他的特性，<code>特质</code>是代码重用的基本元素，可以同时拥有<code>抽象方法</code>和<code>具体方法</code>；<br>一个类只能继承自一个超类，却可以实现多个<code>特质</code>，从而重用<code>特质</code>中的方法和字段，实现多重继承； </li><li>特质定义，把多个特征混入类<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">CarId</span></span>&#123;</span><br><span class="line"><span class="keyword">var</span> id :<span class="type">Int</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">currentId</span></span>():<span class="type">Int</span><span class="comment">//定义一个抽象方法</span></span><br><span class="line">&#125;</span><br><span class="line">注意：抽象方法不需要使用<span class="keyword">abstract</span>关键字，特质中没有方法体的方法默认就是抽象方法。</span><br><span class="line">特质定义好后，就可以使用<span class="keyword">extends</span>或<span class="keyword">with</span>关键字把特质混入类中。</span><br><span class="line">```scala</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">CarId</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> id :<span class="type">Int</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">currentId</span></span>():<span class="type">Int</span> <span class="comment">//定义抽象方法</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">trait</span> <span class="title">CarGreeting</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">greeting</span></span>(msg:<span class="type">String</span>)(println(msg))<span class="comment">//非抽象方法</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BYDCarId</span> <span class="keyword">extends</span> <span class="title">CarId</span> <span class="keyword">with</span> <span class="title">CarGreeting</span></span>&#123;<span class="comment">//使用extends关键字混入第一个特质，后面可以反复使用with关键字混入更多特质</span></span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">var</span> id: <span class="type">Int</span> = <span class="number">10000</span><span class="comment">//BYD汽车编号从10000开始</span></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">currentId</span></span>(): <span class="type">Int</span> = &#123;id += <span class="number">1</span>;id&#125;<span class="comment">//返回汽车编号</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BMWCarId</span> <span class="keyword">extends</span> <span class="title">CarId</span></span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="keyword">var</span> id: <span class="type">Int</span> = <span class="number">20000</span><span class="comment">//BMW汽车编号从10000开始</span></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">currentId</span></span>(): <span class="type">Int</span> = &#123;id += <span class="number">1</span>;id&#125;<span class="comment">//返回汽车编号</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">MyCar2</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> myCarId1 = <span class="keyword">new</span> <span class="type">BYDCarId</span>()</span><br><span class="line">    <span class="keyword">var</span> myCarId2 = <span class="keyword">new</span> <span class="type">BMWCarId</span>()</span><br><span class="line">    printf(<span class="string">"My first CarId is %d.\n"</span>,myCarId1.currentId())</span><br><span class="line">    printf(<span class="string">"My second CarId is %d.\n"</span>,myCarId2.currentId())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">运行结果:</span><br><span class="line"><span class="type">My</span> first <span class="type">CarId</span> is <span class="number">10001.</span></span><br><span class="line"><span class="type">My</span> second <span class="type">CarId</span> is <span class="number">20001.</span></span><br></pre></td></tr></table></figure>上面例子<code>特质</code>只包含了抽象字段和方法，相当于Java的接口功能，实际上，<code>特质</code>也可以包含具体实现，也就是说，<code>特质</code>中的字段和方法不一定要是抽象的。</li></ul><h1 id="模式匹配"><a href="#模式匹配" class="headerlink" title="模式匹配"></a>模式匹配</h1><ul><li>简单匹配<br>最常用语match语句中，下面是一个简单的整型值的匹配实例：<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">PatternMatch</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> colorNum = <span class="number">1</span></span><br><span class="line">    <span class="keyword">val</span> colorStr = colorNum <span class="keyword">match</span>&#123;</span><br><span class="line">      <span class="keyword">case</span>  <span class="number">1</span> =&gt;<span class="string">"red"</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span> =&gt; <span class="string">"green"</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span> =&gt; <span class="string">"yellow"</span></span><br><span class="line">      <span class="keyword">case</span> _ =&gt; <span class="string">"Not allowed"</span></span><br><span class="line">    &#125;</span><br><span class="line">    print(colorStr)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">运行结果:</span><br><span class="line">red</span><br><span class="line">将 <span class="keyword">case</span> _ =&gt; <span class="string">"Not allowed"</span>改为<span class="keyword">case</span> unexpected =&gt; unexpected + <span class="string">" is not allowed"</span>，即模式匹配<span class="keyword">case</span>语句中可以使用变量，再另<span class="keyword">case</span>=<span class="number">4</span>运行结果:</span><br><span class="line"><span class="number">4</span> is not allowed</span><br></pre></td></tr></table></figure></li><li>类型模式<br>Scala可以对表达式的类型进行匹配<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(elem &lt;- <span class="type">List</span>(<span class="number">9</span>,<span class="number">12.3</span>,<span class="string">"Scala"</span>,<span class="symbol">'Spark</span>))&#123;</span><br><span class="line"><span class="keyword">val</span> str = elem <span class="keyword">match</span>&#123;</span><br><span class="line">  <span class="keyword">case</span> i: <span class="type">Int</span> =&gt; i+<span class="string">" is an int value"</span></span><br><span class="line">  <span class="keyword">case</span> d: <span class="type">Double</span> =&gt; d+<span class="string">" is a double value"</span></span><br><span class="line">  <span class="keyword">case</span> <span class="string">"Scala"</span> =&gt; <span class="string">"Scala is found"</span></span><br><span class="line">  <span class="keyword">case</span> s: <span class="type">String</span> =&gt; s + <span class="string">" is a string value"</span></span><br><span class="line">  <span class="keyword">case</span> _ =&gt; <span class="string">"This is an unexpected value"</span></span><br><span class="line">&#125;</span><br><span class="line">println(str)</span><br><span class="line">运行结果：</span><br><span class="line"><span class="number">9</span> is an int value</span><br><span class="line"><span class="number">12.3</span> is a double value</span><br><span class="line"><span class="type">Scala</span> is found</span><br><span class="line"><span class="type">This</span> is an unexpected value</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>“守卫(guard)”语句<br>可以在模式匹配中添加一些必要的处理逻辑<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">for</span>(elem &lt;- <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))&#123;</span><br><span class="line">    elem <span class="keyword">match</span>&#123;</span><br><span class="line">      <span class="keyword">case</span> _ <span class="keyword">if</span>(elem %<span class="number">2</span> == <span class="number">0</span>) =&gt; println(elem + <span class="string">" is even"</span>)</span><br><span class="line">      <span class="keyword">case</span> _ =&gt; println(elem + <span class="string">" is odd"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="number">1</span> is odd</span><br><span class="line"><span class="number">2</span> is even</span><br><span class="line"><span class="number">3</span> is odd</span><br><span class="line"><span class="number">4</span> is even</span><br></pre></td></tr></table></figure></li><li>case类的匹配<br>case类是一种特殊的类，它们经过优化以后被用于模式匹配<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Car</span>(<span class="params">brand:<span class="type">String</span>,price:<span class="type">Int</span></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">val</span> myBYDCar = <span class="keyword">new</span> <span class="type">Car</span>(<span class="string">"BYD"</span>,<span class="number">100000</span>)</span><br><span class="line">  <span class="keyword">val</span> myBMWCar = <span class="keyword">new</span> <span class="type">Car</span>(<span class="string">"BMW"</span>,<span class="number">200000</span>)</span><br><span class="line">  <span class="keyword">val</span> myBenzCar = <span class="keyword">new</span> <span class="type">Car</span>(<span class="string">"Benz"</span>,<span class="number">300000</span>)</span><br><span class="line">  <span class="keyword">for</span>(car &lt;- <span class="type">List</span>(myBYDCar,myBMWCar,myBenzCar))&#123;</span><br><span class="line">    car <span class="keyword">match</span> &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="type">Car</span>(<span class="string">"BYD"</span>, <span class="number">100000</span>) =&gt; print(<span class="string">"hello BYD"</span>)</span><br><span class="line">      <span class="keyword">case</span> <span class="type">Car</span>(<span class="string">"BMW"</span>, <span class="number">200000</span>) =&gt; print(<span class="string">"hello BMW"</span>)</span><br><span class="line">      <span class="keyword">case</span> <span class="type">Car</span>(<span class="string">"Benz"</span>, <span class="number">300000</span>) =&gt; print(<span class="string">"hello Benz"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>Option类型<br>标准类库中的Option类型用case类来表示那种可能存在，也可能不存在的值。<br>一般而言，对于每种语言来说，都会有一个关键字来表示一个对象引用的”无”，在Java中使用null。Scala融合了函数式编程风格，因此，当预计到变量或者函数返回值可能不会引用任何值的时候，建议使用Option类型。<br>Option类包含一个子类Some，当存在可以被引用的值时候，就可以使用Some来包含这个值，例如Some(“Scala”)。而None则被声明为一个对象，而不是一个类，表示没有值。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//创建Map</span></span><br><span class="line">scala&gt; <span class="keyword">val</span> books = <span class="type">Map</span>(<span class="string">"Scala"</span> -&gt;<span class="number">3</span>,<span class="string">"Spark"</span>-&gt;<span class="number">5</span>)</span><br><span class="line">books: scala.collection.immutable.<span class="type">Map</span>[<span class="type">String</span>,<span class="type">Int</span>] = <span class="type">Map</span>(<span class="type">Scala</span> -&gt; <span class="number">3</span>, <span class="type">Spark</span> -&gt; <span class="number">5</span>)</span><br><span class="line"><span class="comment">//键存在，可以取到值，并且取到的值会包含在Some中返回</span></span><br><span class="line">scala&gt; books.get(<span class="string">"Scala"</span>)</span><br><span class="line">res0: <span class="type">Option</span>[<span class="type">Int</span>] = <span class="type">Some</span>(<span class="number">3</span>)</span><br><span class="line"><span class="comment">//键值不存在，所以取到的值是None对象</span></span><br><span class="line">scala&gt; books.get(<span class="string">"hadoop"</span>)</span><br><span class="line">res1: <span class="type">Option</span>[<span class="type">Int</span>] = <span class="type">None</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> sales = books.get(<span class="string">"hadoop"</span>)</span><br><span class="line">sales: <span class="type">Option</span>[<span class="type">Int</span>] = <span class="type">None</span></span><br><span class="line"><span class="comment">//Option类还提供了getOrElse方法，当这个方法在这个Option是Some的实例时返回对应的值，而在是None的实例时返回传入的参数</span></span><br><span class="line">scala&gt; sales.getOrElse(<span class="string">"No such book"</span>)</span><br><span class="line">res3: <span class="type">Any</span> = <span class="type">No</span> such book</span><br><span class="line"></span><br><span class="line">scala&gt; println(sales.getOrElse(<span class="string">"No such book"</span>))</span><br><span class="line"><span class="type">No</span> such book</span><br></pre></td></tr></table></figure>Option的情形在Scala使用非常频繁，经常会用到Option[T]类型，其中的T可以是String,Int或者其他各种数据类型。<br>Option[T]实际上就是一个容器，可以把它看做是一个集合，只不过这个集合要么只包含一个元素（被包装在Some中返回），要么不存在元素（返回None)。<br>既然是一个集合，我们当然可以对它使用map、foreach或者filter等方法。如：books.get(“Scala”).foreach(println)。<h1 id="函数式编程基础"><a href="#函数式编程基础" class="headerlink" title="函数式编程基础"></a>函数式编程基础</h1></li><li>语法定义：def 方法名(参数列表):结果类型={方法体}，如上面我们已经用到了，可以回顾之前的代码理解一下。</li><li>函数字面量<br>val i = 123 //123就是整数字面量<br>val i = 3.14 //3.14就是浮点数字面量<br>val i = true //true就是布尔型字面量<br>val i = ‘A’ //‘A’就是字符字面量<br>val i = “scala” //“scala”就是字符串字面量</li><li>函数字面量<br>函数字面量可以提现函数式编程的核心理念。<br>在函数式编程中，函数是”头等公民”，可以像任何其数据类型一样被传递和操作，也就是说，函数的使用方式和其他数据类型完全一致。<br>这时，我们就可以像定义变量那样取定义一个函数，由此导致的结果是函数也会想和其他变量一样，开始有“值”。<br>就像变量的“类型”和“值”是分开的两个概念一样，函数式编程中，函数的“类型”和“值”也成为两个分开的概念，函数的“值”就是“函数字面量”。</li><li>函数的类型和值<br>定义一个传统类型的函数，定义语法和之前介绍定义“类中的方法”类似。<br>def counter(value:Int):Int = { value += 1}<br>上面定义这个函数的“类型”是：(Int) =&gt; Int<br>实际上，只有一个参数时圆括号可以省略Int =&gt; Int(等价于上面)，上面就得到了函数的“类型”。</li></ul><p><strong>如何得到函数的“值”呢？</strong><br>实际上，只要把函数定义中的类型什么部分去除，剩下的就是函数的“值”，如下：<br>(value) =&gt; {value += 1} //只有一条语句时，大括号可以省略<br>注意：上面就是函数的“值”，需要注意的是，采用“=&gt;”而不是“=”，这是Scala的语法要求。<br>我们依葫芦（val num:Int = 5）画瓢形式定义Scala的函数：val counter:Int =&gt; Int{(value) =&gt; value += 1}<br>从上面可以看出，在Scala中函数已经是“头等公民”，单独剥离出来了“值”的概念，一个函数“值”就是函数字面量。这样，只要在某个需要声明函数的地方声明一个函数类型，在调用的时候传入一个对应的函数字面量即可，和使用普通变量一模一样。</p><ul><li>匿名函数、Lamda表达式与闭包<br>不需要给函数命名是，可以使用匿名函数，(num:Int) =&gt; num*2,这种经常称为“Lamda表达式”。Lamda表达式形式：(参数) =&gt;表达式//如果参数只有一个，参数的圆括号可以省略<br>可以直接把匿名函数放到变量中，如下：<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> myFunc: <span class="type">Int</span> =&gt; <span class="type">Int</span> = (num: <span class="type">Int</span>) =&gt; num * <span class="number">2</span> <span class="comment">//把匿名函数定义为一个值，赋值给变量</span></span><br><span class="line">myFunc: <span class="type">Int</span> =&gt; <span class="type">Int</span> = $$<span class="type">Lambda</span>$<span class="number">1039</span>/<span class="number">1942631655</span>@<span class="number">5696</span>c927 <span class="comment">//执行返回结果</span></span><br><span class="line"></span><br><span class="line">scala&gt; print(myFunc(<span class="number">3</span>)) <span class="comment">//函数调用</span></span><br></pre></td></tr></table></figure>Scala具有推断机制，可以自动推断变量类型,val num: Int = 2 等价于 val num = 2，所以上面的函数定义可以去掉“Int=&gt;Int”，即：val myFunc = (num: Int) =&gt; num * 2。<br>val myFunc = (num) =&gt; num * 2 //解释器无法推断出类型报错，val myFunc: Int =&gt;Int = (num) =&gt; num *2 可推断num类型是Int类型。</li></ul><p><strong>闭包</strong><br>闭包是一种比较特殊的函数，和普通函数有很多区别：<br>var more = 1<br>val addMore = (x: Int) =&gt; x&gt;0 //普通函数<br>val addMore = (x: Int) =&gt; x + more //闭包<br>闭包反应了一个从开发到封闭的过程，每次addMore函数被调用时都会创建一个新的闭包，每个闭包都会访问闭包创建时活跃的more变量。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">var</span> more = <span class="number">1</span></span><br><span class="line">more: <span class="type">Int</span> = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> addMore = (x:<span class="type">Int</span>) =&gt; x + more</span><br><span class="line">addMore: <span class="type">Int</span> =&gt; <span class="type">Int</span> = $$<span class="type">Lambda</span>$<span class="number">1061</span>/<span class="number">1841213176</span>@<span class="number">7744195</span></span><br><span class="line"></span><br><span class="line">scala&gt; addMore(<span class="number">10</span>)</span><br><span class="line">res2: <span class="type">Int</span> = <span class="number">11</span></span><br><span class="line"></span><br><span class="line">scala&gt; more = <span class="number">9</span></span><br><span class="line">more: <span class="type">Int</span> = <span class="number">9</span></span><br><span class="line"></span><br><span class="line">scala&gt; addMore(<span class="number">10</span>)</span><br><span class="line">res3: <span class="type">Int</span> = <span class="number">19</span></span><br></pre></td></tr></table></figure><ul><li>占位符语法<br>为了让函数字面量更加简洁，可以使用下划线作为一个或者多个参数的占位符，只要每个参数在函数字面量内仅出现一次。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> numList = <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">-3</span>,<span class="number">4</span>,<span class="number">-5</span>)</span><br><span class="line">numList: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">-3</span>, <span class="number">4</span>, <span class="number">-5</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; numList.filter(x =&gt; x&gt;<span class="number">0</span>)</span><br><span class="line">res4: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; numList.filter(_&gt;<span class="number">0</span>)</span><br><span class="line">res5: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure>从上面运行结果可以看出，下面两个函数字面量是等价的，即x =&gt; x&gt;0 等价于<em>&gt;0 。<br>有时候把下划线作为参数的占位符时，编译器有可能没有足够的信息推断缺失参数的类型，如，</em>+_会报错，可以用冒号指定类型：<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> f = _ + _</span><br><span class="line">&lt;console&gt;:<span class="number">11</span>: error: missing parameter <span class="class"><span class="keyword">type</span> <span class="title">for</span> <span class="title">expanded</span> <span class="title">function</span> (<span class="params">(x$1: &lt;error&gt;, x$2</span>) <span class="title">=&gt;</span> <span class="title">x$1</span>.<span class="title">$plus</span>(<span class="params">x$2</span>))</span></span><br><span class="line"><span class="class">       <span class="title">val</span> <span class="title">f</span> </span>= _ + _</span><br><span class="line">               ^</span><br><span class="line">&lt;console&gt;:<span class="number">11</span>: error: missing parameter <span class="class"><span class="keyword">type</span> <span class="title">for</span> <span class="title">expanded</span> <span class="title">function</span> (<span class="params">(x$1: &lt;error&gt;, x$2: &lt;error&gt;</span>) <span class="title">=&gt;</span> <span class="title">x$1</span>.<span class="title">$plus</span>(<span class="params">x$2</span>))</span></span><br><span class="line"><span class="class">       <span class="title">val</span> <span class="title">f</span> </span>= _ + _</span><br><span class="line">                   ^</span><br><span class="line">scala&gt; <span class="keyword">val</span> f = (_:<span class="type">Int</span>) + (_:<span class="type">Int</span>)</span><br><span class="line">f: (<span class="type">Int</span>, <span class="type">Int</span>) =&gt; <span class="type">Int</span> = $$<span class="type">Lambda</span>$<span class="number">1099</span>/<span class="number">1579858776</span>@<span class="number">943</span>d0c2</span><br><span class="line"></span><br><span class="line">scala&gt; print(f(<span class="number">5</span>,<span class="number">10</span>))</span><br><span class="line"><span class="number">15</span></span><br></pre></td></tr></table></figure>注意：留心“<em>+</em>”将扩展成带两个参数的函数的字面量，这也是仅当每个参数的函数字面量中最多出现一次的情况先你才能运用这种短格式的原由。多个下划线指定多个参数，而不是单个参数的重复运用。第一个下划线代表第一个参数，第二个下划线代表第二个参数，第三个……，如此类推。</li></ul><h2 id="至此，Scala入门知识讲解完毕，但是Scala的其他知识还需进一步学习，点击Scala-Getting-Started去学习"><a href="#至此，Scala入门知识讲解完毕，但是Scala的其他知识还需进一步学习，点击Scala-Getting-Started去学习" class="headerlink" title="至此，Scala入门知识讲解完毕，但是Scala的其他知识还需进一步学习，点击Scala Getting Started去学习!"></a>至此，Scala入门知识讲解完毕，但是Scala的其他知识还需进一步学习，点击<a href="https://docs.scala-lang.org/getting-started/index.html" target="_blank" rel="noopener">Scala Getting Started</a>去学习!</h2><p><strong>声明:</strong><br>作者:上海IT技术圈<br>本文版权归作者和上海IT技术圈共有，任何人或团体、机构全部转载或者部分转载、摘录，请在文章明显位置注明作者和原文链接。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/scala.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;继承&quot;&gt;&lt;a href=&quot;#继承&quot; class=&quot;headerlink&quot; title=&quot;继承&quot;&gt;&lt;/a&gt;继承&lt;/h1&gt;&lt;p&gt;Scala中的继承与Java有着明显的不同，体现在下
      
    
    </summary>
    
    
      <category term="tools" scheme="http://sparkx.com.cn/categories/tools/"/>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/tags/spark/"/>
    
      <category term="工具" scheme="http://sparkx.com.cn/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="scala" scheme="http://sparkx.com.cn/tags/scala/"/>
    
  </entry>
  
  <entry>
    <title>scala 快速入门2</title>
    <link href="http://sparkx.com.cn/scala/scala-note2/"/>
    <id>http://sparkx.com.cn/scala/scala-note2/</id>
    <published>2019-11-30T11:29:52.000Z</published>
    <updated>2019-12-09T13:48:28.685Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/scala.png" alt=""></p><h1 id="Scala类"><a href="#Scala类" class="headerlink" title="Scala类:"></a>Scala类:</h1><ul><li>类定义、字段、方法<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span></span>&#123; <span class="comment">//Counter是类名 </span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> privateValue = <span class="number">0</span> <span class="comment">//定义一个私有字段</span></span><br><span class="line"><span class="comment">//Scala没有提供getter和setter方法，可以通过定义类似getter和setter的方法，分别叫做value和value_=</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">value</span> </span>= privateValue <span class="comment">//定义一个方法，方法名称就是原来我们想要的字段名称</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">value_=</span> </span>(newValue: <span class="type">Int</span>)&#123;</span><br><span class="line"><span class="keyword">if</span>(newValue &gt;<span class="number">0</span> ) privateValue = newValue <span class="comment">//只有提供新值是正数，才允许修改</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">increment</span></span>():<span class="type">Unit</span> = &#123; value += <span class="number">1</span> &#125; <span class="comment">//increment是类方法,Unit后面的等号和大括号后面包含了该方法要执行的具体操作语句，如果只有一行语句，那么也可以直接去掉大括号；</span></span><br><span class="line"><span class="comment">//def increment():Unit = value += 1 等价于上面语句</span></span><br><span class="line"><span class="comment">//def increment() &#123;value += 1&#125; 等价于上面语句</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">increment2</span></span>(step:<span class="type">Int</span>):<span class="type">Unit</span> = &#123;value += <span class="type">Step</span>&#125;<span class="comment">//带参方法，参数为步长的值</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">current</span></span>():<span class="type">Int</span> = &#123; value &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">MyCounter</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args:<span class="type">Array</span>[<span class="type">String</span>])&#123;</span><br><span class="line"><span class="keyword">val</span> myCounter = <span class="keyword">new</span> <span class="type">Counter</span> <span class="comment">//new Counter() //使用new关键字生成对象</span></span><br><span class="line">myCounter.increment() <span class="comment">//或者也可以不用圆括号，写成myCounter.increment</span></span><br><span class="line">myCounter.increment2(<span class="number">5</span>)<span class="comment">// 这里使用带参方法，设置步长5，每次增加5</span></span><br><span class="line">print(myCounter.value) <span class="comment">//不用getXxx获取字段的值</span></span><br><span class="line">myCounter.value = <span class="number">3</span> <span class="comment">// 不用setXxx设置字段值</span></span><br><span class="line">print(myCounter.current)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>辅助构造器<br>Scala构造器包含一个主构造器和若干个(0个或多个)辅助构造器；<br>辅助构造器的名称this，每个辅助构造器都必须调用一个此前定义的辅助构造器或主构造器；<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">counter</span></span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> value = <span class="number">0</span> <span class="comment">//value用来存储计时器的起始值</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> name = <span class="string">""</span> <span class="comment">//表示计数器的名称</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> mode = <span class="number">1</span> <span class="comment">//mode用来表示计数器类型(比如，1表示步数计数器，2表示时间计数器)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">this</span></span>(name:<span class="type">String</span>)&#123;<span class="comment">//第一个辅助构造器</span></span><br><span class="line"><span class="keyword">this</span>() <span class="comment">//调用主构造器</span></span><br><span class="line"><span class="keyword">this</span>.name = name</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">this</span></span>(name:<span class="type">String</span>,mode:<span class="type">Int</span>)&#123;<span class="comment">//第二个辅助构造器</span></span><br><span class="line"><span class="keyword">this</span>(name) <span class="comment">//调用前一个辅助构造器</span></span><br><span class="line"><span class="keyword">this</span>.mode = mode</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">increment</span></span>(step:<span class="type">Int</span>):<span class="type">Unit</span> = &#123;value += step&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">current</span></span>():<span class="type">Int</span> = &#123;value&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">info</span></span>():<span class="type">Unit</span> = &#123;printf(<span class="string">"Name:%s and mode is %d\n"</span>,name,mode)&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">MyCounter</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(ars:<span class="type">Array</span>[<span class="type">String</span>])&#123;</span><br><span class="line"><span class="keyword">val</span> myCounter1 = <span class="keyword">new</span> <span class="type">Counter</span> <span class="comment">//主构造器</span></span><br><span class="line"><span class="keyword">val</span> myCounter2 = <span class="keyword">new</span> <span class="type">Counter</span>(<span class="string">"Runner"</span>) <span class="comment">//第一个辅助构造器，计数器的名称设置为Runner，用来计算跑步步数</span></span><br><span class="line"><span class="keyword">val</span> myCounter3 = <span class="keyword">new</span> <span class="type">Counter</span>(<span class="string">"Timer"</span>,<span class="number">2</span>) <span class="comment">//第二个辅助构造器，计数器的名称设置为Timer，用来计算秒数</span></span><br><span class="line">myCounter1.info <span class="comment">//显示计数器信息</span></span><br><span class="line">myCounter1.increment(<span class="number">1</span>) <span class="comment">//设置步长</span></span><br><span class="line">printf(<span class="string">"Current value is : %d\n"</span> ,myCounter1.current)<span class="comment">//显示计数器当前值</span></span><br><span class="line">myCounter2.info <span class="comment">//显示计数器信息</span></span><br><span class="line">myCounter2.increment(<span class="number">2</span>) <span class="comment">//设置步长</span></span><br><span class="line">printf(<span class="string">"Current value is : %d\n"</span>,myCounter2.current) <span class="comment">//显示计数器当前值</span></span><br><span class="line">myCounter3.info <span class="comment">//显示计数器信息</span></span><br><span class="line">myCounter3.increment(<span class="number">3</span>) <span class="comment">//设置步长</span></span><br><span class="line">printf(<span class="string">"Current value is : %d\n"</span>,myCounter3.current) <span class="comment">//显示计数器当前值</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">运行结果：</span><br><span class="line"><span class="type">Name</span>: and mode is <span class="number">1</span></span><br><span class="line"><span class="type">Current</span> value is : <span class="number">1</span></span><br><span class="line"><span class="type">Name</span>:<span class="type">Runner</span> and mode is <span class="number">1</span></span><br><span class="line"><span class="type">Current</span> value is : <span class="number">2</span></span><br><span class="line"><span class="type">Name</span>:<span class="type">Timer</span> and mode is <span class="number">2</span></span><br><span class="line"><span class="type">Current</span> value is : <span class="number">3</span></span><br></pre></td></tr></table></figure></li><li>主构造器<br>Scala的每个类都有主构造器，但是，Scala的主构造器和Java有着明显的不同，Scala的主构造器是整个类体，需要在类名成后面罗列出构造器所需要的所有参数，这些参数被编译成字段，字段的值就是创建对象时传入的参数的值。<br>对于上面给计数器设置name和mode的例子，使用辅助构造器来对name和mode的值进行设置，现在重新使用主构造器来设置name和mode的值。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter2</span> (<span class="params">val name:<span class="type">String</span>,val mode:<span class="type">Int</span></span>)</span>&#123;<span class="comment">//直接在类名后面括号中定义name和mode</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> value = <span class="number">0</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">increment</span></span>(step:<span class="type">Int</span>):<span class="type">Unit</span> = &#123;value += step&#125;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">current</span></span>():<span class="type">Int</span> = &#123;value&#125;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">info</span></span>():<span class="type">Unit</span> = &#123;printf(<span class="string">"Name:%s and mode is %d\n"</span>,name,mode)&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">MyCounter2</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> myCounter2 = <span class="keyword">new</span> <span class="type">Counter2</span>(<span class="string">"Timer"</span>,<span class="number">2</span>)</span><br><span class="line">    myCounter2.info()</span><br><span class="line">    myCounter2.increment(<span class="number">1</span>)</span><br><span class="line">    printf(<span class="string">"Current value is:%d\n"</span>,myCounter2.current())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">运行结果：</span><br><span class="line"><span class="type">The</span> id of zhangsan <span class="number">1.</span></span><br><span class="line"><span class="type">The</span> id of lisi <span class="number">2.</span></span><br></pre></td></tr></table></figure></li><li>单例对象<br>Scala并没有提供Java那样的静态方法或静态字段，但是，可以采用object关键字实现单例对象，具备和Java静态方法同样的功能。<br>单例对象的定义和类的定义很相似，只不过使用的是object关键字定义。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Person</span></span>&#123;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> lastId = <span class="number">0</span> <span class="comment">//一个人的身份编号</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">newPersond</span></span>()=&#123;</span><br><span class="line">lastId += <span class="number">1</span></span><br><span class="line">lastId</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>伴生对象<br>在Java中，经常需要用到同时包含实例方法和静态方法的类，在Scala中可以通过伴生对象来实现。<br>当单例对象与某个类具有相同的名称时，它被称为这个类的“伴生对象”。<br>类和它的伴生对象必须存在于同一个文件中，而且可以相互访问是有成员(字段和方法)。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">val</span> id  = <span class="type">Person</span>.newPersonId()<span class="comment">//调用伴生对象的方法</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> name = <span class="string">""</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">this</span></span>(name:<span class="type">String</span>)&#123;</span><br><span class="line">    <span class="keyword">this</span>()</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">info</span></span>()&#123;printf(<span class="string">"The id of %s %d.\n"</span>,name,id)&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> lastId = <span class="number">0</span>;<span class="comment">//身份编号</span></span><br><span class="line">  <span class="keyword">private</span> <span class="function"><span class="keyword">def</span> <span class="title">newPersonId</span></span>()=&#123;</span><br><span class="line">    lastId += <span class="number">1</span></span><br><span class="line">    lastId</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> person1 = <span class="keyword">new</span> <span class="type">Person</span>(<span class="string">"zhangsan"</span>)</span><br><span class="line">    <span class="keyword">val</span> person2 = <span class="keyword">new</span> <span class="type">Person</span>(<span class="string">"lisi"</span>)</span><br><span class="line">    person1.info()</span><br><span class="line">    person2.info()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">运行结果：</span><br><span class="line"><span class="type">The</span> id of zhangsan <span class="number">1.</span></span><br><span class="line"><span class="type">The</span> id of lisi <span class="number">2.</span></span><br></pre></td></tr></table></figure>Scala源码编译后都变成JVM字节码，实际上在编译上面的源码文件后，在Scala里面的class和object在Java层面都会被合二为一，classs里面的成员成了实例成员，object成员成了静态成员。<br>伴生对象Person中的newPersonId前面的修饰符private去掉后进行编译，再反编译查看编译的代码可以看到newPersonId被编译成了Person类的static成员。<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//进入类所在目录进行编译</span></span><br><span class="line">Administrator@WIN7-<span class="number">1705071516</span> MINGW64 <span class="regexp">/d/</span>IdeaProjects<span class="regexp">/ScalaTest/</span>src<span class="regexp">/main/</span>scala<span class="regexp">/com/</span>scala<span class="regexp">/study/</span>ch1 (master)</span><br><span class="line">$ scalac Person.scala</span><br><span class="line">在D:\IdeaProjects\ScalaTest\src\main\scala\com\scala\study\ch1\com\scala\study\ch1目录下生成两个文件Person$.<span class="keyword">class</span>,Person.<span class="keyword">class</span></span><br><span class="line"><span class="comment">//使用javap命令反编译</span></span><br><span class="line">D:\IdeaProjects\ScalaTest\src\main\scala\com\scala\stud</span><br><span class="line">警告: 二进制文件Person包含com.scala.study.ch1.Person</span><br><span class="line">Compiled <span class="keyword">from</span> <span class="string">"Person.scala"</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> com.scala.study.ch1.Person &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> main(java.lang.String[]);</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> newPersonId();<span class="comment">//编译成了静态成员</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> info();</span><br><span class="line">  <span class="keyword">public</span> com.scala.study.ch1.Person();</span><br><span class="line">  <span class="keyword">public</span> com.scala.study.ch1.Person(java.lang.String);</span><br></pre></td></tr></table></figure></li><li>apply方法和update方法<br>Scala里面经常用到对象的apply和udpate方法，实际上这两个方法都会遵循相关约定被调用，约定如下：<br>用括号传递给变量(对象)一个或多个参数时，Scala会把它转换成对apply方法的调用；<br>当对带有括号并包括一到若干个参数的对象进行赋值时，编译器将调用对象的update方法，在调用时，是把括号里的参数和等号右边的对象一起作为update方法的输入参数来执行调用；<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestApplyClass</span> &#123;</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span><span class="params">(<span class="symbol">param:</span>String)</span></span> <span class="symbol">:String</span>  = &#123;<span class="regexp">//</span>类中定义apply方法</span><br><span class="line">    printf(<span class="string">"apply method called,param is :%s\n"</span>,param)</span><br><span class="line">    <span class="string">"hello world"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">object TestApplySingleObject&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span><span class="params">(<span class="symbol">param1:</span>String,<span class="symbol">param2:</span>String)</span></span><span class="symbol">:String=</span>&#123;<span class="regexp">//</span>单例中定义apply方法</span><br><span class="line">    println(<span class="string">"apply methhod called"</span>)</span><br><span class="line">    param1+<span class="string">" and "</span>+ param2</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(<span class="symbol">args:</span> Array[String])</span></span>: Unit = &#123;</span><br><span class="line">    val obj = new TestApplyClass</span><br><span class="line">    println(obj(<span class="string">"test"</span>))</span><br><span class="line">    val obj2 = TestApplySingleObject(<span class="string">"zhansan"</span>,<span class="string">"lisi"</span>)</span><br><span class="line">    println(obj2)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">运行结果：</span><br><span class="line">apply method called,param is <span class="symbol">:test</span></span><br><span class="line">hello world</span><br><span class="line">apply methhod called</span><br><span class="line">zhansan <span class="keyword">and</span> lisi</span><br></pre></td></tr></table></figure>再来测试一个伴生类和伴生对象的apply方法实例。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestApplyClassAndObject</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ApplyTest</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>() = println(<span class="string">"apply method in class is called"</span>)</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">greetingOfClass</span></span>:<span class="type">Unit</span> = &#123;</span><br><span class="line">    println(<span class="string">"greeting method in class is called"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">ApplyTest</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>()=&#123;</span><br><span class="line">    println(<span class="string">"apply method in object is called"</span>)</span><br><span class="line">    <span class="keyword">new</span> <span class="type">ApplyTest</span>()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">TestApplyClassAndObject</span></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> a = <span class="type">ApplyTest</span>();<span class="comment">//这里调用伴生对象中的apply方法</span></span><br><span class="line">    a.greetingOfClass</span><br><span class="line">    a()<span class="comment">//这里调用半生类中的apply方法</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">运行结果:</span><br><span class="line">apply method in <span class="class"><span class="keyword">object</span> <span class="title">is</span> <span class="title">called</span></span></span><br><span class="line"><span class="class"><span class="title">greeting</span> <span class="title">method</span> <span class="title">in</span> <span class="title">class</span> <span class="title">is</span> <span class="title">called</span></span></span><br><span class="line"><span class="class"><span class="title">apply</span> <span class="title">method</span> <span class="title">in</span> <span class="title">class</span> <span class="title">is</span> <span class="title">called</span></span></span><br></pre></td></tr></table></figure>从上面代码看出，执行val a = ApplyTest()是，会导致apply方法调用并返回该方法调用的值，也就是ApplyTest的实例化对象。当执行a()时，又会导致调用伴生类的apply方法，所以，我们可以在伴生类的apply方法中写入一些处理逻辑，这样就可以把传入的参数赋值给实例化对象的变量。<br>其实，Scala中Array对象就定义了apply方法，我们可以采用val arr = Array(“Java”,”Scala”,”Spark”)方法，即不用new关键字和构造器初始化数组，而是调用伴生对象Array的apply方法完成数组初始化。<br>实际上，update方法也是类似的，比如：<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> strArr = <span class="keyword">new</span> <span class="type">Array</span>[<span class="type">String</span>](<span class="number">3</span>)<span class="comment">//声明一个长度3的字符串数组，每个元素初始化null</span></span><br><span class="line">strArr(<span class="number">0</span>) = <span class="string">"Java"</span> <span class="comment">//实际上调用了伴生类Array中的update方法，执行strArr.update(0,"Java")</span></span><br></pre></td></tr></table></figure>之所以没有采用java中的方括号strArr[0],而是采用圆括号的形式strArr(0)是因为存在上述update机制。<br>当对带有括号并包括一到若干参数的对象进行赋值时，编译器将调用对象的update方法，在调用是，是把括号里的参数和等号右边的对象一起作为update的输入参数来执行调用。</li></ul><hr><p><strong>声明:</strong><br>作者:上海IT技术圈<br>本文版权归作者和上海IT技术圈共有，任何人或团体、机构全部转载或者部分转载、摘录，请在文章明显位置注明作者和原文链接。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/scala.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h1 id=&quot;Scala类&quot;&gt;&lt;a href=&quot;#Scala类&quot; class=&quot;headerlink&quot; title=&quot;Scala类:&quot;&gt;&lt;/a&gt;Scala类:&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;类定
      
    
    </summary>
    
    
      <category term="tools" scheme="http://sparkx.com.cn/categories/tools/"/>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/tags/spark/"/>
    
      <category term="工具" scheme="http://sparkx.com.cn/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="scala" scheme="http://sparkx.com.cn/tags/scala/"/>
    
  </entry>
  
  <entry>
    <title>scala 快速入门1</title>
    <link href="http://sparkx.com.cn/scala/scala-note/"/>
    <id>http://sparkx.com.cn/scala/scala-note/</id>
    <published>2019-11-29T23:18:18.000Z</published>
    <updated>2019-12-09T13:48:28.628Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/images/scala.png" alt=""><br>学习Spark过程中查看源码是不是很多都是Scala语言写的？不了解Scala怎么办？这里有一份Scala快速入门课，助力你快速掌握Scala的基本语法和使用。<br>本博客只是Scala入门篇，要想真正掌握的话还需要系统学习滴！<a href="https://docs.scala-lang.org/getting-started/index.html" target="_blank" rel="noopener">Scala Getting Started</a></p><h1 id="Scala简介"><a href="#Scala简介" class="headerlink" title="Scala简介"></a>Scala简介</h1><p>Scala是一门类Java的多范式编程语言，它整合了面向对象编程和函数式编程的最佳特性。具体来讲：</p><ul><li>Scala运行与Java虚拟机（JVM）之上，并且兼容现在有的Java程序</li><li>Scala是一门纯粹的面向对象语言，也是一门函数式语言</li></ul><h1 id="Scala安装"><a href="#Scala安装" class="headerlink" title="Scala安装"></a>Scala安装</h1><p>Scala安装和平时安装的软件一样，也很简单，但是前提条件是必须先安装JDK。</p><blockquote><p>Scala安装参考：<a href="https://www.cnblogs.com/freeweb/p/5623372.html" target="_blank" rel="noopener">Scala安装以及在IDEA中配置Scala</a></p></blockquote><h1 id="Scala基础介绍"><a href="#Scala基础介绍" class="headerlink" title="Scala基础介绍"></a>Scala基础介绍</h1><ul><li>声明值和变量<br>Scala有两种类型的变量<ul><li>val : 是不可变的，在声明时就必须被初始化，二期初始化后就不能再赋值；</li><li>var : 是可变的，声明的时候需要进行初始化，初始化yihou还可以再次对其赋值；<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> myStr = <span class="string">"hello world"</span> <span class="comment">//声明val变量并赋值</span></span><br><span class="line">myStr: <span class="type">String</span> = hello world</span><br><span class="line"></span><br><span class="line">scala&gt; myStr = <span class="string">"hello scala"</span> <span class="comment">//val变量再次赋值会保存</span></span><br><span class="line">&lt;console&gt;:<span class="number">12</span>: error: reassignment to <span class="keyword">val</span></span><br><span class="line">       myStr = <span class="string">"hello scala"</span></span><br><span class="line">             ^</span><br><span class="line">scala&gt; <span class="keyword">var</span> myStr2 = <span class="string">"hello world"</span> <span class="comment">//声明var变量并赋值</span></span><br><span class="line">myStr2: <span class="type">String</span> = hello world</span><br><span class="line"></span><br><span class="line">scala&gt; myStr2 = <span class="string">"hello scala"</span> <span class="comment">//修改变量的值</span></span><br><span class="line">myStr2: <span class="type">String</span> = hello scala</span><br><span class="line"></span><br><span class="line">scala&gt; print(myStr2) <span class="comment">//打印修改后的值，后面的值覆盖了前面的值</span></span><br><span class="line">hello scala</span><br><span class="line"><span class="comment">//小技巧：在Scala解释器中输入多行代码</span></span><br><span class="line">scala&gt; <span class="keyword">val</span> myStr3 =</span><br><span class="line">     | <span class="string">"hello world"</span></span><br><span class="line">myStr3: <span class="type">String</span> = hello world</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> myStr4 =</span><br><span class="line">     |</span><br><span class="line">     |</span><br><span class="line"><span class="type">You</span> typed two blank lines.  <span class="type">Starting</span> a <span class="keyword">new</span> command.</span><br></pre></td></tr></table></figure></li></ul></li><li>基本数据类型和操作<br>Scala的数据类型包括：Byte、Char、Short、Int、Long、Float、Double和Boolean和Java不同的是，在Scala中，这些类型都是”类”，并且都是包scala的成员，比如，Int的全名是scala.Int。对于字符串，Scala用java.lang.String类来表示字符串。<table><thead><tr><th>值类型</th><th align="left">范围</th></tr></thead><tbody><tr><td>Byte</td><td align="left">8位有符号补码整数(-2^7~2^7-1)</td></tr><tr><td>Short</td><td align="left">16为有符号补码整数(-2^15~2^15-1)</td></tr><tr><td>Int</td><td align="left">32位有符号补码整数(-2^31~2^31-1)</td></tr><tr><td>Long</td><td align="left">64位有符号补码整数(-2^63~2^63-1)</td></tr><tr><td>Char</td><td align="left">16位无符号Unicode字符(0~2^16-1)</td></tr><tr><td>String</td><td align="left">字符序列</td></tr><tr><td>Float</td><td align="left">32为IEEE754单精度浮点</td></tr><tr><td>Double</td><td align="left">64为IEEE754双精度浮点</td></tr><tr><td>Boolean</td><td align="left">true或false</td></tr></tbody></table></li></ul><p><strong>操作符</strong>:在Scala中，可以使用加(+)、减(-)、乘(<em>)、除(/)、余数(%)等操作符，而且这些操作符就是方法。例如，5+3 和5.+3是等价的，也就是a 方法 b 等价于 a.方法(b)<br>前者是或者的简写形式，这里的+是方法名，是Int类中的一个方法。<br>Scala中没有 ++ 和 – 操作符，当需要递增和递减时可以使用 i += 1或者i -= 1;<br>*</em>富包装类**<br>    + 除了基本类型的各种操作外scala在富包装类中提供了许多常用运算方法。<br>    + 每个基本类型都对应一个富包装类，如,Int对应RichInt,String对应RichString，富包装类位于scala.runtime中。<br>    + 对一个基本类型的对象调用其富包装类提供的方法时，Scala会自动通过隐式转换将该对象转换成对应的富包装类行，然后调用相应的方法。</p><ul><li>Range<br>在执行for循环是，经常会用到数值序列，比如，i的值从1循环到5，就可以用Range实现，Range可以支持创建不同数据类型的数值序列，包括Int、Long、Float、Double、Char、BigInt、BigDecimal等<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="number">1</span> to <span class="number">5</span> <span class="comment">//创建从1到5的数值序列，包含区间终点5,步长默认1</span></span><br><span class="line">res1: scala.collection.immutable.<span class="type">Range</span>.<span class="type">Inclusive</span> = <span class="type">Range</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="number">1.</span>to(<span class="number">5</span>) <span class="comment">//同上</span></span><br><span class="line">res2: scala.collection.immutable.<span class="type">Range</span>.<span class="type">Inclusive</span> = <span class="type">Range</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="number">1</span> until <span class="number">5</span> <span class="comment">//创建从1到5的数值序列，不包含区间终点5,步长默认1</span></span><br><span class="line">res3: scala.collection.immutable.<span class="type">Range</span> = <span class="type">Range</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="number">1</span> to <span class="number">10</span> by <span class="number">2</span> <span class="comment">//创建从1到10的数值序列，包含终点10,步长2</span></span><br><span class="line">res4: scala.collection.immutable.<span class="type">Range</span> = <span class="type">Range</span>(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="number">0.5</span>f to <span class="number">5.9</span>f by <span class="number">0.8</span>f <span class="comment">//创建Float类型的数值序列，从0.5f到5.9f,步长为0.8f</span></span><br><span class="line">res5: scala.collection.immutable.<span class="type">NumericRange</span>[<span class="type">Float</span>] = <span class="type">NumericRange</span>(<span class="number">0.5</span>, <span class="number">1.3</span>, <span class="number">2.1</span>, <span class="number">2.8999999</span>, <span class="number">3.6999998</span>, <span class="number">4.5</span>, <span class="number">5.3</span>)</span><br></pre></td></tr></table></figure></li><li>控制台输入和输出语句<ul><li>从控制台读使用以read为前缀的方法:readInt、readDouble、readBtye、readShort、readFloat、readLong、readChar、readBoolean及readLine分别对应9种基本数据类型，其中前8种方法没有参数，readLine可以不提供参数，也可以带一个字符串参数提示。</li><li>这些函数都属于对象scala.io.StdIn的方法，使用前必须导入。</li><li>输出语句使用print()、println()、printf()<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">import</span> io.<span class="type">StdIn</span>._</span><br><span class="line"><span class="keyword">import</span> io.<span class="type">StdIn</span>._</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">var</span> i = readInt()</span><br><span class="line">i: <span class="type">Int</span> = <span class="number">5222</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">var</span> str = readLine(<span class="string">"please input your na</span></span><br><span class="line"><span class="string">please input your name:str: String = zhangshan</span></span><br></pre></td></tr></table></figure></li></ul></li><li>读写文件夹<br>写入文件使用java.io.PrintWriter实现<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">import</span> java.io.<span class="type">PrintWriter</span></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">PrintWriter</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> out = <span class="keyword">new</span> <span class="type">PrintWriter</span>(<span class="string">"D:\\test\\scala\\output.txt"</span>)</span><br><span class="line">out: java.io.<span class="type">PrintWriter</span> = java.io.<span class="type">PrintWriter</span>@<span class="number">283</span>ab206</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">for</span> (i &lt;- <span class="number">1</span> to <span class="number">5</span>) out.println(i)</span><br><span class="line"></span><br><span class="line">scala&gt; out.close()</span><br></pre></td></tr></table></figure>读取文件使用Scala.io.Source的getLines方法实现对文件所有行的读取<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">import</span> scala.io.<span class="type">Source</span></span><br><span class="line"><span class="keyword">import</span> scala.io.<span class="type">Source</span></span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> inputFile = <span class="type">Source</span>.fromFile(<span class="string">"D:\\test\\scala\\output.txt"</span>)</span><br><span class="line">inputFile: scala.io.<span class="type">BufferedSource</span> = non-empty iterator</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> lines = inputFile.getLines</span><br><span class="line">lines: <span class="type">Iterator</span>[<span class="type">String</span>] = non-empty iterator</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">for</span> (line &lt;- lines) print(line)</span><br><span class="line"><span class="number">12345</span></span><br></pre></td></tr></table></figure></li><li>异常处理<br>在Scala中，try catch是一个表达式，不像Java是语句，Scala中的try catch是有返回值的。<br>catch中的下划线_是通配符的意思，意思是匹配所有的对象，<br>finally意思是无论有没有异常发生，我们总是会执行finally里面的代码块。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.&#123;<span class="type">FileNotFoundException</span>, <span class="type">FileReader</span>, <span class="type">IOException</span>&#125;</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">  ......</span><br><span class="line">&#125;<span class="keyword">catch</span> &#123;</span><br><span class="line"> <span class="keyword">case</span> ex: <span class="type">FileNotFoundException</span> =&gt;</span><br><span class="line">   <span class="comment">//文件不存在的时候操作</span></span><br><span class="line"> <span class="keyword">case</span> ex : <span class="type">IOException</span> =&gt;</span><br><span class="line">   <span class="comment">//I/O错误时操作</span></span><br><span class="line">&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>控制结构</li></ul><p><strong>if表达式</strong><br>if(x&gt;0){</p><p>}else if(x==0){</p><p>}else{</p><p>}<br>与java不同的是Scala的if表达式的值可以赋值给变量<br>val x = 1<br>val a = if(x&gt;0) 1 else -1<br><strong>while循环</strong><br>var i = 5<br>while(i&gt;0){<br>    i -= 1<br>    print(i)<br>}<br><strong>do … while循环</strong><br>var i = 0<br>do{<br>    i += 1<br>    print(i)<br>}while(i&lt;5)<br><strong>for循环</strong><br>for(变量&lt;-表达式) 语句块，其中“变量 &lt;- 表达式”被称为“生成器(generator)”。<br>表达式后面可以添加“守卫(guard)”表达式，进行过滤，比如，只输入出1到5的偶数：<br>for(i&lt;-1 to 5 if i%2==0) println(i)<br>Scala 也支持“多个生成器”的情形，可以用分号分割开，如：for(i &lt;- 1 to 5;j &lt;- 1 to 3) println(i<em>j)<br>也可以给每个生成器添加一个“守卫”，如：for(i &lt;- 1 to 5 if i%2==0;j &lt;- 1 to 3 if j!=i) println(i</em>j)<br>Scala的for结构可以在每次执行的时候创造一个值，然后将包含了所有产生的值的集合作为for循环表达式的结果返回，集合的类型有生成器中的集合类型确定；<br>通过for循环遍历一个或多个集合，对集合中的元素“推导”，从而计算得到新的集合，用于后续的其他处理；<br>for (变量 &lt;- 表达式) yield {语句块}</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> r = <span class="keyword">for</span>(i &lt;- <span class="number">1</span> to <span class="number">5</span> <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">0</span>) <span class="keyword">yield</span>&#123;println(i);i&#125;</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line">r: scala.collection.immutable.<span class="type">IndexedSeq</span>[<span class="type">Int</span>] = <span class="type">Vector</span>(<span class="number">2</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure><ul><li>数据结构<ul><li>容器(Collection)</li><li>列表(List)</li><li>集合(Set)</li><li>映射(Map)</li><li>迭代器(Iterator)</li><li>数组(Array)</li><li>元组(Tuple)</li></ul></li></ul><p><strong>下面分别讲解scala的数据结构</strong></p><ul><li>容器(Collection)<br>根据容器中元素组织方式和操作方式，可以区分为有序和无序、可变和不可变等不同的容器类别；<br>Scala用三个包组织容器类：scala.collection、scala.collection.nutable和scala.collection.immutable；</li><li>列表(List)<br>Scala的List一旦被定义其值就不能改变，因此声明List时必须初始化<br>var strList = List(“apple”,”oranges”, “pears”)<br>strList.head //返回列表第一个元素值<br>strList.tail //返回除第一个元素外的其他值构成的新列表<br>val otherList = “abc”::strList //使用”::”操作符拼接生成新的列表<br>val intList = 1::2::3::Nil 与val intList = List(1,2,3)等效 //Scala定义了一个空列表对象Nil，可以将多个元素用操作符”::”串起来初始一个列表<br>val dim:List[List[Int]] = List(List(1,2,3),List(4,5,6),List(7,8,9))//二维List</li><li>集合(Set)<br>Set集合是以“哈希”方法对元素的值进行组织，并且不重复的无顺序的，可以快速查找某个元素；<br>缺省创建的是不可变的集合scala.collection.immutable，可以使用符号”+=”添加元素到Set中。<br>var mySet = Set(“Java”,”Scalc”)<br>mySet += “Spark”<br>如果要创建可变集合,则要提前引入scala.collection.mutable.Set<br>val myMutableSet = Set(“Database”,”BigData”)<br>myMutableSet += “Other”</li><li>映射(Map)<br>映射是(k,v)对的形式存储，默认Scala使用不可变的映射(scala.collection.immutable.Map)，如果使用可变映射必须导入scala.collection.mutable.Map,<br>val map = Map(“a”-&gt;111,”b”-&gt;222,”c”-&gt;333)<br>print(map(“a”))//获取值，这种方式如果给定的键不存在，则会抛出异常，为此，访问前可以先调用contains方法确定键是否存在<br>val v = if(map.contains(“a”)) map(“a”) else 0<br>print(v)<br>//导入可变的map<br>import scala.collection.mutable.Map<br>val map2 = Map(“a”-&gt;111,”b”-&gt;222,”c”-&gt;333)<br>map2(“a”)=123//更新已有元素值<br>map2(“d”)=444//添加新元素<br>map2 +=(“e” -&gt;555)//可以用+= 添加一个新元素<br>map2 +=(“f” -&gt;666,”g”-&gt;777)//同时添加两个元素<br>迭代映射语法:for((k,v)&lt;-映射) 语句块<br>for((k,v)&lt;-map2) print(“k:”+k+”,v:”+v) //遍历key和value<br>for(k &lt;- map2.keys) print(k) //只遍历key<br>for(v &lt;- map2.values) print(v)//只遍历value</li><li>迭代器(Iterator)<br>在Scala中，迭代器不是一个集合，但是提供了访问集合的一种方法；<br>迭代器包含两个基本操作：next和hasNext，next可以返回迭代器的下一个元素，hasNext用于检测是否还有下一个元素；<br>val iter = Iterator(“Java”,”Scala”,”Spark”)<br>while(iter.hasNext){<br>  print(iter.next())<br>}<br>for(elem &lt;- iter){<br>  print(elem)<br>}<br>迭代器有两个方法返回迭代器：    grouped返回元素的增量分块；sliding生成一个滑动元素的窗口，效果如下：<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> xs = <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line">xs: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> grd = xs grouped <span class="number">3</span></span><br><span class="line">grd: <span class="type">Iterator</span>[<span class="type">List</span>[<span class="type">Int</span>]] = non-empty iterator</span><br><span class="line"></span><br><span class="line">scala&gt; grd.next()</span><br><span class="line">res12: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; grd.next()</span><br><span class="line">res14: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">val</span> sli = xs sliding <span class="number">3</span></span><br><span class="line">sli: <span class="type">Iterator</span>[<span class="type">List</span>[<span class="type">Int</span>]] = non-empty iterator</span><br><span class="line"></span><br><span class="line">scala&gt; sli.next()</span><br><span class="line">res15: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; sli.next()</span><br><span class="line">res16: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; sli.next()</span><br><span class="line">res17: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure></li><li>数组(Array)<br>数组是一种可变的、可索引的、元素具有相同类型的数据集合，可以通过显示指定类型或者通过隐式判断来实例化一个数组。<br>val arr = new Array<a href="3">Int</a>//声明长度为3的整型数组，每个元素初始为0<br>arr(0) = 11//给数组赋值<br>arr(1) = 22<br>arr(2) = 33<br>val strArr = new Array<a href="3">String</a>//声明长度为3的字符串数组，每个元素初始为null<br>strArr(0) = “Java”<br>strArr(1) = “Scala”<br>strArr(2) = “Spark”<br>for(i &lt;- 0 to 2) print(strArr(i)) //变量数组元素<br>可以不给出数组类型，Scala会自动根据提供的初始化数据来推断出数组的类型：<br>val intArr = Array(1,2,3)<br>val strArr = Array(“aa”,”bb”,”cc”)<br>Array提供了函数ofDim来定义二维和三维数组，用法如下：<br>val myMatrix = Array.ofDim<a href="3,4">Int</a>//实际就是Array[Array[Int]]<br>val myCube = Array.ofDim<a href="3,2,4">String</a>//实际就是Array[Array[Array[String]]<br>可以使用多级圆括号来访问多维数组的元素，利润myMatrix(0)(1)返回第一行第二列的元素；<br>Array类型定义的数组属于定长数组，其长度在初始化后就不能改变，如果要定义边长数组，需要使用ArrayBuffer参数类型，位于scala.collection.mutable中，如：<br>import scala.collection.mutable.ArrayBuffer<br>val arrB = ArrayBuffer(10,20,30)<br>arrB += 40 //添加元素<br>arrB.insert(2,60,40) //指定位置添加元素<br>arrB -= 40 //删除元素<br>var temp arrB.remove(2) //删除元素</li><li>元组(Tuple)<br>元组是不同类型的值的聚集，元组和列表不同，列表各个元素必须是相同类型，而元组可以包含不同类型的元素:<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> tuple = (<span class="string">"java"</span>,<span class="number">123</span>,<span class="number">12.3</span>)</span><br><span class="line">tuple: (<span class="type">String</span>, <span class="type">Int</span>, <span class="type">Double</span>) = (java,<span class="number">123</span>,<span class="number">12.3</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; print(tuple._1)</span><br><span class="line">java</span><br><span class="line">scala&gt; print(tuple._2)</span><br><span class="line"><span class="number">123</span></span><br><span class="line">scala&gt; print(tuple._3)</span><br><span class="line"><span class="number">12.3</span></span><br></pre></td></tr></table></figure><h1 id="遍历操作"><a href="#遍历操作" class="headerlink" title="遍历操作"></a>遍历操作</h1></li></ul><p><strong>列表遍历:</strong><br>for循环列表：for(elem &lt;- List(1,2,3)) println(elem)<br>foreach循环列表：<code>List(1,2,3).foreach(elem =&gt; println(elem))</code>等价于<code>List(1,2,3).foreach(println)</code>等价于<code>List(1,2,3) foreach println</code>。<br><strong>映射遍历:</strong></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span>  books = <span class="type">Map</span>(<span class="string">"Scala"</span>-&gt;<span class="number">80</span>,<span class="string">"Spark"</span>-&gt;<span class="number">100</span>)</span><br><span class="line">books: scala.collection.immutable.<span class="type">Map</span>[<span class="type">String</span>,<span class="type">Int</span>] = <span class="type">Map</span>(<span class="type">Scala</span> -&gt; <span class="number">80</span>, <span class="type">Spark</span> -&gt; <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; <span class="keyword">for</span>((k,v) &lt;- books) println(k+<span class="string">":"</span>+v)</span><br><span class="line"><span class="type">Scala</span>:<span class="number">80</span></span><br><span class="line"><span class="type">Spark</span>:<span class="number">100</span></span><br><span class="line"></span><br><span class="line">scala&gt; books foreach &#123;<span class="keyword">case</span>(k,v) =&gt; println(k+<span class="string">":"</span>+v)&#125;</span><br><span class="line"><span class="type">Scala</span>:<span class="number">80</span></span><br><span class="line"><span class="type">Spark</span>:<span class="number">100</span></span><br><span class="line"></span><br><span class="line">scala&gt; books foreach &#123;kv =&gt; println(kv._1 +<span class="string">":"</span>+kv._2)&#125;</span><br><span class="line"><span class="type">Scala</span>:<span class="number">80</span></span><br><span class="line"><span class="type">Spark</span>:<span class="number">100</span></span><br></pre></td></tr></table></figure><p><strong>map操作</strong><br>map操作是针对集合的经典变换操作，它将某个函数应用到集合中的每个元素，并产生一个结果集合。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> books = <span class="type">List</span>(<span class="string">"Scala"</span>,<span class="string">"Spark"</span>)</span><br><span class="line">books: <span class="type">List</span>[<span class="type">String</span>] = <span class="type">List</span>(<span class="type">Scala</span>, <span class="type">Spark</span>)</span><br><span class="line">scala&gt; books.map(s =&gt; s.toUpperCase)</span><br><span class="line">res13: <span class="type">List</span>[<span class="type">String</span>] = <span class="type">List</span>(<span class="type">SCALA</span>, <span class="type">SPARK</span>)</span><br></pre></td></tr></table></figure><p><strong>flatMap操作</strong><br>flatMap是map的一种扩展。在flatMap中，会传入一个函数，该函数对每个输入都会返回一个集合（而不是一个元素），然后，flatMap把生成的多个集合“拍扁”成为一个集合。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; books.flatMap(s =&gt; s.toList)</span><br><span class="line">res14: <span class="type">List</span>[<span class="type">Char</span>] = <span class="type">List</span>(<span class="type">S</span>, c, a, l, a, <span class="type">S</span>, p, a, r, k)</span><br></pre></td></tr></table></figure><p>上面flatMap执行时，会把books中的每个元素都toList，生成List[Char]，最终，多个Char的集合被“拍扁”成一个集合。<br><strong>filter操作</strong><br>遍历一个集合并从中获取满足指定条件的元素组成一个新的集合。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; books.filter(elem=&gt;elem.contains(<span class="string">"c"</span>)) foreach println</span><br><span class="line"><span class="type">Scala</span></span><br></pre></td></tr></table></figure><p><strong>reduce操作</strong><br>reduce是二元操作对集合中的元素进行规约，包含reduceLeft和reduceRight两种操作，前者从集合头部开始，后再从尾部开始操作。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> list = <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">list: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; list.reduceLeft(_+_)</span><br><span class="line">res21: <span class="type">Int</span> = <span class="number">6</span></span><br><span class="line"><span class="comment">// 执行顺序</span></span><br><span class="line"><span class="comment">// 1+2 = 3</span></span><br><span class="line"><span class="comment">// 3+3 = 6</span></span><br><span class="line">scala&gt; list.reduceRight(_+_)</span><br><span class="line">res22: <span class="type">Int</span> = <span class="number">6</span></span><br><span class="line"><span class="comment">// 执行顺序</span></span><br><span class="line"><span class="comment">// 2+3 = 5</span></span><br><span class="line"><span class="comment">// 1+5 = 6</span></span><br></pre></td></tr></table></figure><p><strong>fold操作</strong><br>折叠（fold)操作和reduce(规约)操作比较类似。fold操作需要一个初始的“种子”值开始，并以该值作为上下文，处理集合中的每个元素。<br>也有foldLeft和foldRight函数，对于自身而言一般从左到右遍历。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; <span class="keyword">val</span> list = <span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">list: <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">scala&gt; list.fold(<span class="number">10</span>)(_*_)</span><br><span class="line">res24: <span class="type">Int</span> = <span class="number">60</span></span><br></pre></td></tr></table></figure><hr><p><strong>声明:</strong><br>作者:上海IT技术圈<br>本文版权归作者和上海IT技术圈共有，任何人或团体、机构全部转载或者部分转载、摘录，请在文章明显位置注明作者和原文链接。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;&lt;img src=&quot;/images/scala.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;学习Spark过程中查看源码是不是很多都是Scala语言写的？不了解Scala怎么办？这里有一份Scala快速入门课，助力你快速掌握Scala的基本语法和使用。&lt;br&gt;本博客只是Scala入门篇
      
    
    </summary>
    
    
      <category term="tools" scheme="http://sparkx.com.cn/categories/tools/"/>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/tags/spark/"/>
    
      <category term="工具" scheme="http://sparkx.com.cn/tags/%E5%B7%A5%E5%85%B7/"/>
    
      <category term="scala" scheme="http://sparkx.com.cn/tags/scala/"/>
    
  </entry>
  
  <entry>
    <title>spark stage划分</title>
    <link href="http://sparkx.com.cn/spark/spark-stage/"/>
    <id>http://sparkx.com.cn/spark/spark-stage/</id>
    <published>2019-11-28T11:23:02.000Z</published>
    <updated>2019-12-09T13:48:28.812Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Stage是什么"><a href="#Stage是什么" class="headerlink" title="Stage是什么"></a>Stage是什么</h2><p><code>Stage</code>是<code>Job</code>的基本调度单位，一个<code>Job</code>会分为多组<code>Task</code>，每组<code>Task</code>称为<code>Stage</code>，或者也被称为<code>TaskSet</code>，代表了一组关联的、相互之间没有<code>Shuffle</code>的依赖关系的任务组成的任务集。</p><h2 id="Stage划分方法"><a href="#Stage划分方法" class="headerlink" title="Stage划分方法"></a>Stage划分方法</h2><ul><li>在<code>DAG</code>中进行反方向解析，遇到宽依赖就断开，划分为一个stage；</li><li>遇到窄依赖就把当前的<code>RDD</code>加入到<code>Stage</code>中，将窄依赖尽量划分到同一个<code>Stage</code>中，可以实现流水线计算；</li></ul><p><img src="/images/spark/spark_stage_split.png" alt="根据RDD分区的依赖关系划分Stage"></p><p>上图是经典的<code>Stage</code>划分图,被分成三个<code>Stage</code>,在<code>Stage2</code>中，从<code>map</code>到<code>union</code>都是窄依赖，这两步操作可以形成一个流水操作。<br>流水操作实例分区7通过<code>map</code>操作生成的分区9，可以不用等待分区8到分区10这个<code>map</code>操作的计算结束，而是继续进行<code>union</code>操作，得到分区13，这样的流水执行大大提高了计算效率。</p><h2 id="源码分析Stage划分"><a href="#源码分析Stage划分" class="headerlink" title="源码分析Stage划分"></a>源码分析Stage划分</h2><p>Stage 位置: <code>org.apache.spark.scheduler.Stage</code></p><ul><li>Stage定义<br>其中rdd和parents分别记录的是切分处的RDD列表和父stage信息。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span>[scheduler] <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Stage</span>(<span class="params"></span></span></span><br><span class="line"><span class="class"><span class="params">    val id: <span class="type">Int</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    val rdd: <span class="type">RDD</span>[_],</span></span></span><br><span class="line"><span class="class"><span class="params">    val numTasks: <span class="type">Int</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    val parents: <span class="type">List</span>[<span class="type">Stage</span>],</span></span></span><br><span class="line"><span class="class"><span class="params">    val firstJobId: <span class="type">Int</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    val callSite: <span class="type">CallSite</span></span>)</span></span><br><span class="line"><span class="class">  <span class="keyword">extends</span> <span class="title">Logging</span> </span>&#123;......&#125;</span><br></pre></td></tr></table></figure></li><li>Stage两个子类<br>子类分别增加了一个重要的属性。<table><thead><tr><th>stage</th><th align="left">差异属性</th><th align="left">作用</th></tr></thead><tbody><tr><td><code>ShuffleMapStage</code></td><td align="left"><code>shuffleDep: ShuffleDependency[_, _, _]</code></td><td align="left">保存依赖信息</td></tr><tr><td><code>ResultStage</code></td><td align="left"><code>func: (TaskContext, Iterator[_]) =&gt; _</code></td><td align="left">保存action对应的处理函数</td></tr></tbody></table></li><li>处理事件<br><code>DAGScheduler</code>的<code>handleJobSubmitted</code>方法处理<code>JobSubmitted</code>事件，源码及解释如下：<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span>[scheduler] <span class="keyword">val</span> activeJobs = <span class="keyword">new</span> <span class="type">HashSet</span>[<span class="type">ActiveJob</span>]</span><br><span class="line"><span class="keyword">private</span>[scheduler] <span class="function"><span class="keyword">def</span> <span class="title">handleJobSubmitted</span></span>(jobId: <span class="type">Int</span>,</span><br><span class="line">     finalRDD: <span class="type">RDD</span>[_],</span><br><span class="line">     func: (<span class="type">TaskContext</span>, <span class="type">Iterator</span>[_]) =&gt; _,</span><br><span class="line">     partitions: <span class="type">Array</span>[<span class="type">Int</span>],</span><br><span class="line">     callSite: <span class="type">CallSite</span>,</span><br><span class="line">     listener: <span class="type">JobListener</span>,</span><br><span class="line">     properties: <span class="type">Properties</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">   <span class="keyword">var</span> finalStage: <span class="type">ResultStage</span> = <span class="literal">null</span></span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">     <span class="comment">// New stage creation may throw an exception if, for example, jobs are run on a HadoopRDD whose underlying HDFS files have been deleted.</span></span><br><span class="line">  <span class="comment">//划分Stage,返回ResultStage，Stage使用parents属性保存父Stage</span></span><br><span class="line">     finalStage = createResultStage(finalRDD, func, partitions, jobId, callSite)</span><br><span class="line">   &#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">    ......</span><br><span class="line">   &#125;</span><br><span class="line"><span class="comment">//创建ActiveJob，并添加到对应集合管理</span></span><br><span class="line">   <span class="keyword">val</span> job = <span class="keyword">new</span> <span class="type">ActiveJob</span>(jobId, finalStage, callSite, listener, properties)</span><br><span class="line">   clearCacheLocs()</span><br><span class="line">   <span class="keyword">val</span> jobSubmissionTime = clock.getTimeMillis()</span><br><span class="line">   jobIdToActiveJob(jobId) = job</span><br><span class="line">   activeJobs += job</span><br><span class="line">   finalStage.setActiveJob(job)</span><br><span class="line"></span><br><span class="line">   <span class="keyword">val</span> stageIds = jobIdToStageIds(jobId).toArray</span><br><span class="line">   <span class="keyword">val</span> stageInfos = stageIds.flatMap(id =&gt; stageIdToStage.get(id).map(_.latestInfo))</span><br><span class="line">   listenerBus.post(</span><br><span class="line">     <span class="type">SparkListenerJobStart</span>(job.jobId, jobSubmissionTime, stageInfos, properties))</span><br><span class="line"> <span class="comment">//提交Stage</span></span><br><span class="line">   submitStage(finalStage)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></li><li>划分Stage<br><code>DAGScheduler</code>的 <code>createResultStage</code>方法负责划分<code>DAG</code>生成<code>Stage</code>，<code>createResultStage</code>方法：<ul><li>1 调用 <code>getOrCreateParentStages</code>方法创建父<code>Stage</code>;</li><li>2 创建 <code>ResultStage</code>;<br>createResultStage：<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Create a ResultStage associated with the provided jobId.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">def</span> <span class="title">createResultStage</span></span>(</span><br><span class="line">    rdd: <span class="type">RDD</span>[_],</span><br><span class="line">    func: (<span class="type">TaskContext</span>, <span class="type">Iterator</span>[_]) =&gt; _,</span><br><span class="line">    partitions: <span class="type">Array</span>[<span class="type">Int</span>],</span><br><span class="line">    jobId: <span class="type">Int</span>,</span><br><span class="line">    callSite: <span class="type">CallSite</span>): <span class="type">ResultStage</span> = &#123;</span><br><span class="line">  checkBarrierStageWithDynamicAllocation(rdd)</span><br><span class="line">  checkBarrierStageWithNumSlots(rdd)</span><br><span class="line">  checkBarrierStageWithRDDChainPattern(rdd, partitions.toSet.size)</span><br><span class="line">  <span class="comment">//创建父Stage</span></span><br><span class="line">  <span class="keyword">val</span> parents = getOrCreateParentStages(rdd, jobId)</span><br><span class="line">  <span class="keyword">val</span> id = nextStageId.getAndIncrement()</span><br><span class="line">  <span class="comment">//创建ResulteStage</span></span><br><span class="line">  <span class="keyword">val</span> stage = <span class="keyword">new</span> <span class="type">ResultStage</span>(id, rdd, func, partitions, parents, jobId, callSite)</span><br><span class="line">  stageIdToStage(id) = stage</span><br><span class="line">  updateJobIdStageIdMaps(jobId, stage)</span><br><span class="line">  stage</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><code>getOrCreateParentStages</code>方法很简单：<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Get or create the list of parent stages for a given RDD.  The new Stages will be created with</span></span><br><span class="line"><span class="comment"> * the provided firstJobId.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">def</span> <span class="title">getOrCreateParentStages</span></span>(rdd: <span class="type">RDD</span>[_], firstJobId: <span class="type">Int</span>): <span class="type">List</span>[<span class="type">Stage</span>] = &#123;</span><br><span class="line">  getShuffleDependencies(rdd).map &#123; shuffleDep =&gt;</span><br><span class="line">    getOrCreateShuffleMapStage(shuffleDep, firstJobId)</span><br><span class="line">  &#125;.toList</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>首先根据方法<code>getShuffleDependencies</code>获取所有的<code>ShuffleDependency</code>:<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns shuffle dependencies that are immediate parents of the given RDD.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This function will not return more distant ancestors.  For example, if C has a shuffle</span></span><br><span class="line"><span class="comment"> * dependency on B which has a shuffle dependency on A:</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * A &lt;-- B &lt;-- C</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * calling this function with rdd C will only return the B &lt;-- C dependency.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * This function is scheduler-visible for the purpose of unit testing.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span>[scheduler] <span class="function"><span class="keyword">def</span> <span class="title">getShuffleDependencies</span></span>(</span><br><span class="line">    rdd: <span class="type">RDD</span>[_]): <span class="type">HashSet</span>[<span class="type">ShuffleDependency</span>[_, _, _]] = &#123;</span><br><span class="line">  <span class="comment">//记录所有ShuffleDependency</span></span><br><span class="line">  <span class="keyword">val</span> parents = <span class="keyword">new</span> <span class="type">HashSet</span>[<span class="type">ShuffleDependency</span>[_, _, _]]</span><br><span class="line">  <span class="comment">//记录所有已经处理的RDD</span></span><br><span class="line">  <span class="keyword">val</span> visited = <span class="keyword">new</span> <span class="type">HashSet</span>[<span class="type">RDD</span>[_]]</span><br><span class="line">  <span class="comment">//记录所有待处理的RDD</span></span><br><span class="line">  <span class="keyword">val</span> waitingForVisit = <span class="keyword">new</span> <span class="type">ListBuffer</span>[<span class="type">RDD</span>[_]]</span><br><span class="line">  <span class="comment">//把当前的ResultRdd,也就是最后一个RDD，放到watingForVistit中</span></span><br><span class="line">  waitingForVisit += rdd</span><br><span class="line">  <span class="keyword">while</span> (waitingForVisit.nonEmpty) &#123;</span><br><span class="line">    <span class="comment">//从waitingForVisit取出一个RDD去处理</span></span><br><span class="line">    <span class="keyword">val</span> toVisit = waitingForVisit.remove(<span class="number">0</span>)</span><br><span class="line">    <span class="comment">//已经处理的RDD列表中，包含要处理的这个RDD，保证下面的流程都是针对要处理的RDD</span></span><br><span class="line">    <span class="keyword">if</span> (!visited(toVisit)) &#123;</span><br><span class="line">      visited += toVisit</span><br><span class="line">      <span class="comment">//RDD的dependencies方法保存了所有RDD的依赖</span></span><br><span class="line">      toVisit.dependencies.foreach &#123;</span><br><span class="line">      <span class="comment">//如果是宽依赖，则添加到parents中</span></span><br><span class="line">      <span class="keyword">case</span> shuffleDep: <span class="type">ShuffleDependency</span>[_, _, _] =&gt;</span><br><span class="line">          parents += shuffleDep</span><br><span class="line">  <span class="comment">//如果是窄依赖，则把这个依赖的RDD添加到waitingForVisit，一直往上找，直到找到下一个宽依赖</span></span><br><span class="line">        <span class="keyword">case</span> dependency =&gt;</span><br><span class="line">          waitingForVisit.prepend(dependency.rdd)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  parents</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><code>getShuffleDependencies</code>里主要逻辑为：通过<code>action</code>操作后的<code>RDD</code>，往上遍历所有<code>RDD</code>，寻找所有的<code>ShuffleDependency</code>列表，并返回然后根据每个<code>Shuffle</code>划分<code>Stage</code>，看下<code>getOrCreateShuffleMapStage</code>代码：<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Mapping from shuffle dependency ID to the ShuffleMapStage that will generate the data for</span></span><br><span class="line"><span class="comment"> * that dependency. Only includes stages that are part of currently running job (when the job(s)</span></span><br><span class="line"><span class="comment"> * that require the shuffle stage complete, the mapping will be removed, and the only record of</span></span><br><span class="line"><span class="comment"> * the shuffle data will be in the MapOutputTracker).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span>[scheduler] <span class="keyword">val</span> shuffleIdToMapStage = <span class="keyword">new</span> <span class="type">HashMap</span>[<span class="type">Int</span>, <span class="type">ShuffleMapStage</span>]</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Gets a shuffle map stage if one exists in shuffleIdToMapStage. Otherwise, if the</span></span><br><span class="line"><span class="comment"> * shuffle map stage doesn't already exist, this method will create the shuffle map stage in</span></span><br><span class="line"><span class="comment"> * addition to any missing ancestor shuffle map stages.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">def</span> <span class="title">getOrCreateShuffleMapStage</span></span>(</span><br><span class="line">    shuffleDep: <span class="type">ShuffleDependency</span>[_, _, _],</span><br><span class="line">    firstJobId: <span class="type">Int</span>): <span class="type">ShuffleMapStage</span> = &#123;</span><br><span class="line">  shuffleIdToMapStage.get(shuffleDep.shuffleId) <span class="keyword">match</span> &#123;</span><br><span class="line">    <span class="comment">//如果配配直接返回</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Some</span>(stage) =&gt;</span><br><span class="line">      stage</span><br><span class="line">    <span class="comment">//否则重新调用createShuffleMapStage方法创建stage</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">None</span> =&gt;</span><br><span class="line">      <span class="comment">// Create stages for all missing ancestor shuffle dependencies.</span></span><br><span class="line">      getMissingAncestorShuffleDependencies(shuffleDep.rdd).foreach &#123; dep =&gt;</span><br><span class="line">        <span class="comment">// Even though getMissingAncestorShuffleDependencies only returns shuffle dependencies</span></span><br><span class="line">        <span class="comment">// that were not already in shuffleIdToMapStage, it's possible that by the time we</span></span><br><span class="line">        <span class="comment">// get to a particular dependency in the foreach loop, it's been added to</span></span><br><span class="line">        <span class="comment">// shuffleIdToMapStage by the stage creation process for an earlier dependency. See</span></span><br><span class="line">        <span class="comment">// SPARK-13902 for more information.</span></span><br><span class="line">        <span class="keyword">if</span> (!shuffleIdToMapStage.contains(dep.shuffleId)) &#123;</span><br><span class="line">          createShuffleMapStage(dep, firstJobId)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// Finally, create a stage for the given shuffle dependency.</span></span><br><span class="line">      createShuffleMapStage(shuffleDep, firstJobId)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>而<code>getMissingAncestorShuffleDependencies</code> 方法查找在<code>shuffleToMapStage</code>中未注的shuffle dependencies,并返回父shuffleDep用来创建stage<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Find ancestor shuffle dependencies that are not registered in shuffleToMapStage yet */</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">def</span> <span class="title">getMissingAncestorShuffleDependencies</span></span>(</span><br><span class="line">    rdd: <span class="type">RDD</span>[_]): <span class="type">ListBuffer</span>[<span class="type">ShuffleDependency</span>[_, _, _]] = &#123;</span><br><span class="line">  <span class="keyword">val</span> ancestors = <span class="keyword">new</span> <span class="type">ListBuffer</span>[<span class="type">ShuffleDependency</span>[_, _, _]]</span><br><span class="line">  <span class="keyword">val</span> visited = <span class="keyword">new</span> <span class="type">HashSet</span>[<span class="type">RDD</span>[_]]</span><br><span class="line">  <span class="comment">// We are manually maintaining a stack here to prevent StackOverflowError</span></span><br><span class="line">  <span class="comment">// caused by recursively visiting</span></span><br><span class="line">  <span class="keyword">val</span> waitingForVisit = <span class="keyword">new</span> <span class="type">ListBuffer</span>[<span class="type">RDD</span>[_]]</span><br><span class="line">  waitingForVisit += rdd</span><br><span class="line">  <span class="keyword">while</span> (waitingForVisit.nonEmpty) &#123;</span><br><span class="line">    <span class="keyword">val</span> toVisit = waitingForVisit.remove(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> (!visited(toVisit)) &#123;</span><br><span class="line">      visited += toVisit</span><br><span class="line">      getShuffleDependencies(toVisit).foreach &#123; shuffleDep =&gt;</span><br><span class="line">        <span class="keyword">if</span> (!shuffleIdToMapStage.contains(shuffleDep.shuffleId)) &#123;</span><br><span class="line">          ancestors.prepend(shuffleDep)</span><br><span class="line">          waitingForVisit.prepend(shuffleDep.rdd)</span><br><span class="line">        &#125; <span class="comment">// Otherwise, the dependency and its ancestors have already been registered.</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  ancestors</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>至此，<code>Stage</code>划分基本完毕。</li></ul></li></ul><hr><p><strong>声明:</strong><br>作者:上海IT技术圈<br>本文版权归作者和上海IT技术圈共有，任何人或团体、机构全部转载或者部分转载、摘录，请在文章明显位置注明作者和原文链接。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Stage是什么&quot;&gt;&lt;a href=&quot;#Stage是什么&quot; class=&quot;headerlink&quot; title=&quot;Stage是什么&quot;&gt;&lt;/a&gt;Stage是什么&lt;/h2&gt;&lt;p&gt;&lt;code&gt;Stage&lt;/code&gt;是&lt;code&gt;Job&lt;/code&gt;的基本调度单位，一个&lt;
      
    
    </summary>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/categories/spark/"/>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/tags/spark/"/>
    
  </entry>
  
  <entry>
    <title>spark rdd介绍</title>
    <link href="http://sparkx.com.cn/spark/spark-rdd/"/>
    <id>http://sparkx.com.cn/spark/spark-rdd/</id>
    <published>2019-11-28T01:35:26.000Z</published>
    <updated>2019-12-09T13:48:28.762Z</updated>
    
    <content type="html"><![CDATA[<h2 id="RDD是什么"><a href="#RDD是什么" class="headerlink" title="RDD是什么"></a>RDD是什么</h2><p><code>RDD</code>是Resillient Distributed DataSet(弹性分布式数据集)的简称,是分布式内存的一个抽象概念，提供了一种高度受限的共享内存模型</p><h2 id="RDD运行原理"><a href="#RDD运行原理" class="headerlink" title="RDD运行原理"></a>RDD运行原理</h2><h4 id="设计背景"><a href="#设计背景" class="headerlink" title="设计背景"></a>设计背景</h4><p>许多迭代算法（比如机器学习、图计算）和交互式数据挖掘工具，不同计算阶段之间会重用中间结果，RDD就是满足这种需求出现的，它提供一个抽象的数据结构，我们不必担心底层数据的分布式特性，只需将具体的应用逻辑表达为一系列转换处理，不同RDD之间的转换操作形成依赖关系，可以实现管道化，避免中间数据存储</p><h4 id="RDD概念"><a href="#RDD概念" class="headerlink" title="RDD概念"></a>RDD概念</h4><ul><li><code>RDD</code>就是一个分布式对象集合，本质上是一个只读的分区记录集合，每个<code>RDD</code>可以分成多个分区，每个分区就是一个数据集片段，并且<code>RDD</code>的不同分区可以被保存到集群中不同的节点上，从而可以在集群中的不同节点上进行并行计算</li><li><code>RDD</code>提供了一种高度受限的共享内存模型，即<code>RDD</code>是只读的记录分区的集合，不能直接修改，只能基于稳定的物理存储中的数据集合创建<code>RDD</code>,或者通过在其他<code>RDD</code>上执行确定的转换操作（如map、join、group by等）而创建得到新的<code>RDD</code></li><li><code>RDD</code>提供了一组丰富的操作以支持常见数据运算，分为”动作”（action)和”转换”（Transformation）两种类型</li><li><code>RDD</code>提供的转换接口都非常简单，都是类似map、filter、groupBy、join等粗粒度的数据转换操作，而不是针对某个数据项的细粒度修改（不适合网页爬虫）,表面上<code>RDD</code>功能受限、不够强大，实际上它已经被实践证明可以高效地表达许多框架的编程模型（比如MapReduce、SQL、Pregel)<h4 id="RDD的2种创建方式"><a href="#RDD的2种创建方式" class="headerlink" title="RDD的2种创建方式"></a>RDD的2种创建方式</h4><img src="/images/spark/spark_rdd_run.png" alt="rdd执行过程的一个实例"></li><li>由一个已经存在的scala集合创建,一般只在试验性代码中使用，生产环境不大可能用到<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rdd = sc.paralellize(<span class="type">List</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))</span><br></pre></td></tr></table></figure></li><li>由外部存储系统的数据创建，比如本地文件，HDFS, Hbase等，常用textFile方法<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> rdd = sc.textFile(<span class="string">"hdfs:///tmp/myfile.txt"</span>)</span><br></pre></td></tr></table></figure><h4 id="RDD的2种操作"><a href="#RDD的2种操作" class="headerlink" title="RDD的2种操作"></a>RDD的2种操作</h4></li><li>Transtormation算子<table><thead><tr><th>方法名</th><th align="left">解释</th></tr></thead><tbody><tr><td><code>map(func</code>)</td><td align="left">返回一个新的分布式数据集，由每个原元素经过func函数处理后的新元素组成</td></tr><tr><td><code>filter(func)</code></td><td align="left">返回一个新的数据集，由经过func函数处理后返回值为true的元素组成</td></tr><tr><td><code>flatMap(func)</code></td><td align="left">类似<code>map</code>，但每一个输入元素，会被映射为0个或多个输出元素，（因此func函数返回值是一个seq，而不是单一元素）</td></tr><tr><td><code>mapPartitions(func)</code></td><td align="left">类似于<code>map</code>，对<code>RDD</code>的每个分区起作用，在类型为T的<code>RDD</code>运行时，func的函数类型必须是<code>Iterator[T]=&gt;Iterator[U]</code></td></tr><tr><td><code>mapPartitionsWithIndex(func)</code></td><td align="left">和<code>mapPartitions</code>类似，但func带有一个整数参数表上分区的索引值，在类型为T的<code>RDD</code>上运行时，func的函数参数类型必须序是<code>(int,Iterator[T])=&gt;Iterator[U]</code></td></tr><tr><td><code>smap(withReplacement,fraction,seed)</code></td><td align="left">根据给定的随机种子<code>seed</code>，随机抽样出数量为<code>fraction</code>的数据</td></tr><tr><td><code>pipe(command,[envVars])</code></td><td align="left">通过管道的方式对<code>RDD</code>的每个分区使用shell命令进行操作，返回对应的结果</td></tr><tr><td><code>union(otherDataSet)</code></td><td align="left">返回一个新的数据集，由元素数据集参数联合而成</td></tr><tr><td><code>intersection(otherDataSet)</code></td><td align="left">求两个<code>RDD</code>的交集</td></tr><tr><td><code>distinct([numPartitions])</code></td><td align="left">返回一个包含源数据集中所有不重复元素的新数据集</td></tr><tr><td><code>groupByKey([numPartitions])</code></td><td align="left">在一个由(k,v)对组成的数据集上调用，返回一个(k,Seq[V])对组成的数据集。默认情况下，输出结果的并行度依赖于父<code>RDD</code>的分区数目，如果要想对key进行聚合的话，使用<code>reduceByKey</code>或者<code>combineByKey</code>会有更好的性能</td></tr><tr><td><code>reduceByKey(func,[numPartitions])</code></td><td align="left">在一个(k,v)对的数据集上使用，返回一个(k,v)对数据集，key相同值都会被使用指定的<code>reduce</code>函数聚合到一起，<code>reduce</code>任务的个数据是可以通过第二个可选参数来配置</td></tr><tr><td><code>sortByKey([ascending],[numPartitions])</code></td><td align="left">在类型为(k,v)的数据集上调用，返回以k为键进行排序的(k,v)对数据集，升序或者降序有boolean型的<code>ascending</code>参数决定</td></tr><tr><td><code>join(otherDataSet,[numPartitions])</code></td><td align="left">在类型为(k,v)和(k,w)类型的数据集上调用，返回一个(k,(v,w))对，每个key中的所有元素都在一起的数据集</td></tr><tr><td><code>cogroup(otherDataSet,[numPartitions])</code></td><td align="left">在类型为(k,v)和(k,w)类型的数据上调用，返回一个数据集，组成元素为<code>(k,Iterable[V],Iterable[W] tuples)</code></td></tr><tr><td><code>cartesian(otherDataSet</code>)</td><td align="left">笛卡尔积，但在数据集T合U上调用时，返回一个(T,U)对的数据集，所有元素交互进行笛卡尔积</td></tr><tr><td><code>coalesce(numPartitions</code>)</td><td align="left">对<code>RDD</code>中的分区减少指定数目，通常在过滤完一个大数据集之后进行操作</td></tr><tr><td><code>repartition(numPartitions)</code></td><td align="left">将<code>RDD</code>中素有<code>records</code>平均划分到<code>numPartitions</code>个<code>partition</code>中</td></tr></tbody></table></li><li>Action算子<table><thead><tr><th>方法名</th><th align="left">解释</th></tr></thead><tbody><tr><td><code>reduce(func)</code></td><td align="left">通过函数func聚集数据集中的所有元素，这个函数必须是关联性的，确保可以被正确的并发执行</td></tr><tr><td><code>collect()</code></td><td align="left">在driver的程序中，以数组的形式，返回数据集的所有元素，这通常会在使用<code>filter</code>或者其他操作后，返回一个足够小的数据集在使用</td></tr><tr><td><code>count()</code></td><td align="left">返回数据的元素个数</td></tr><tr><td><code>first()</code></td><td align="left">返回数据集的第一个元素(类似于take(1))</td></tr><tr><td><code>take(n)</code></td><td align="left">返回一个数组，由数据集的前n个元素组成。注意此操作目前并非并行执行的，而是<code>driver</code>程序所在集群</td></tr><tr><td><code>takeSample(withReplacement,num,seed)</code></td><td align="left">返回一个数组，在数据集中随机采样<code>num</code>个元素组成，可以选择是否用随机数替换不足的部分，<code>seed</code>用于指定随机数生成器种子</td></tr><tr><td><code>takeOrderd(n,[ordering])</code></td><td align="left">排序后的<code>limit (n)</code></td></tr><tr><td><code>saveAsTextFile(path)</code></td><td align="left">将数据集的元素，以<code>textfile</code>的形式保存到本地文件系统<code>hdfs</code>或者任何其他<code>hadoop</code>支持的文件系统，<code>spark</code>将会调用每个元素的<code>toString</code>方法，并将它转换为文件中的一行文本</td></tr><tr><td><code>saveAsSequenceFile(path)</code></td><td align="left">将数据集的元素以sequencefile的格式保存到指定的目录下、本地系统、<code>hdfs</code>或者任何其他<code>hadoop</code>支持的文件系统，<code>RDD</code>的元素必须有<code>key-value</code>对组成，并都实现了<code>hadoop</code>的<code>writable</code>接口或隐式可以转换为<code>writable</code></td></tr><tr><td><code>saveAsObjectFlie(path)</code></td><td align="left">使用java的序列化方法保存到本地文件，可以被<code>sparkContext.objextFlie()</code>加载</td></tr><tr><td><code>countByKey()</code></td><td align="left">对(k,v)类型的RDD有效，返回一个(k,Int)对的map,表示每一个可以对应的元素个数</td></tr><tr><td><code>foreache(func)</code></td><td align="left">在数据集的每一个元素上，运行函数func，通常用于更新一个累加器变量，或者和外部存储系统做交互</td></tr></tbody></table></li></ul><h4 id="RDD特点"><a href="#RDD特点" class="headerlink" title="RDD特点"></a>RDD特点</h4><ul><li>高效的容错性<ul><li>现有容错机制：数据复制或者记录日志</li><li>血缘关系：重新计算丢失分区无需回滚系统、重算过程在不同节点之间并行、只记录粗粒度的操作</li></ul></li><li>中间结果持久化到内存，数据在内存中的多个<code>RDD</code>操作之间进行传递，避免了不必要的读写磁盘开销</li><li>存放的数据key是Java对象，避免了不必要的对象序列化和反序列化，但是为了节约内存一般还会选序列化，比如：lz4。</li></ul><blockquote><p>缓存数据时可以选择是否同时进行序列化。序列化后占用的空间会减少，但有序列化/反序列化的成本。<br>如果确定需要使用序列化，则同时应该设置序列化的方式，默认是使用java自带的序列化机制，可以通过kyro等框架优化序列化效率。<br>即使完全无其它属性，一个java对象都要占据8个字节的内存，包括：锁标志位、经历了几次gc、类的类信息等，因此序列化可节省此部分的空间。</p></blockquote><h4 id="RDD源码"><a href="#RDD源码" class="headerlink" title="RDD源码"></a>RDD源码</h4><p>RDD 位置: <code>org.apache.spark.rdd.RDD</code></p><ul><li>RDD是一个抽象类定义了所有RDD共有的一些属性和方法，定义如下：<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">RDD</span>[<span class="type">T</span>: <span class="type">ClassTag</span>](<span class="params"></span></span></span><br><span class="line"><span class="class"><span class="params">    @transient private var _sc: <span class="type">SparkContext</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    @transient private var deps: <span class="type">Seq</span>[<span class="type">Dependency</span>[_]]</span></span></span><br><span class="line"><span class="class"><span class="params">  </span>) <span class="keyword">extends</span> <span class="title">Serializable</span> <span class="keyword">with</span> <span class="title">Logging</span> </span>&#123; ......&#125;</span><br></pre></td></tr></table></figure><code>@transient private var _sc: SparkContex</code> 在主构建函数中定义，表示RDD所在运行环境，可用于获取配置，清理环境等。<br><code>@transient private var deps: Seq[Dependency[_]]</code> 定义了这个RDD对父RDD的依赖关系。</li><li>RDD有5个主要属性:<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//注释说明</span></span><br><span class="line"> *  - <span class="type">A</span> list of partitions</span><br><span class="line"> *  - <span class="type">A</span> function <span class="keyword">for</span> computing each split</span><br><span class="line"> *  - <span class="type">A</span> list of dependencies on other <span class="type">RDDs</span></span><br><span class="line"> *  - <span class="type">Optionally</span>, a <span class="type">Partitioner</span> <span class="keyword">for</span> key-value <span class="type">RDDs</span> (e.g. to say that the <span class="type">RDD</span> is hash-partitioned)</span><br><span class="line"> *  - <span class="type">Optionally</span>, a list of preferred locations to compute each split on (e.g. block locations <span class="keyword">for</span></span><br><span class="line"> *    an <span class="type">HDFS</span> file)</span><br><span class="line"><span class="comment">//5个属性的源码</span></span><br><span class="line"><span class="comment">// =======================================================================</span></span><br><span class="line"><span class="comment">// Methods that should be implemented by subclasses of RDD</span></span><br><span class="line"><span class="comment">// =======================================================================</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* :: DeveloperApi ::</span></span><br><span class="line"><span class="comment">* Implemented by subclasses to compute a given partition.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@DeveloperApi</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">compute</span></span>(split: <span class="type">Partition</span>, context: <span class="type">TaskContext</span>): <span class="type">Iterator</span>[<span class="type">T</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Implemented by subclasses to return the set of partitions in this RDD. This method will only</span></span><br><span class="line"><span class="comment">* be called once, so it is safe to implement a time-consuming computation in it.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* The partitions in this array must satisfy the following property:</span></span><br><span class="line"><span class="comment">*   `rdd.partitions.zipWithIndex.forall &#123; case (partition, index) =&gt; partition.index == index &#125;`</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">def</span> <span class="title">getPartitions</span></span>: <span class="type">Array</span>[<span class="type">Partition</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Implemented by subclasses to return how this RDD depends on parent RDDs. This method will only</span></span><br><span class="line"><span class="comment">* be called once, so it is safe to implement a time-consuming computation in it.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">def</span> <span class="title">getDependencies</span></span>: <span class="type">Seq</span>[<span class="type">Dependency</span>[_]] = deps</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Optionally overridden by subclasses to specify placement preferences.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">def</span> <span class="title">getPreferredLocations</span></span>(split: <span class="type">Partition</span>): <span class="type">Seq</span>[<span class="type">String</span>] = <span class="type">Nil</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** Optionally overridden by subclasses to specify how they are partitioned. */</span></span><br><span class="line"><span class="meta">@transient</span> <span class="keyword">val</span> partitioner: <span class="type">Option</span>[<span class="type">Partitioner</span>] = <span class="type">None</span></span><br></pre></td></tr></table></figure></li><li>Tranformation和Action方法<br>RDD中定义了所有RDD所共用的tranformation与action，如map, filter, reduce, first等，举个filter的例子：<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Return a new RDD containing only the elements that satisfy a predicate.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">filter</span></span>(f: <span class="type">T</span> =&gt; <span class="type">Boolean</span>): <span class="type">RDD</span>[<span class="type">T</span>] = withScope &#123;</span><br><span class="line"><span class="keyword">val</span> cleanF = sc.clean(f)</span><br><span class="line"><span class="keyword">new</span> <span class="type">MapPartitionsRDD</span>[<span class="type">T</span>, <span class="type">T</span>](</span><br><span class="line">  <span class="keyword">this</span>,</span><br><span class="line">  (_, _, iter) =&gt; iter.filter(cleanF),</span><br><span class="line">  preservesPartitioning = <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="RDD子类"><a href="#RDD子类" class="headerlink" title="RDD子类"></a>RDD子类</h4><code>CoGroupedRDD, EdgeRDD, EdgeRDDImpl, HadoopRDD, JdbcRDD, NewHadoopRDD, PartitionPruningRDD, ShuffledRDD, UnionRDD, VertexRDD, VertexRDDImpl</code><h4 id="RDD缓存方式"><a href="#RDD缓存方式" class="headerlink" title="RDD缓存方式"></a>RDD缓存方式</h4>对于一个经常被使用的RDD或者计算代价较大的RDD，将其缓存下来，会大大的提高处理速度，缓存方法有如下两种：</li><li>persist()是标准的缓存方法 </li><li>cache()是persist简化方法，当只使用内存作缓存时使用,看源码一目了然<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Persist RDDs of this DStream with the default storage level (MEMORY_ONLY_SER) */</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cache</span></span>(): <span class="type">DStream</span>[<span class="type">T</span>] = persist()</span><br></pre></td></tr></table></figure><h4 id="12种缓存级别"><a href="#12种缓存级别" class="headerlink" title="12种缓存级别"></a>12种缓存级别</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * :: DeveloperApi ::</span></span><br><span class="line"><span class="comment"> * Flags for controlling the storage of an RDD. Each StorageLevel records whether to use memory,</span></span><br><span class="line"><span class="comment"> * or ExternalBlockStore, whether to drop the RDD to disk if it falls out of memory or</span></span><br><span class="line"><span class="comment"> * ExternalBlockStore, whether to keep the data in memory in a serialized format, and whether</span></span><br><span class="line"><span class="comment"> * to replicate the RDD partitions on multiple nodes.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * The [[org.apache.spark.storage.StorageLevel$]] singleton object contains some static constants</span></span><br><span class="line"><span class="comment"> * for commonly useful storage levels. To create your own storage level object, use the</span></span><br><span class="line"><span class="comment"> * factory method of the singleton object (`StorageLevel(...)`).</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@DeveloperApi</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StorageLevel</span> <span class="title">private</span>(<span class="params"></span></span></span><br><span class="line"><span class="class"><span class="params">    private var _useDisk: <span class="type">Boolean</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    private var _useMemory: <span class="type">Boolean</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    private var _useOffHeap: <span class="type">Boolean</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    private var _deserialized: <span class="type">Boolean</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    private var _replication: <span class="type">Int</span> = 1</span>)<span class="keyword">extends</span> <span class="title">Externalizable</span> </span></span><br><span class="line"><span class="class">......</span></span><br><span class="line"><span class="class"><span class="title">/**</span></span></span><br><span class="line"><span class="class"> <span class="title">*</span> <span class="title">Various</span> [[org.apache.spark.storage.<span class="type">StorageLevel</span>]] <span class="title">defined</span> <span class="title">and</span> <span class="title">utility</span> <span class="title">functions</span> <span class="title">for</span> <span class="title">creating</span> <span class="title">new</span> <span class="title">storage</span> <span class="title">levels</span>.</span></span><br><span class="line"><span class="class"> <span class="title">*</span> <span class="title">对应参数见构造函数</span></span></span><br><span class="line"><span class="class"> <span class="title">*/</span></span></span><br><span class="line"><span class="class"><span class="title">object</span> <span class="title">StorageLevel</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> <span class="type">NONE</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>)  <span class="comment">//不缓存</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">DISK_ONLY</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>) <span class="comment">//只使用磁盘</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">DISK_ONLY_2</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="number">2</span>)<span class="comment">// 只使用磁盘,副本数2</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">MEMORY_ONLY</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">true</span>) <span class="comment">//只使用内存</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">MEMORY_ONLY_2</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">true</span>, <span class="number">2</span>) <span class="comment">//只使用内存，副本数2</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">MEMORY_ONLY_SER</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>) <span class="comment">//使用内存并序列化</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">MEMORY_ONLY_SER_2</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">false</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="number">2</span>) <span class="comment">//使用内存并序列化，复本数2</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">MEMORY_AND_DISK</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">true</span>) <span class="comment">//使用缓存和磁盘，缓存不足写到磁盘</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">MEMORY_AND_DISK_2</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">true</span>, <span class="number">2</span>)<span class="comment">//使用缓存和磁盘，缓存不足写到磁盘，副本数2</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">MEMORY_AND_DISK_SER</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>)<span class="comment">//使用缓存和磁盘并序列化，缓存不足写到磁盘</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">MEMORY_AND_DISK_SER_2</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="literal">false</span>, <span class="number">2</span>) <span class="comment">//使用缓存和磁盘并序列化，缓存不足写到磁盘，副本数2</span></span><br><span class="line">  <span class="keyword">val</span> <span class="type">OFF_HEAP</span> = <span class="keyword">new</span> <span class="type">StorageLevel</span>(<span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">true</span>, <span class="literal">false</span>, <span class="number">1</span>) <span class="comment">//使用JVM堆外内存</span></span><br><span class="line">  ......</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>从1.6.0版本开始，Spark内存管理模型发生了变化。旧的内存管理模型由StaticMemoryManager类实现，现在称为“legacy（遗留）”。默认情况下，“Legacy”模式被禁用，这意味着在Spark 1.5.x和1.6.0上运行相同的代码会导致不同的行为。<br>为了兼容，您可以使用spark.memory.useLegacyMode参数（目前spark2.4版本中也依然保留这个静态内存管理模型）启用“旧”内存模型：<br>spark.memory.useLegacyMode=true（默认为false）<blockquote><p>注意：在Spark1.x以前，默认的off_heap使用的是Tachyon。但是Spark中默认操作Tachyon的TachyonBlockManager开发完成之后，代码就不再更新。当Tachyon升级为Alluxio之后移除不使用的API，导致Spark默认off_heap不可用（spark1.6+）。<br>错误情况可参考：<a href="https://alluxio.atlassian.net/browse/ALLUXIO-1881" target="_blank" rel="noopener">https://alluxio.atlassian.net/browse/ALLUXIO-1881</a></p></blockquote></li></ul><h4 id="RDD之间的依赖关系"><a href="#RDD之间的依赖关系" class="headerlink" title="RDD之间的依赖关系"></a>RDD之间的依赖关系</h4><ul><li>窄依赖表现为一个父<code>RDD</code>的分区对应于一个子<code>RDD</code>的分区或多个父<code>RDD</code>的分区对应于一个子<code>RDD</code>的分区（不依赖于全部分区）</li><li>宽依赖则表现为存在一个父<code>RDD</code>的一个分区对应一个子<code>RDD</code>的多个分区<br><img src="/images/spark/spark_rdd_dependency.png" alt=""><h4 id="RDD依赖源码分析"><a href="#RDD依赖源码分析" class="headerlink" title="RDD依赖源码分析"></a>RDD依赖源码分析</h4>与依赖相关的5个类，<code>Dependency</code>、<code>NarrowDependency</code>、<code>OneToOneDependency</code>、<code>RangeDependency</code>、<code>ShuffleDependency</code>，它们位于同一个Scala文件中；<br>Dependency 位置 <code>org.apache.spark.Dependency</code> 2.4.x版。</li></ul><p><code>NarrowDependency(abstract class)</code>与<code>ShuffleDependency</code>直接继承<code>Dependency</code><br><code>OneToOneDependency</code>与<code>RangeDependency</code>继承自<code>NarrowDependency</code><br>所以，关于<code>Dependency</code>的真正实现有三个，2个窄依赖：<code>OneToOneDependency</code>与<code>RangeDependency</code>，一个宽依赖：<code>ShuffleDependency</code>。</p><ul><li>Dependency是抽象类<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * :: DeveloperApi ::</span></span><br><span class="line"><span class="comment"> * Base class for dependencies.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@DeveloperApi</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Dependency</span>[<span class="type">T</span>] <span class="keyword">extends</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">rdd</span></span>: <span class="type">RDD</span>[<span class="type">T</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="窄依赖"><a href="#窄依赖" class="headerlink" title="窄依赖"></a>窄依赖</h6></li><li>NarrowDependency<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * :: DeveloperApi ::</span></span><br><span class="line"><span class="comment"> * Base class for dependencies where each partition of the child RDD depends on a small number</span></span><br><span class="line"><span class="comment"> * of partitions of the parent RDD. Narrow dependencies allow for pipelined execution.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@DeveloperApi</span></span><br><span class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">NarrowDependency</span>[<span class="type">T</span>](<span class="params">_rdd: <span class="type">RDD</span>[<span class="type">T</span>]</span>) <span class="keyword">extends</span> <span class="title">Dependency</span>[<span class="type">T</span>] </span>&#123;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * Get the parent partitions for a child partition.</span></span><br><span class="line"><span class="comment">   * @param partitionId a partition of the child RDD</span></span><br><span class="line"><span class="comment">   * @return the partitions of the parent RDD that the child partition depends upon</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">getParents</span></span>(partitionId: <span class="type">Int</span>): <span class="type">Seq</span>[<span class="type">Int</span>]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">rdd</span></span>: <span class="type">RDD</span>[<span class="type">T</span>] = _rdd</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>getParents根据子RDD的分区ID返回父RDD的分区ID,主构建函数中的rdd是父RDD，下同。</li><li>OneToOneDependency<br>一对一依赖，即每个子RDD的分区的与父RDD的分区一一对应。重写了NarrowDependency的getParents方法，返回一个List，这个List只有一个元素，且与子RDD的分区ID相同。即子分区的ID与父分区的ID一一对应且相等<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * :: DeveloperApi ::</span></span><br><span class="line"><span class="comment"> * Represents a one-to-one dependency between partitions of the parent and child RDDs.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@DeveloperApi</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">OneToOneDependency</span>[<span class="type">T</span>](<span class="params">rdd: <span class="type">RDD</span>[<span class="type">T</span>]</span>) <span class="keyword">extends</span> <span class="title">NarrowDependency</span>[<span class="type">T</span>](<span class="params">rdd</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">getParents</span></span>(partitionId: <span class="type">Int</span>): <span class="type">List</span>[<span class="type">Int</span>] = <span class="type">List</span>(partitionId)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li>RangeDependency<br>子RDD中的每个分区依赖于父RDD的几个分区，而父RDD的每个分区仅被一个子RDD分区所依赖，即多对一的关系。它仅仅被UnionRDD所使用。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * :: DeveloperApi ::</span></span><br><span class="line"><span class="comment"> * Represents a one-to-one dependency between ranges of partitions in the parent and child RDDs.</span></span><br><span class="line"><span class="comment"> * @param rdd the parent RDD</span></span><br><span class="line"><span class="comment"> * @param inStart the start of the range in the parent RDD</span></span><br><span class="line"><span class="comment"> * @param outStart the start of the range in the child RDD</span></span><br><span class="line"><span class="comment"> * @param length the length of the range</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@DeveloperApi</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RangeDependency</span>[<span class="type">T</span>](<span class="params">rdd: <span class="type">RDD</span>[<span class="type">T</span>], inStart: <span class="type">Int</span>, outStart: <span class="type">Int</span>, length: <span class="type">Int</span></span>)</span></span><br><span class="line"><span class="class">  <span class="keyword">extends</span> <span class="title">NarrowDependency</span>[<span class="type">T</span>](<span class="params">rdd</span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">getParents</span></span>(partitionId: <span class="type">Int</span>): <span class="type">List</span>[<span class="type">Int</span>] = &#123;</span><br><span class="line">    <span class="keyword">if</span> (partitionId &gt;= outStart &amp;&amp; partitionId &lt; outStart + length) &#123;</span><br><span class="line">      <span class="type">List</span>(partitionId - outStart + inStart)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="type">Nil</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h6 id="宽依赖"><a href="#宽依赖" class="headerlink" title="宽依赖"></a>宽依赖</h6>宽依赖只有一种：shuffleDependency，即子RDD依赖于父RDD的所有分区，父RDD的分每个区被所有子RDD的分区所依赖。<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * :: DeveloperApi ::</span></span><br><span class="line"><span class="comment"> * Represents a dependency on the output of a shuffle stage. Note that in the case of shuffle,</span></span><br><span class="line"><span class="comment"> * the RDD is transient since we don't need it on the executor side.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @param _rdd the parent RDD</span></span><br><span class="line"><span class="comment"> * @param partitioner partitioner used to partition the shuffle output</span></span><br><span class="line"><span class="comment"> * @param serializer [[org.apache.spark.serializer.Serializer Serializer]] to use. If not set</span></span><br><span class="line"><span class="comment"> *                   explicitly then the default serializer, as specified by `spark.serializer`</span></span><br><span class="line"><span class="comment"> *                   config option, will be used.</span></span><br><span class="line"><span class="comment"> * @param keyOrdering key ordering for RDD's shuffles</span></span><br><span class="line"><span class="comment"> * @param aggregator map/reduce-side aggregator for RDD's shuffle</span></span><br><span class="line"><span class="comment"> * @param mapSideCombine whether to perform partial aggregation (also known as map-side combine)</span></span><br><span class="line"><span class="comment"> * @param shuffleWriterProcessor the processor to control the write behavior in ShuffleMapTask</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@DeveloperApi</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShuffleDependency</span>[<span class="type">K</span>: <span class="type">ClassTag</span>, <span class="type">V</span>: <span class="type">ClassTag</span>, <span class="type">C</span>: <span class="type">ClassTag</span>](<span class="params"></span></span></span><br><span class="line"><span class="class"><span class="params">    @transient private val _rdd: <span class="type">RDD</span>[_ &lt;: <span class="type">Product2</span>[<span class="type">K</span>, <span class="type">V</span>]],</span></span></span><br><span class="line"><span class="class"><span class="params">    val partitioner: <span class="type">Partitioner</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    val serializer: <span class="type">Serializer</span> = <span class="type">SparkEnv</span>.get.serializer,</span></span></span><br><span class="line"><span class="class"><span class="params">    val keyOrdering: <span class="type">Option</span>[<span class="type">Ordering</span>[<span class="type">K</span>]] = <span class="type">None</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    val aggregator: <span class="type">Option</span>[<span class="type">Aggregator</span>[<span class="type">K</span>, <span class="type">V</span>, <span class="type">C</span>]] = <span class="type">None</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    val mapSideCombine: <span class="type">Boolean</span> = false,</span></span></span><br><span class="line"><span class="class"><span class="params">    val shuffleWriterProcessor: <span class="type">ShuffleWriteProcessor</span> = new <span class="type">ShuffleWriteProcessor</span></span>)</span></span><br><span class="line"><span class="class">  <span class="keyword">extends</span> <span class="title">Dependency</span>[<span class="type">Product2</span>[<span class="type">K</span>, <span class="type">V</span>]] </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (mapSideCombine) &#123;</span><br><span class="line">    require(aggregator.isDefined, <span class="string">"Map-side combine without Aggregator specified!"</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">override</span> <span class="function"><span class="keyword">def</span> <span class="title">rdd</span></span>: <span class="type">RDD</span>[<span class="type">Product2</span>[<span class="type">K</span>, <span class="type">V</span>]] = _rdd.asInstanceOf[<span class="type">RDD</span>[<span class="type">Product2</span>[<span class="type">K</span>, <span class="type">V</span>]]]</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span>[spark] <span class="keyword">val</span> keyClassName: <span class="type">String</span> = reflect.classTag[<span class="type">K</span>].runtimeClass.getName</span><br><span class="line">  <span class="keyword">private</span>[spark] <span class="keyword">val</span> valueClassName: <span class="type">String</span> = reflect.classTag[<span class="type">V</span>].runtimeClass.getName</span><br><span class="line">  <span class="comment">// Note: It's possible that the combiner class tag is null, if the combineByKey</span></span><br><span class="line">  <span class="comment">// methods in PairRDDFunctions are used instead of combineByKeyWithClassTag.</span></span><br><span class="line">  <span class="keyword">private</span>[spark] <span class="keyword">val</span> combinerClassName: <span class="type">Option</span>[<span class="type">String</span>] =</span><br><span class="line">    <span class="type">Option</span>(reflect.classTag[<span class="type">C</span>]).map(_.runtimeClass.getName)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">val</span> shuffleId: <span class="type">Int</span> = _rdd.context.newShuffleId()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">val</span> shuffleHandle: <span class="type">ShuffleHandle</span> = _rdd.context.env.shuffleManager.registerShuffle(</span><br><span class="line">    shuffleId, <span class="keyword">this</span>)</span><br><span class="line"></span><br><span class="line">  _rdd.sparkContext.cleaner.foreach(_.registerShuffleForCleanup(<span class="keyword">this</span>))</span><br><span class="line">  _rdd.sparkContext.shuffleDriverComponents.registerShuffle(shuffleId)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="stage的划分"><a href="#stage的划分" class="headerlink" title="stage的划分"></a>stage的划分</h4><code>DAG</code>根据宽依赖来划分<code>stage</code>，每个宽依赖的处理均会是一个<code>stage</code>的划分点，后面专门章节讲解<code>stage</code>的划分。</li></ul><hr><p><strong>声明:</strong><br>作者:上海IT技术圈<br>本文版权归作者和上海IT技术圈共有，任何人或团体、机构全部转载或者部分转载、摘录，请在文章明显位置注明作者和原文链接。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;RDD是什么&quot;&gt;&lt;a href=&quot;#RDD是什么&quot; class=&quot;headerlink&quot; title=&quot;RDD是什么&quot;&gt;&lt;/a&gt;RDD是什么&lt;/h2&gt;&lt;p&gt;&lt;code&gt;RDD&lt;/code&gt;是Resillient Distributed DataSet(弹性分布式数
      
    
    </summary>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/categories/spark/"/>
    
    
      <category term="spark" scheme="http://sparkx.com.cn/tags/spark/"/>
    
  </entry>
  
</feed>
